project:
  type: website
  output-dir: ../_book
  preview:
    browser: true
    navigate: true

# No site-wide title - each page defines its own

website:
  announcement:
    icon: book
    dismissable: true
    position: below-navbar
    content: |
      <div id="banner">
        üéâ <b>Just Announced:</b> <i>Introduction to Machine Learning Systems</i> will be published by <b>MIT Press</b> in 2026!<br>
        üíª Fully open source at <a href="https://mlsysbook.ai">mlsysbook.ai</a><br>
        üóíÔ∏è <a href="contents/frontmatter/changelog/changelog.html">View the full changelog</a><br>
        üî• Latest release: <a href="https://mlsysbook.github.io/tinytorch">TinyTorch</a><br>
        ‚≠ê Help grow the project: <a href="https://github.com/harvard-edge/cs249r_book">Star on GitHub</a>
      </div>

  google-analytics:
    tracking-id: "G-M21L0CBCVN"
    anonymize-ip: true
    version: 4

  comments:
    hypothesis:
      theme: clean
      openSidebar: false

  search:
    keyboard-shortcut: ["~", "/"]
    location: sidebar

  navbar:
    background: light
    search: true
    pinned: false
    collapse: false
    back-to-top-navigation: true
    title: "Machine Learning Systems"
    right:
      - icon: code
        text: "Labs"
        href: contents/labs/labs.qmd
      - icon: box
        text: "Kits" 
        href: contents/labs/kits.qmd
    tools:
      - icon: github
        menu:
          - text: "‚≠ê Star Repository"
            href: https://github.com/harvard-edge/cs249r_book
          - text: "üêõ Report Issue"
            href: https://github.com/harvard-edge/cs249r_book/issues
          - text: "ü§ù Contribute"
            href: https://github.com/harvard-edge/cs249r_book/blob/main/docs/contribute.md
          - text: "üí¨ Discussions"
            href: https://github.com/harvard-edge/cs249r_book/discussions

  favicon: ../assets/images/icons/favicon.png

  bread-crumbs: true

  sidebar:
    style: "floating"
    background: light
    collapse-level: 2
    search: true
    contents:
      # Minimal test sidebar
      # Website Navigation
      - text: "Homepage"
        href: index.qmd
      - text: "Foreword"
        href: contents/frontmatter/foreword.qmd
      - href: contents/frontmatter/about/about.qmd
      - href: contents/frontmatter/changelog/changelog.qmd
      - href: contents/frontmatter/acknowledgements/acknowledgements.qmd
      - text: "---"
      - href: contents/frontmatter/socratiq/socratiq.qmd
      - text: "---"
      
      # Foundations Part
      - section: "Systems Foundations"
        contents:
          - text: "Introduction"
            href: contents/core/introduction/introduction.qmd
          - text: "ML Systems"
            href: contents/core/ml_systems/ml_systems.qmd
          - href: contents/core/dl_primer/dl_primer.qmd
          - href: contents/core/dnn_architectures/dnn_architectures.qmd
      
      # Design Principles Part
      - section: "Design Principles"
        contents:
          - href: contents/core/workflow/workflow.qmd
          - href: contents/core/data_engineering/data_engineering.qmd
          - href: contents/core/frameworks/frameworks.qmd
          - href: contents/core/training/training.qmd
          - href: contents/core/efficient_ai/efficient_ai.qmd
          - href: contents/core/optimizations/optimizations.qmd
          - href: contents/core/hw_acceleration/hw_acceleration.qmd
          - href: contents/core/benchmarking/benchmarking.qmd
      
      # Best Practices Part
      - section: "Operational Practices"
        contents:
          - href: contents/core/ops/ops.qmd
          - href: contents/core/ondevice_learning/ondevice_learning.qmd
          - href: contents/core/privacy_security/privacy_security.qmd
          - href: contents/core/responsible_ai/responsible_ai.qmd
          - href: contents/core/sustainable_ai/sustainable_ai.qmd
          - href: contents/core/robust_ai/robust_ai.qmd
      
      # Impact & Outlook Part
      - section: "Impact"
        contents:
          - href: contents/core/ai_for_good/ai_for_good.qmd
          - href: contents/core/conclusion/conclusion.qmd
      
      - text: "---"
      
      # Labs Section
      - section: "üß™ Labs"
        href: contents/labs/labs.qmd
        contents:
          - href: contents/labs/labs.qmd
          - href: contents/labs/kits.qmd
          - href: contents/labs/ide_setup.qmd
          
      # Arduino Labs
      - section: "üîß Arduino Labs"
        collapsed: true
        contents:
          - href: contents/labs/arduino/nicla_vision/nicla_vision.qmd
          - href: contents/labs/arduino/nicla_vision/setup/setup.qmd
          - href: contents/labs/arduino/nicla_vision/image_classification/image_classification.qmd
          - href: contents/labs/arduino/nicla_vision/object_detection/object_detection.qmd
          - href: contents/labs/arduino/nicla_vision/kws/kws.qmd
          - href: contents/labs/arduino/nicla_vision/motion_classification/motion_classification.qmd

      # Seeed XIAO ESP32S3 Labs
      - section: "üå± Seeed XIAO ESP32S3 Labs"
        collapsed: true
        contents:
          - href: contents/labs/seeed/xiao_esp32s3/xiao_esp32s3.qmd
          - href: contents/labs/seeed/xiao_esp32s3/setup/setup.qmd
          - href: contents/labs/seeed/xiao_esp32s3/image_classification/image_classification.qmd
          - href: contents/labs/seeed/xiao_esp32s3/object_detection/object_detection.qmd
          - href: contents/labs/seeed/xiao_esp32s3/kws/kws.qmd
          - href: contents/labs/seeed/xiao_esp32s3/motion_classification/motion_classification.qmd

      # Seeed Grove Vision AI V2 Labs
      - section: "üå± Seeed Grove Vision AI V2 Labs"
        collapsed: true
        contents:
          - href: contents/labs/seeed/grove_vision_ai_v2/grove_vision_ai_v2.qmd
          - href: contents/labs/seeed/grove_vision_ai_v2/setup_and_no_code_apps/setup_and_no_code_apps.qmd
          - href: contents/labs/seeed/grove_vision_ai_v2/image_classification/image_classification.qmd
          - href: contents/labs/seeed/grove_vision_ai_v2/object_detection/object_detection.qmd
      
      # Raspberry Pi Labs
      - section: "ü•ß Raspberry Pi Labs"
        collapsed: true
        contents:
          - text: "Overview"
            href: contents/labs/raspi/raspi.qmd
          - href: contents/labs/raspi/setup/setup.qmd
          - href: contents/labs/raspi/image_classification/image_classification.qmd
          - href: contents/labs/raspi/object_detection/object_detection.qmd
          - href: contents/labs/raspi/llm/llm.qmd
          - href: contents/labs/raspi/vlm/vlm.qmd
      
      # Shared Labs
      - section: "üõ†Ô∏è Shared Tools"
        collapsed: true
        contents:
          - href: contents/labs/shared/shared.qmd
          - href: contents/labs/shared/kws_feature_eng/kws_feature_eng.qmd
          - href: contents/labs/shared/dsp_spectral_features_block/dsp_spectral_features_block.qmd
      
      - text: "---"
      
      # Backmatter
      - section: "üìö References & Resources"
        collapsed: true
        contents:
          - text: "Complete Bibliography"
            href: contents/backmatter/references.qmd
          - text: "---"
          - text: "PhD Survival Guide"
            href: contents/backmatter/resources/phd_survival_guide.qmd

  page-navigation: true

  repo-url: https://github.com/harvard-edge/cs249r_book
  repo-branch: widget_quiz
  repo-actions: [edit, issue, source]

  page-footer:
    left: |
      Written, edited and curated by Prof. Vijay Janapa Reddi (Harvard University)
    right: |
      This website was built with <a href="https://quarto.org/">Quarto</a>.

bibliography:
  - contents/core/introduction/introduction.bib
  - contents/core/ai_for_good/ai_for_good.bib
  - contents/core/benchmarking/benchmarking.bib
  - contents/core/data_engineering/data_engineering.bib
  - contents/core/dl_primer/dl_primer.bib
  - contents/core/dnn_architectures/dnn_architectures.bib
  - contents/core/efficient_ai/efficient_ai.bib
  - contents/core/ml_systems/ml_systems.bib
  - contents/core/frameworks/frameworks.bib
  - contents/core/hw_acceleration/hw_acceleration.bib
  - contents/core/ondevice_learning/ondevice_learning.bib
  - contents/core/ops/ops.bib
  - contents/core/optimizations/optimizations.bib
  - contents/core/privacy_security/privacy_security.bib
  - contents/core/responsible_ai/responsible_ai.bib
  - contents/core/robust_ai/robust_ai.bib
  - contents/core/sustainable_ai/sustainable_ai.bib
  - contents/core/training/training.bib
  - contents/core/workflow/workflow.bib
  - contents/core/conclusion/conclusion.bib

comments:
 giscus:
   repo: harvard-edge/cs249r_book

crossref:
  appendix-title: "Appendix"
  appendix-delim: ":"

  custom:
    - kind: float
      key: vid
      latex-env: vid
      reference-prefix: Video



filters:
  - diagram
  - custom-numbered-blocks
  - ../config/lua/inject_quizzes.lua
  - diagram
  - ../config/lua/inject_crossrefs.lua
  - custom-numbered-blocks
  - ../config/lua/margin-connections.lua

# Filter configurations and metadata
filter-metadata:
  # Quiz configuration for inject_quizzes.lua filter
  quiz-config:
    file-pattern: "*_quizzes.json"
    scan-directory: "contents/core"
    auto-discover-pdf: false

  # Cross-reference injection configuration for inject_crossrefs.lua filter  
  cross-references:
    file: "data/cross_refs_final.json"
    enabled: true

  # Part summaries injection configuration for inject-partsummary.lua filter
  part-summaries:
    file: "part_summaries.yml"
    enabled: true

diagram:
  engine:
    dot: true
    mermaid: true
    asymptote: false
    tikz:
      execpath: lualatex
      output-format: svg
      header-includes:
        - '\usepackage{tikz}'
        - '\usepackage{pgfplots}'
        - '\usepackage{pgf-pie}'
        - '\usepackage{amsmath}'
        - '\usepackage{amssymb}'
        - '\usepackage{xcolor}'
        - '\pgfplotsset{compat=1.9}'
        - '\usepgfplotslibrary{fillbetween}'      
        - '\usetikzlibrary{angles}'
        - '\usetikzlibrary{arrows.meta}'
        - '\usetikzlibrary{arrows}'
        - '\usetikzlibrary{backgrounds}'
        - '\usetikzlibrary{bending}'
        - '\usetikzlibrary{calc}'
        - '\usetikzlibrary{fit}'
        - '\usetikzlibrary{intersections}'
        - '\usetikzlibrary{positioning}'
        - '\usetikzlibrary{shapes.geometric}'
        - '\usetikzlibrary{shapes}'
        - '\usetikzlibrary{quotes}'
        - '\usetikzlibrary{decorations.pathmorphing}'
        - '\usetikzlibrary{matrix}'
        - '\usepgfplotslibrary{dateplot}'
        - '\definecolor{Brown}{rgb}{0.65, 0.16, 0.16}'
        - '\definecolor{BrownL}{rgb}{0.6, 0.4, 0.2}'
        - '\definecolor{BrownLine}{rgb}{0.5, 0.3, 0.1}'
        - '\definecolor{BackColor}{RGB}{255,255,229}'
        - '\definecolor{BackLine}{RGB}{181,181,72}'
        - '\definecolor{BlueD}{RGB}{62,100,125}'
        - '\definecolor{BlueL}{RGB}{209,243,255}'
        - '\definecolor{BlueLine}{RGB}{34,148,189}'
        - '\definecolor{BrownL}{RGB}{233,222,220}'
        - '\definecolor{BrownLine}{RGB}{143,120,116}'
        - '\definecolor{Green}{rgb}{0.0, 0.5, 0.0}'
        - '\definecolor{GreenD}{RGB}{40,117,40}'
        - '\definecolor{GreenL}{RGB}{219,253,166}'
        - '\definecolor{GreenLine}{RGB}{73,89,56}'
        - '\definecolor{OliveL}{RGB}{230,227,191}'
        - '\definecolor{OliveLine}{RGB}{173,166,10}'
        - '\definecolor{OrangeL}{RGB}{250,212,175}'
        - '\definecolor{OrangeLine}{RGB}{255,127,76}'
        - '\definecolor{RedL}{RGB}{253,226,240}'
        - '\definecolor{RedLine}{RGB}{201,20,110}'
        - '\definecolor{Sepia}{rgb}{0.44, 0.26, 0.08}'
        - '\definecolor{TextColor}{RGB}{224,224,224}'
        - '\definecolor{VioletL}{RGB}{247,180,247}'
        - '\definecolor{VioletL2}{RGB}{243,243,255}'
        - '\definecolor{VioletLine}{RGB}{34,125,189}'

editor:
  render-on-save: true

format:
  html:
    lightbox: true
    mermaid:
      theme: default
    theme:
      light:
        - default
        - ../assets/styles/style-light.scss

    code-block-bg: true

    table:
      classes: [table-striped, table-hover]

    language:
      title-block-author-single: "Author, Editor & Curator"
      title-block-published: "Last Updated"

    reference-location: margin
    citation-location: margin
    sidenote: true
    linkcolor: "#A51C30"
    urlcolor: "#A51C30"
    highlight-style: github
    code-link: true
    link-external-icon: false
    link-external-newwindow: true
    anchor-sections: true
    smooth-scroll: false
    citations-hover: false
    footnotes-hover: false
    fig-width: 7
    fig-height: 5
    toc: true
    toc-depth: 4
    toc-expand: true
    toc-title: "On this page"
    number-sections: false
    number-depth: 3
    include-in-header:
      text: |
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

        <script async src="https://www.googletagmanager.com/gtag/js?id=G-M21L0CBCVN"></script>
        <script type="module"  src="/tools/scripts/ai_menu/dist/bundle.js" defer></script>
        <script type="module" src="/tools/scripts/ai_menu/dist/sqlite3-opfs-async-proxy-B_ImRJXp.js"></script>
        <script type="module" src="/tools/scripts/ai_menu/dist/sqlite3-worker1-bundler-friendly-CbDNa4by.js"></script>
        <script type="module" src="/tools/scripts/ai_menu/dist/worker-voUF5YDa.js"></script>

    citeproc: true

custom-numbered-blocks:
  groups:
    quiz-question:
      colors: ["E1F3F8", "119EC7"]
      collapse: false
    quiz-answer:
      colors: ["FAEAF1", "980e5a"]
      collapse: true
    resource-slides:
      colors: ["E9F3E3", "55984D"]
      collapse: false
      numbered: false
    resource-videos:
      colors:  ["f9f5f0", "8b5e3c"]
      collapse: false
      numbered: false
    resource-exercises:
      colors: ["f7f0fa", "815AA4"]
      collapse: false
      numbered: false
    chapter-connection:
      colors: ["FDF2F7", "ED3237"]
      boxstyle: foldbox.simple
      collapse: true
      numbered: false
    chapter-forward:
      colors: ["FDF2F7", "ED3237"]
      boxstyle: foldbox.simple
      collapse: true
      numbered: false
    chapter-recall:
      colors: ["FFF4E6", "E67E22"]
      collapse: false
      numbered: false
  classes:
    callout-quiz-question: 
      label: "Self-Check: Question"
      group: quiz-question
    callout-quiz-answer:
      label: "Self-Check: Answer"
      group: quiz-answer
    callout-resource-slides:
      label: "Slides"
      group: resource-slides
    callout-resource-videos:
      label: "Videos"
      group: resource-videos
    callout-resource-exercises:
      label: "Exercises"
      group: resource-exercises 
    callout-chapter-connection:
      label: "Chapter connections"
      group: chapter-connection

resources:
  - CNAME 