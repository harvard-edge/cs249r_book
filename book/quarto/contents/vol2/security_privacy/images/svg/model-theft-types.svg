<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arr-mt" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#4a90c4"/>
    </marker>
    <marker id="arr-red-mt" markerWidth="8" markerHeight="6" refX="4" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#a31f34"/>
    </marker>
  </defs>

  <rect width="680" height="460" fill="#fff"/>

  <!-- Column headers -->
  <rect x="20" y="22" width="290" height="36" rx="5" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.5"/>
  <text x="165" y="45" font-size="12" font-weight="700" fill="#a31f34" text-anchor="middle">Exact Extraction</text>

  <rect x="370" y="22" width="290" height="36" rx="5" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5"/>
  <text x="515" y="45" font-size="12" font-weight="700" fill="#c87b2a" text-anchor="middle">Approximate Theft</text>

  <!-- Center label: API access only needed -->
  <rect x="252" y="204" width="176" height="36" rx="4" fill="#e0e0e0" stroke="#999" stroke-width="1.2"/>
  <text x="340" y="221" font-size="9" font-weight="700" fill="#444" text-anchor="middle">API access only needed</text>
  <text x="340" y="234" font-size="8.5" fill="#666" text-anchor="middle">(no model weights required)</text>

  <!-- === LEFT WORKFLOW: Exact Extraction === -->

  <!-- Step 1L: Attacker sends many queries -->
  <rect x="30" y="80" width="270" height="50" rx="4" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.2"/>
  <!-- Attacker icon -->
  <circle cx="58" cy="105" r="10" fill="#a31f34" opacity="0.25"/>
  <text x="57" y="109" font-size="10" fill="#a31f34" text-anchor="middle">&#x1F464;</text>
  <text x="165" y="101" font-size="10" font-weight="700" fill="#a31f34" text-anchor="middle">Attacker sends many queries</text>
  <text x="165" y="117" font-size="8.5" fill="#555" text-anchor="middle">Systematic inputs covering input space</text>

  <line x1="165" y1="130" x2="165" y2="150" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-mt)"/>

  <!-- Step 2L: Collects (input, output) pairs -->
  <rect x="30" y="152" width="270" height="50" rx="4" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="165" y="173" font-size="10" font-weight="700" fill="#1e4f7a" text-anchor="middle">Collects (input, output) pairs</text>
  <!-- Dataset icon: small table representation -->
  <rect x="38" y="165" width="32" height="20" rx="2" fill="#fff" stroke="#4a90c4" stroke-width="0.8"/>
  <line x1="38" y1="172" x2="70" y2="172" stroke="#4a90c4" stroke-width="0.5"/>
  <line x1="50" y1="165" x2="50" y2="185" stroke="#4a90c4" stroke-width="0.5"/>
  <text x="165" y="189" font-size="8.5" fill="#555" text-anchor="middle">N queries &#x2192; N labeled (x, f(x)) records</text>

  <line x1="165" y1="202" x2="165" y2="222" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-mt)"/>

  <!-- Step 3L: Trains clone model -->
  <!-- Gap: center label sits here (y=204-240) -->
  <line x1="165" y1="240" x2="165" y2="260" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-mt)"/>

  <rect x="30" y="262" width="270" height="62" rx="4" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="165" y="281" font-size="10" font-weight="700" fill="#1e4f7a" text-anchor="middle">Trains clone model</text>
  <!-- Model icon: layered rectangles -->
  <rect x="38" y="288" width="34" height="4" rx="1" fill="#4a90c4" opacity="0.8"/>
  <rect x="40" y="296" width="30" height="4" rx="1" fill="#4a90c4" opacity="0.6"/>
  <rect x="42" y="304" width="26" height="4" rx="1" fill="#4a90c4" opacity="0.4"/>
  <text x="165" y="300" font-size="8.5" fill="#555" text-anchor="middle">Supervised learning on stolen dataset</text>
  <text x="165" y="314" font-size="8.5" fill="#555" text-anchor="middle">Objective: min loss on (x, f(x)) pairs</text>

  <line x1="165" y1="324" x2="165" y2="344" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-mt)"/>

  <!-- Step 4L: Weights match original -->
  <rect x="30" y="346" width="270" height="54" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.5"/>
  <text x="165" y="366" font-size="10" font-weight="700" fill="#1a5c30" text-anchor="middle">Clone model &#x2248; original weights</text>
  <text x="165" y="382" font-size="8.5" fill="#555" text-anchor="middle">High-fidelity copy; can match exact</text>
  <text x="165" y="395" font-size="8.5" fill="#555" text-anchor="middle">decision boundaries and confidence scores</text>

  <!-- === RIGHT WORKFLOW: Approximate Theft === -->

  <!-- Step 1R: Queries API -->
  <rect x="380" y="80" width="270" height="50" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.2"/>
  <circle cx="408" cy="105" r="10" fill="#c87b2a" opacity="0.2"/>
  <text x="407" y="109" font-size="10" fill="#c87b2a" text-anchor="middle">&#x1F464;</text>
  <text x="515" y="101" font-size="10" font-weight="700" fill="#c87b2a" text-anchor="middle">Attacker queries API</text>
  <text x="515" y="117" font-size="8.5" fill="#555" text-anchor="middle">Targeted or random inputs; fewer queries</text>

  <line x1="515" y1="130" x2="515" y2="150" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-mt)"/>

  <!-- Step 2R: Observes confidence scores -->
  <rect x="380" y="152" width="270" height="50" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.2"/>
  <text x="515" y="173" font-size="10" font-weight="700" fill="#c87b2a" text-anchor="middle">Observes confidence scores</text>
  <text x="515" y="189" font-size="8.5" fill="#555" text-anchor="middle">Soft labels: [0.82, 0.12, 0.04, 0.02, ...]</text>

  <line x1="515" y1="202" x2="515" y2="222" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-mt)"/>
  <line x1="515" y1="240" x2="515" y2="260" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-mt)"/>

  <!-- Step 3R: Distills knowledge -->
  <rect x="380" y="262" width="270" height="62" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.2"/>
  <text x="515" y="281" font-size="10" font-weight="700" fill="#c87b2a" text-anchor="middle">Distills knowledge</text>
  <!-- Smaller model icon -->
  <rect x="388" y="292" width="28" height="4" rx="1" fill="#c87b2a" opacity="0.8"/>
  <rect x="390" y="300" width="24" height="4" rx="1" fill="#c87b2a" opacity="0.5"/>
  <text x="515" y="300" font-size="8.5" fill="#555" text-anchor="middle">Knowledge distillation: train student</text>
  <text x="515" y="314" font-size="8.5" fill="#555" text-anchor="middle">model on soft-label outputs</text>

  <line x1="515" y1="324" x2="515" y2="344" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-mt)"/>

  <!-- Step 4R: Functional clone (lower fidelity) -->
  <rect x="380" y="346" width="270" height="54" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.5"/>
  <text x="515" y="366" font-size="10" font-weight="700" fill="#1a5c30" text-anchor="middle">Functional clone (lower fidelity)</text>
  <text x="515" y="382" font-size="8.5" fill="#555" text-anchor="middle">Captures task knowledge; accuracy may</text>
  <text x="515" y="395" font-size="8.5" fill="#555" text-anchor="middle">be 90â€“98% of original depending on queries</text>

  <!-- Bottom annotation -->
  <text x="340" y="440" font-size="9" fill="#999" text-anchor="middle" font-style="italic">Both attack types require only black-box API access; defenses include watermarking, rate limiting, and output perturbation.</text>
</svg>
