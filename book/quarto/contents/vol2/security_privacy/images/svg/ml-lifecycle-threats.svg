<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arr-down" markerWidth="8" markerHeight="6" refX="4" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#4a90c4"/>
    </marker>
    <marker id="arr-threat" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#a31f34"/>
    </marker>
  </defs>

  <rect width="680" height="460" fill="#fff"/>

  <!-- Pipeline stage definitions: cy = center y of each box -->
  <!-- Stages at y: 44, 108, 172, 236, 300, 364 (height 44 each, gap 20) -->

  <!-- Stage boxes (pipeline, centered at x=340, width=200) -->
  <!-- Data Collection -->
  <rect x="240" y="36" width="200" height="44" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="340" y="55" font-size="11" font-weight="700" fill="#1e4f7a" text-anchor="middle">Data Collection</text>
  <text x="340" y="71" font-size="9" fill="#555" text-anchor="middle">Raw inputs, sensors, web scraping</text>

  <!-- Arrow -->
  <line x1="340" y1="80" x2="340" y2="98" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-down)"/>

  <!-- Data Preprocessing -->
  <rect x="240" y="100" width="200" height="44" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="340" y="119" font-size="11" font-weight="700" fill="#1e4f7a" text-anchor="middle">Data Preprocessing</text>
  <text x="340" y="135" font-size="9" fill="#555" text-anchor="middle">Cleaning, labeling, feature eng.</text>

  <!-- Arrow -->
  <line x1="340" y1="144" x2="340" y2="162" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-down)"/>

  <!-- Model Training -->
  <rect x="240" y="164" width="200" height="44" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="340" y="183" font-size="11" font-weight="700" fill="#1e4f7a" text-anchor="middle">Model Training</text>
  <text x="340" y="199" font-size="9" fill="#555" text-anchor="middle">Gradient descent, distributed opt.</text>

  <!-- Arrow -->
  <line x1="340" y1="208" x2="340" y2="226" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-down)"/>

  <!-- Model Evaluation -->
  <rect x="240" y="228" width="200" height="44" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="340" y="247" font-size="11" font-weight="700" fill="#1e4f7a" text-anchor="middle">Model Evaluation</text>
  <text x="340" y="263" font-size="9" fill="#555" text-anchor="middle">Benchmarks, test sets, metrics</text>

  <!-- Arrow -->
  <line x1="340" y1="272" x2="340" y2="290" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-down)"/>

  <!-- Deployment -->
  <rect x="240" y="292" width="200" height="44" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="340" y="311" font-size="11" font-weight="700" fill="#1e4f7a" text-anchor="middle">Deployment</text>
  <text x="340" y="327" font-size="9" fill="#555" text-anchor="middle">Packaging, serving infrastructure</text>

  <!-- Arrow -->
  <line x1="340" y1="336" x2="340" y2="354" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-down)"/>

  <!-- Inference -->
  <rect x="240" y="356" width="200" height="44" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="340" y="375" font-size="11" font-weight="700" fill="#1e4f7a" text-anchor="middle">Inference</text>
  <text x="340" y="391" font-size="9" fill="#555" text-anchor="middle">Real-time predictions, API calls</text>

  <!-- THREAT ARROWS from left -->
  <!-- Threat 1: Data Poisoning at Data Collection -->
  <rect x="30" y="40" width="148" height="36" rx="4" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.3"/>
  <text x="104" y="57" font-size="10" font-weight="700" fill="#a31f34" text-anchor="middle">Data Poisoning</text>
  <text x="104" y="70" font-size="8.5" fill="#555" text-anchor="middle">Corrupt training inputs</text>
  <line x1="178" y1="58" x2="238" y2="58" stroke="#a31f34" stroke-width="1.5" marker-end="url(#arr-threat)"/>

  <!-- Threat 2: Backdoor Injection at Data Preprocessing -->
  <rect x="30" y="104" width="148" height="36" rx="4" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.3"/>
  <text x="104" y="121" font-size="10" font-weight="700" fill="#a31f34" text-anchor="middle">Backdoor Injection</text>
  <text x="104" y="134" font-size="8.5" fill="#555" text-anchor="middle">Embed trigger patterns</text>
  <line x1="178" y1="122" x2="238" y2="122" stroke="#a31f34" stroke-width="1.5" marker-end="url(#arr-threat)"/>

  <!-- Threat 3: Gradient Leakage at Model Training -->
  <rect x="30" y="168" width="148" height="36" rx="4" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.3"/>
  <text x="104" y="185" font-size="10" font-weight="700" fill="#a31f34" text-anchor="middle">Gradient Leakage</text>
  <text x="104" y="198" font-size="8.5" fill="#555" text-anchor="middle">Infer training data from grads</text>
  <line x1="178" y1="186" x2="238" y2="186" stroke="#a31f34" stroke-width="1.5" marker-end="url(#arr-threat)"/>

  <!-- Threat 4: Metric Gaming at Model Evaluation -->
  <rect x="30" y="232" width="148" height="36" rx="4" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.3"/>
  <text x="104" y="249" font-size="10" font-weight="700" fill="#a31f34" text-anchor="middle">Metric Gaming</text>
  <text x="104" y="262" font-size="8.5" fill="#555" text-anchor="middle">Overfit to benchmark datasets</text>
  <line x1="178" y1="250" x2="238" y2="250" stroke="#a31f34" stroke-width="1.5" marker-end="url(#arr-threat)"/>

  <!-- Threat 5: Model Theft at Deployment -->
  <rect x="30" y="296" width="148" height="36" rx="4" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.3"/>
  <text x="104" y="313" font-size="10" font-weight="700" fill="#a31f34" text-anchor="middle">Model Theft</text>
  <text x="104" y="326" font-size="8.5" fill="#555" text-anchor="middle">Extract via repeated API queries</text>
  <line x1="178" y1="314" x2="238" y2="314" stroke="#a31f34" stroke-width="1.5" marker-end="url(#arr-threat)"/>

  <!-- Threat 6: Adversarial Examples at Inference -->
  <rect x="30" y="360" width="148" height="36" rx="4" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.3"/>
  <text x="104" y="377" font-size="10" font-weight="700" fill="#a31f34" text-anchor="middle">Adversarial Examples</text>
  <text x="104" y="390" font-size="8.5" fill="#555" text-anchor="middle">Craft inputs to fool model</text>
  <line x1="178" y1="378" x2="238" y2="378" stroke="#a31f34" stroke-width="1.5" marker-end="url(#arr-threat)"/>

  <!-- Legend -->
  <rect x="30" y="426" width="12" height="12" rx="2" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1"/>
  <text x="48" y="437" font-size="9" fill="#555">Pipeline stage</text>
  <rect x="160" y="426" width="12" height="12" rx="2" fill="#f9d6d5" stroke="#a31f34" stroke-width="1"/>
  <text x="178" y="437" font-size="9" fill="#555">Threat vector</text>
  <line x1="280" y1="432" x2="300" y2="432" stroke="#a31f34" stroke-width="1.5" marker-end="url(#arr-threat)"/>
  <text x="306" y="437" font-size="9" fill="#555">Attack entry point</text>

  <!-- Bottom annotation -->
  <text x="340" y="455" font-size="9" fill="#999" text-anchor="middle" font-style="italic">Threats exist at every lifecycle stage; defenses must be applied throughout the pipeline, not only at deployment.</text>
</svg>
