<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arr-boot" markerWidth="8" markerHeight="6" refX="4" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#4a90c4"/>
    </marker>
    <marker id="arr-fail" markerWidth="8" markerHeight="6" refX="4" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#a31f34"/>
    </marker>
    <marker id="arr-chk" markerWidth="8" markerHeight="6" refX="4" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#3d9e5a"/>
    </marker>
  </defs>

  <rect width="680" height="460" fill="#fff"/>

  <!-- Column headers -->
  <rect x="60" y="24" width="180" height="34" rx="4" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="150" y="46" font-size="12" font-weight="700" fill="#1e4f7a" text-anchor="middle">Boot Sequence</text>

  <rect x="380" y="24" width="220" height="34" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.5"/>
  <text x="490" y="46" font-size="12" font-weight="700" fill="#1a5c30" text-anchor="middle">Verification Step</text>

  <!-- Step 1: ROM -->
  <rect x="60" y="80" width="180" height="50" rx="5" fill="#e0e0e0" stroke="#999" stroke-width="1.5"/>
  <text x="150" y="102" font-size="12" font-weight="700" fill="#444" text-anchor="middle">ROM</text>
  <text x="150" y="118" font-size="9" fill="#666" text-anchor="middle">Immutable boot code (on-chip)</text>

  <!-- Verification 1: Hash verification -->
  <rect x="380" y="80" width="220" height="50" rx="5" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="490" y="102" font-size="10.5" font-weight="700" fill="#1a5c30" text-anchor="middle">Hash Verification</text>
  <text x="490" y="118" font-size="8.5" fill="#555" text-anchor="middle">SHA-256 of bootloader against ROM golden hash</text>
  <!-- Checkmark -->
  <text x="350" y="110" font-size="16" fill="#3d9e5a" text-anchor="middle">&#x2713;</text>
  <!-- Arrow from stage to verification -->
  <line x1="242" y1="105" x2="378" y2="105" stroke="#3d9e5a" stroke-width="1.3" marker-end="url(#arr-chk)"/>

  <!-- Down arrow: ROM → Bootloader -->
  <line x1="150" y1="130" x2="150" y2="156" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-boot)"/>

  <!-- Step 2: Bootloader -->
  <rect x="60" y="158" width="180" height="50" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="150" y="180" font-size="12" font-weight="700" fill="#1e4f7a" text-anchor="middle">Bootloader</text>
  <text x="150" y="196" font-size="9" fill="#555" text-anchor="middle">First stage boot manager</text>

  <!-- Verification 2: Signature check -->
  <rect x="380" y="158" width="220" height="50" rx="5" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="490" y="180" font-size="10.5" font-weight="700" fill="#1a5c30" text-anchor="middle">Signature Check</text>
  <text x="490" y="196" font-size="8.5" fill="#555" text-anchor="middle">RSA/ECDSA signature vs. embedded public key</text>
  <text x="350" y="188" font-size="16" fill="#3d9e5a" text-anchor="middle">&#x2713;</text>
  <line x1="242" y1="183" x2="378" y2="183" stroke="#3d9e5a" stroke-width="1.3" marker-end="url(#arr-chk)"/>

  <!-- Down arrow: Bootloader → Kernel -->
  <line x1="150" y1="208" x2="150" y2="234" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-boot)"/>

  <!-- Step 3: Kernel -->
  <rect x="60" y="236" width="180" height="50" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="150" y="258" font-size="12" font-weight="700" fill="#1e4f7a" text-anchor="middle">Kernel</text>
  <text x="150" y="274" font-size="9" fill="#555" text-anchor="middle">OS kernel image + initramfs</text>

  <!-- Verification 3: Certificate validation -->
  <rect x="380" y="236" width="220" height="50" rx="5" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="490" y="258" font-size="10.5" font-weight="700" fill="#1a5c30" text-anchor="middle">Certificate Validation</text>
  <text x="490" y="274" font-size="8.5" fill="#555" text-anchor="middle">X.509 chain of trust to root CA in ROM</text>
  <text x="350" y="266" font-size="16" fill="#3d9e5a" text-anchor="middle">&#x2713;</text>
  <line x1="242" y1="261" x2="378" y2="261" stroke="#3d9e5a" stroke-width="1.3" marker-end="url(#arr-chk)"/>

  <!-- Down arrow: Kernel → OS -->
  <line x1="150" y1="286" x2="150" y2="312" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-boot)"/>

  <!-- Step 4: OS -->
  <rect x="60" y="314" width="180" height="50" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="150" y="336" font-size="12" font-weight="700" fill="#1e4f7a" text-anchor="middle">OS</text>
  <text x="150" y="352" font-size="9" fill="#555" text-anchor="middle">Operating system + drivers</text>

  <!-- Verification 4: Integrity measurement -->
  <rect x="380" y="314" width="220" height="50" rx="5" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="490" y="336" font-size="10.5" font-weight="700" fill="#1a5c30" text-anchor="middle">Integrity Measurement</text>
  <text x="490" y="352" font-size="8.5" fill="#555" text-anchor="middle">TPM PCR extend: cumulative boot log</text>
  <text x="350" y="344" font-size="16" fill="#3d9e5a" text-anchor="middle">&#x2713;</text>
  <line x1="242" y1="339" x2="378" y2="339" stroke="#3d9e5a" stroke-width="1.3" marker-end="url(#arr-chk)"/>

  <!-- Down arrow: OS → Application -->
  <line x1="150" y1="364" x2="150" y2="390" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-boot)"/>

  <!-- Step 5: Application -->
  <rect x="60" y="392" width="180" height="44" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="150" y="412" font-size="12" font-weight="700" fill="#1e4f7a" text-anchor="middle">Application</text>
  <text x="150" y="428" font-size="9" fill="#555" text-anchor="middle">ML inference binary / runtime</text>

  <!-- Verification 5: Pass -->
  <rect x="380" y="392" width="220" height="44" rx="5" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="490" y="412" font-size="10.5" font-weight="700" fill="#1a5c30" text-anchor="middle">Boot Attestation Complete</text>
  <text x="490" y="428" font-size="8.5" fill="#555" text-anchor="middle">Remote verifier receives signed boot log</text>
  <text x="350" y="420" font-size="16" fill="#3d9e5a" text-anchor="middle">&#x2713;</text>
  <line x1="242" y1="414" x2="378" y2="414" stroke="#3d9e5a" stroke-width="1.3" marker-end="url(#arr-chk)"/>

  <!-- FAILURE branch: from OS verification, sideways to halt -->
  <!-- Red X failure state -->
  <rect x="380" y="246" width="30" height="24" rx="3" fill="#f9d6d5" stroke="#a31f34" stroke-width="1" opacity="0.0"/>
  <!-- Failure label at right of Kernel verification -->
  <rect x="616" y="248" width="48" height="34" rx="4" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.5"/>
  <text x="640" y="263" font-size="9" font-weight="700" fill="#a31f34" text-anchor="middle">FAIL</text>
  <text x="640" y="275" font-size="8" fill="#a31f34" text-anchor="middle">&#x2717;</text>
  <!-- Arrow from verification to fail -->
  <line x1="600" y1="261" x2="614" y2="261" stroke="#a31f34" stroke-width="1.3" marker-end="url(#arr-fail)"/>

  <!-- Boot halted box -->
  <rect x="616" y="298" width="48" height="36" rx="4" fill="#a31f34" stroke="#7a0e1a" stroke-width="1.5"/>
  <text x="640" y="316" font-size="8.5" font-weight="700" fill="#fff" text-anchor="middle">Boot</text>
  <text x="640" y="328" font-size="8.5" font-weight="700" fill="#fff" text-anchor="middle">Halted</text>
  <line x1="640" y1="282" x2="640" y2="296" stroke="#a31f34" stroke-width="1.3" marker-end="url(#arr-fail)"/>

  <!-- Legend -->
  <text x="60" y="450" font-size="9" fill="#3d9e5a">&#x2713; = Verification passed</text>
  <text x="200" y="450" font-size="9" fill="#a31f34">&#x2717; = Verification failed &#x2192; chain stops</text>
  <text x="430" y="450" font-size="9" fill="#555" font-style="italic">All steps use hardware root-of-trust anchored in ROM</text>
</svg>
