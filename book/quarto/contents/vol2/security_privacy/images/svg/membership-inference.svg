<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#333"/>
    </marker>
    <marker id="arrow-red" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#a31f34"/>
    </marker>
  </defs>

  <rect width="680" height="460" fill="#fff"/>

  <!-- Attack flow: top section -->
  <!-- Attacker probe -->
  <g transform="translate(20, 40)">
    <rect x="0" y="0" width="100" height="60" rx="6" fill="#f9d6d5" stroke="#c44" stroke-width="1.5"/>
    <text x="50" y="24" font-size="10" font-weight="700" fill="#a31f34" text-anchor="middle">Attacker</text>
    <text x="50" y="40" font-size="9" fill="#555" text-anchor="middle">sends probe</text>
    <text x="50" y="52" font-size="9" fill="#555" text-anchor="middle">query x</text>
  </g>

  <!-- Arrow -->
  <line x1="122" y1="70" x2="152" y2="70" stroke="#333" stroke-width="1.2" marker-end="url(#arrow)"/>

  <!-- Target Model (black-box) -->
  <g transform="translate(155, 30)">
    <rect x="0" y="0" width="120" height="80" rx="6" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
    <text x="60" y="28" font-size="11" font-weight="700" fill="#333" text-anchor="middle">Target Model</text>
    <text x="60" y="44" font-size="9" fill="#555" text-anchor="middle">Black-box API</text>
    <rect x="10" y="52" width="100" height="20" rx="3" fill="#f7f7f7" stroke="#bbb" stroke-width="0.8"/>
    <text x="60" y="66" font-size="8" fill="#555" text-anchor="middle">f(x) = [0.92, 0.05, 0.03]</text>
  </g>

  <!-- Arrow -->
  <line x1="277" y1="70" x2="307" y2="70" stroke="#333" stroke-width="1.2" marker-end="url(#arrow)"/>

  <!-- Confidence scores -->
  <g transform="translate(310, 40)">
    <rect x="0" y="0" width="110" height="60" rx="6" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5"/>
    <text x="55" y="22" font-size="10" font-weight="700" fill="#333" text-anchor="middle">Confidence</text>
    <text x="55" y="38" font-size="10" font-weight="700" fill="#333" text-anchor="middle">Scores</text>
    <text x="55" y="52" font-size="9" fill="#555" text-anchor="middle">p(y|x)</text>
  </g>

  <!-- Arrow -->
  <line x1="422" y1="70" x2="452" y2="70" stroke="#333" stroke-width="1.2" marker-end="url(#arrow)"/>

  <!-- Shadow classifier -->
  <g transform="translate(455, 30)">
    <rect x="0" y="0" width="130" height="80" rx="6" fill="#f9d6d5" stroke="#c44" stroke-width="1.5"/>
    <text x="65" y="22" font-size="10" font-weight="700" fill="#a31f34" text-anchor="middle">Attack</text>
    <text x="65" y="37" font-size="10" font-weight="700" fill="#a31f34" text-anchor="middle">Classifier</text>
    <line x1="10" y1="45" x2="120" y2="45" stroke="#c44" stroke-width="0.6"/>
    <text x="65" y="60" font-size="9" fill="#555" text-anchor="middle">Threshold on</text>
    <text x="65" y="72" font-size="9" fill="#555" text-anchor="middle">confidence score</text>
  </g>

  <!-- Arrow to verdict -->
  <line x1="587" y1="70" x2="607" y2="70" stroke="#a31f34" stroke-width="1.5" marker-end="url(#arrow-red)"/>

  <!-- Verdict -->
  <g transform="translate(610, 40)">
    <rect x="0" y="0" width="55" height="60" rx="6" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.5"/>
    <text x="27" y="24" font-size="9" font-weight="700" fill="#3d9e5a" text-anchor="middle">IN</text>
    <text x="27" y="40" font-size="9" font-weight="700" fill="#3d9e5a" text-anchor="middle">TRAIN</text>
    <text x="27" y="54" font-size="9" font-weight="700" fill="#3d9e5a" text-anchor="middle">SET?</text>
  </g>

  <!-- Distribution comparison (bottom section) -->
  <!-- Axes for confidence distribution -->
  <g transform="translate(40, 160)">
    <!-- Y-axis -->
    <line x1="40" y1="220" x2="40" y2="10" stroke="#333" stroke-width="1.2"/>
    <!-- X-axis -->
    <line x1="40" y1="220" x2="320" y2="220" stroke="#333" stroke-width="1.2"/>

    <!-- Grid lines -->
    <line x1="40" y1="55" x2="320" y2="55" stroke="#e8e8e8" stroke-width="0.8"/>
    <line x1="40" y1="110" x2="320" y2="110" stroke="#e8e8e8" stroke-width="0.8"/>
    <line x1="40" y1="165" x2="320" y2="165" stroke="#e8e8e8" stroke-width="0.8"/>

    <!-- Axis labels -->
    <text x="180" y="248" font-size="11" font-weight="600" fill="#333" text-anchor="middle">Model Confidence Score</text>
    <text x="8" y="120" font-size="11" font-weight="600" fill="#333" text-anchor="middle" transform="rotate(-90, 8, 120)">Frequency</text>

    <!-- X ticks -->
    <text x="60" y="236" font-size="9" fill="#555" text-anchor="middle">0.0</text>
    <text x="110" y="236" font-size="9" fill="#555" text-anchor="middle">0.2</text>
    <text x="160" y="236" font-size="9" fill="#555" text-anchor="middle">0.4</text>
    <text x="210" y="236" font-size="9" fill="#555" text-anchor="middle">0.6</text>
    <text x="260" y="236" font-size="9" fill="#555" text-anchor="middle">0.8</text>
    <text x="310" y="236" font-size="9" fill="#555" text-anchor="middle">1.0</text>

    <!-- Non-training set distribution (red, lower confidence peak) -->
    <path d="M 60,220 Q 80,215 100,195 Q 130,140 155,110 Q 170,95 185,115 Q 210,160 240,195 Q 260,210 280,218 L 280,220 Z" fill="#f9d6d5" fill-opacity="0.6" stroke="#c44" stroke-width="1.5"/>

    <!-- Training set distribution (blue, higher confidence peak) -->
    <path d="M 160,220 Q 190,215 220,185 Q 240,140 260,60 Q 275,35 285,55 Q 295,100 305,160 Q 310,195 315,218 L 315,220 Z" fill="#cfe2f3" fill-opacity="0.6" stroke="#4a90c4" stroke-width="1.5"/>

    <!-- Threshold line -->
    <line x1="230" y1="15" x2="230" y2="220" stroke="#a31f34" stroke-width="1.5" stroke-dasharray="5,3"/>
    <text x="230" y="10" font-size="9" font-weight="700" fill="#a31f34" text-anchor="middle">Threshold</text>

    <!-- Legend -->
    <rect x="70" y="25" width="12" height="12" rx="2" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1"/>
    <text x="88" y="35" font-size="9" fill="#555">Training set (high confidence)</text>

    <rect x="70" y="44" width="12" height="12" rx="2" fill="#f9d6d5" stroke="#c44" stroke-width="1"/>
    <text x="88" y="54" font-size="9" fill="#555">Non-training (lower confidence)</text>
  </g>

  <!-- ROC curve inset (bottom-right) -->
  <g transform="translate(420, 180)">
    <rect x="0" y="0" width="230" height="190" rx="6" fill="#f7f7f7" stroke="#bbb" stroke-width="1.2"/>

    <text x="115" y="18" font-size="10" font-weight="700" fill="#333" text-anchor="middle">Attack Success (ROC)</text>

    <!-- ROC axes -->
    <line x1="40" y1="165" x2="40" y2="30" stroke="#333" stroke-width="1.2"/>
    <line x1="40" y1="165" x2="210" y2="165" stroke="#333" stroke-width="1.2"/>

    <!-- Grid -->
    <line x1="40" y1="97" x2="210" y2="97" stroke="#e8e8e8" stroke-width="0.8"/>
    <line x1="125" y1="165" x2="125" y2="30" stroke="#e8e8e8" stroke-width="0.8"/>

    <!-- Diagonal (random) -->
    <line x1="40" y1="165" x2="210" y2="30" stroke="#bbb" stroke-width="1" stroke-dasharray="4,3"/>

    <!-- ROC curve (above diagonal = successful attack) -->
    <path d="M 40,165 Q 55,100 80,72 Q 110,45 140,38 Q 170,34 210,30" fill="none" stroke="#a31f34" stroke-width="2"/>

    <!-- AUC shading -->
    <path d="M 40,165 Q 55,100 80,72 Q 110,45 140,38 Q 170,34 210,30 L 210,165 Z" fill="#a31f34" fill-opacity="0.08"/>

    <!-- AUC label -->
    <text x="140" y="130" font-size="9.5" font-weight="600" fill="#a31f34" text-anchor="middle">AUC = 0.85</text>

    <!-- Axis labels -->
    <text x="125" y="182" font-size="9" fill="#555" text-anchor="middle">False Positive Rate</text>
    <text x="18" y="100" font-size="9" fill="#555" text-anchor="middle" transform="rotate(-90, 18, 100)">True Positive Rate</text>
  </g>

  <!-- Key insight annotation â€” rect height increased to 46 so last text line (y=41) clears the bottom border -->
  <g transform="translate(420, 385)">
    <rect x="0" y="0" width="230" height="46" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1"/>
    <text x="115" y="15" font-size="9" font-weight="600" fill="#333" text-anchor="middle">Key insight: overfitting</text>
    <text x="115" y="28" font-size="9" font-weight="600" fill="#333" text-anchor="middle">increases memorization = more</text>
    <text x="115" y="41" font-size="9" font-weight="600" fill="#a31f34" text-anchor="middle">vulnerable to MIA</text>
  </g>

  <!-- Bottom annotation -->
  <text x="340" y="450" font-size="9" fill="#999" text-anchor="middle" font-style="italic">Models return higher confidence on memorized training data; attackers exploit this gap to infer membership.</text>
</svg>
