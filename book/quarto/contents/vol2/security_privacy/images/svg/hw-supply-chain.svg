<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arr-fwd" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#4a90c4"/>
    </marker>
    <marker id="arr-threat-dn" markerWidth="8" markerHeight="6" refX="4" refY="6" orient="auto">
      <path d="M0,0 L8,0 L4,6 Z" fill="#a31f34"/>
    </marker>
  </defs>

  <rect width="680" height="460" fill="#fff"/>

  <!-- Stage positions: x centers at 68, 186, 304, 422, 540 (width 96, gap 28) -->

  <!-- Stage 1: Design -->
  <rect x="20" y="140" width="96" height="80" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="68" y="175" font-size="11" font-weight="700" fill="#1e4f7a" text-anchor="middle">Design</text>
  <text x="68" y="191" font-size="8.5" fill="#555" text-anchor="middle">Architecture,</text>
  <text x="68" y="203" font-size="8.5" fill="#555" text-anchor="middle">IP, schematics</text>

  <!-- Arrow 1→2 -->
  <line x1="116" y1="180" x2="138" y2="180" stroke="#4a90c4" stroke-width="1.8" marker-end="url(#arr-fwd)"/>

  <!-- Stage 2: Fabrication -->
  <rect x="138" y="140" width="96" height="80" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="186" y="175" font-size="11" font-weight="700" fill="#1e4f7a" text-anchor="middle">Fabrication</text>
  <text x="186" y="191" font-size="8.5" fill="#555" text-anchor="middle">Wafer production,</text>
  <text x="186" y="203" font-size="8.5" fill="#555" text-anchor="middle">semiconductor fab</text>

  <!-- Arrow 2→3 -->
  <line x1="234" y1="180" x2="256" y2="180" stroke="#4a90c4" stroke-width="1.8" marker-end="url(#arr-fwd)"/>

  <!-- Stage 3: Assembly -->
  <rect x="256" y="140" width="96" height="80" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="304" y="175" font-size="11" font-weight="700" fill="#1e4f7a" text-anchor="middle">Assembly</text>
  <text x="304" y="191" font-size="8.5" fill="#555" text-anchor="middle">PCB, packaging,</text>
  <text x="304" y="203" font-size="8.5" fill="#555" text-anchor="middle">component sourcing</text>

  <!-- Arrow 3→4 -->
  <line x1="352" y1="180" x2="374" y2="180" stroke="#4a90c4" stroke-width="1.8" marker-end="url(#arr-fwd)"/>

  <!-- Stage 4: Distribution -->
  <rect x="374" y="140" width="96" height="80" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="422" y="175" font-size="11" font-weight="700" fill="#1e4f7a" text-anchor="middle">Distribution</text>
  <text x="422" y="191" font-size="8.5" fill="#555" text-anchor="middle">Shipping, resellers,</text>
  <text x="422" y="203" font-size="8.5" fill="#555" text-anchor="middle">logistics chain</text>

  <!-- Arrow 4→5 -->
  <line x1="470" y1="180" x2="492" y2="180" stroke="#4a90c4" stroke-width="1.8" marker-end="url(#arr-fwd)"/>

  <!-- Stage 5: Deployment -->
  <rect x="492" y="140" width="96" height="80" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="540" y="175" font-size="11" font-weight="700" fill="#1e4f7a" text-anchor="middle">Deployment</text>
  <text x="540" y="191" font-size="8.5" fill="#555" text-anchor="middle">Data center rack,</text>
  <text x="540" y="203" font-size="8.5" fill="#555" text-anchor="middle">cloud provisioning</text>

  <!-- Attack vector boxes below each stage -->
  <!-- Design: IP Theft -->
  <line x1="68" y1="220" x2="68" y2="268" stroke="#a31f34" stroke-width="1.3" stroke-dasharray="4,3" marker-end="url(#arr-threat-dn)"/>
  <rect x="20" y="272" width="96" height="50" rx="4" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.3"/>
  <text x="68" y="293" font-size="9.5" font-weight="700" fill="#a31f34" text-anchor="middle">IP Theft</text>
  <text x="68" y="307" font-size="8" fill="#555" text-anchor="middle">Steal design files,</text>
  <text x="68" y="318" font-size="8" fill="#555" text-anchor="middle">reverse-engineer arch.</text>

  <!-- Fabrication: Hardware Trojan -->
  <line x1="186" y1="220" x2="186" y2="268" stroke="#a31f34" stroke-width="1.3" stroke-dasharray="4,3" marker-end="url(#arr-threat-dn)"/>
  <rect x="138" y="272" width="96" height="50" rx="4" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.3"/>
  <text x="186" y="293" font-size="9.5" font-weight="700" fill="#a31f34" text-anchor="middle">Hardware Trojan</text>
  <text x="186" y="307" font-size="8" fill="#555" text-anchor="middle">Malicious circuits</text>
  <text x="186" y="318" font-size="8" fill="#555" text-anchor="middle">inserted at fab time</text>

  <!-- Assembly: Counterfeit Parts -->
  <line x1="304" y1="220" x2="304" y2="268" stroke="#a31f34" stroke-width="1.3" stroke-dasharray="4,3" marker-end="url(#arr-threat-dn)"/>
  <rect x="256" y="272" width="96" height="50" rx="4" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.3"/>
  <text x="304" y="293" font-size="9.5" font-weight="700" fill="#a31f34" text-anchor="middle">Counterfeit Parts</text>
  <text x="304" y="307" font-size="8" fill="#555" text-anchor="middle">Substandard chips,</text>
  <text x="304" y="318" font-size="8" fill="#555" text-anchor="middle">cloned components</text>

  <!-- Distribution: Interdiction -->
  <line x1="422" y1="220" x2="422" y2="268" stroke="#a31f34" stroke-width="1.3" stroke-dasharray="4,3" marker-end="url(#arr-threat-dn)"/>
  <rect x="374" y="272" width="96" height="50" rx="4" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.3"/>
  <text x="422" y="293" font-size="9.5" font-weight="700" fill="#a31f34" text-anchor="middle">Interdiction</text>
  <text x="422" y="307" font-size="8" fill="#555" text-anchor="middle">Tamper hardware</text>
  <text x="422" y="318" font-size="8" fill="#555" text-anchor="middle">in transit (nation-state)</text>

  <!-- Deployment: Firmware Attack -->
  <line x1="540" y1="220" x2="540" y2="268" stroke="#a31f34" stroke-width="1.3" stroke-dasharray="4,3" marker-end="url(#arr-threat-dn)"/>
  <rect x="492" y="272" width="96" height="50" rx="4" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.3"/>
  <text x="540" y="293" font-size="9.5" font-weight="700" fill="#a31f34" text-anchor="middle">Firmware Attack</text>
  <text x="540" y="307" font-size="8" fill="#555" text-anchor="middle">Malicious BIOS/BMC,</text>
  <text x="540" y="318" font-size="8" fill="#555" text-anchor="middle">persistent rootkit</text>

  <!-- Trust level indicators (top) -->
  <text x="68" y="126" font-size="8.5" fill="#3d9e5a" font-weight="600" text-anchor="middle">Trusted</text>
  <text x="186" y="126" font-size="8.5" fill="#c87b2a" font-weight="600" text-anchor="middle">Partially trusted</text>
  <text x="304" y="126" font-size="8.5" fill="#c87b2a" font-weight="600" text-anchor="middle">Low trust</text>
  <text x="422" y="126" font-size="8.5" fill="#a31f34" font-weight="600" text-anchor="middle">Untrusted</text>
  <text x="540" y="126" font-size="8.5" fill="#3d9e5a" font-weight="600" text-anchor="middle">Re-verified</text>
  <text x="68" y="138" font-size="7.5" fill="#999" text-anchor="middle">(design org)</text>
  <text x="186" y="138" font-size="7.5" fill="#999" text-anchor="middle">(3rd-party fab)</text>
  <text x="304" y="138" font-size="7.5" fill="#999" text-anchor="middle">(OEM, subcontract)</text>
  <text x="422" y="138" font-size="7.5" fill="#999" text-anchor="middle">(open logistics)</text>
  <text x="540" y="138" font-size="7.5" fill="#999" text-anchor="middle">(at destination)</text>

  <!-- Legend -->
  <rect x="30" y="354" width="12" height="12" rx="2" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1"/>
  <text x="48" y="365" font-size="9" fill="#555">Supply chain stage</text>
  <rect x="175" y="354" width="12" height="12" rx="2" fill="#f9d6d5" stroke="#a31f34" stroke-width="1"/>
  <text x="193" y="365" font-size="9" fill="#555">Attack vector</text>
  <line x1="280" y1="360" x2="280" y2="372" stroke="#a31f34" stroke-width="1.3" stroke-dasharray="4,3"/>
  <text x="288" y="365" font-size="9" fill="#555">Attack entry</text>

  <!-- Bottom annotation -->
  <text x="340" y="415" font-size="9" fill="#999" text-anchor="middle" font-style="italic">Hardware trust cannot be assumed; verification must occur at each stage boundary, with attestation carried forward to deployment.</text>
</svg>
