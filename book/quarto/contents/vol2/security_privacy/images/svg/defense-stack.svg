<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arr-gray" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#999"/>
    </marker>
  </defs>

  <rect width="680" height="460" fill="#fff"/>

  <!-- Layer 1: Hardware (bottom) -->
  <g transform="translate(60, 340)">
    <rect x="0" y="0" width="490" height="72" rx="5" fill="#e0e0e0" stroke="#999" stroke-width="1.5"/>
    <text x="16" y="22" font-size="11" font-weight="700" fill="#444">Hardware Layer</text>
    <line x1="10" y1="30" x2="480" y2="30" stroke="#999" stroke-width="0.7"/>
    <rect x="12" y="38" width="130" height="24" rx="3" fill="#fafafa" stroke="#bbb" stroke-width="1"/>
    <text x="77" y="55" font-size="9.5" fill="#555" text-anchor="middle">Trusted Execution Env. (TEE)</text>
    <rect x="155" y="38" width="100" height="24" rx="3" fill="#fafafa" stroke="#bbb" stroke-width="1"/>
    <text x="205" y="55" font-size="9.5" fill="#555" text-anchor="middle">Secure Boot</text>
    <rect x="268" y="38" width="110" height="24" rx="3" fill="#fafafa" stroke="#bbb" stroke-width="1"/>
    <text x="323" y="55" font-size="9.5" fill="#555" text-anchor="middle">HSM Key Storage</text>
    <rect x="391" y="38" width="88" height="24" rx="3" fill="#fafafa" stroke="#bbb" stroke-width="1"/>
    <text x="435" y="55" font-size="9.5" fill="#555" text-anchor="middle">PUF / TRNG</text>
  </g>

  <!-- Layer 2: System -->
  <g transform="translate(60, 252)">
    <rect x="0" y="0" width="490" height="72" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
    <text x="16" y="22" font-size="11" font-weight="700" fill="#1e4f7a">System Layer</text>
    <line x1="10" y1="30" x2="480" y2="30" stroke="#4a90c4" stroke-width="0.7"/>
    <rect x="12" y="38" width="130" height="24" rx="3" fill="#fafafa" stroke="#4a90c4" stroke-width="0.9"/>
    <text x="77" y="55" font-size="9.5" fill="#333" text-anchor="middle">OS-Level Isolation</text>
    <rect x="155" y="38" width="130" height="24" rx="3" fill="#fafafa" stroke="#4a90c4" stroke-width="0.9"/>
    <text x="220" y="55" font-size="9.5" fill="#333" text-anchor="middle">Network Segmentation</text>
    <rect x="298" y="38" width="130" height="24" rx="3" fill="#fafafa" stroke="#4a90c4" stroke-width="0.9"/>
    <text x="363" y="55" font-size="9.5" fill="#333" text-anchor="middle">Access Control (RBAC)</text>
    <rect x="440" y="38" width="40" height="24" rx="3" fill="#fafafa" stroke="#4a90c4" stroke-width="0.9"/>
    <text x="460" y="55" font-size="9.5" fill="#333" text-anchor="middle">VPN</text>
  </g>

  <!-- Layer 3: Model -->
  <g transform="translate(60, 164)">
    <rect x="0" y="0" width="490" height="72" rx="5" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5"/>
    <text x="16" y="22" font-size="11" font-weight="700" fill="#7a3e00">Model Layer</text>
    <line x1="10" y1="30" x2="480" y2="30" stroke="#c87b2a" stroke-width="0.7"/>
    <rect x="12" y="38" width="130" height="24" rx="3" fill="#fafafa" stroke="#c87b2a" stroke-width="0.9"/>
    <text x="77" y="55" font-size="9.5" fill="#333" text-anchor="middle">Adversarial Training</text>
    <rect x="155" y="38" width="120" height="24" rx="3" fill="#fafafa" stroke="#c87b2a" stroke-width="0.9"/>
    <text x="215" y="55" font-size="9.5" fill="#333" text-anchor="middle">Input Validation</text>
    <rect x="288" y="38" width="120" height="24" rx="3" fill="#fafafa" stroke="#c87b2a" stroke-width="0.9"/>
    <text x="348" y="55" font-size="9.5" fill="#333" text-anchor="middle">Model Watermarking</text>
    <rect x="421" y="38" width="58" height="24" rx="3" fill="#fafafa" stroke="#c87b2a" stroke-width="0.9"/>
    <text x="450" y="55" font-size="9.5" fill="#333" text-anchor="middle">Rate Limits</text>
  </g>

  <!-- Layer 4: Data (top) -->
  <g transform="translate(60, 76)">
    <rect x="0" y="0" width="490" height="72" rx="5" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.5"/>
    <text x="16" y="22" font-size="11" font-weight="700" fill="#1a5c30">Data Layer</text>
    <line x1="10" y1="30" x2="480" y2="30" stroke="#3d9e5a" stroke-width="0.7"/>
    <rect x="12" y="38" width="120" height="24" rx="3" fill="#fafafa" stroke="#3d9e5a" stroke-width="0.9"/>
    <text x="72" y="55" font-size="9.5" fill="#333" text-anchor="middle">Encryption at Rest</text>
    <rect x="145" y="38" width="130" height="24" rx="3" fill="#fafafa" stroke="#3d9e5a" stroke-width="0.9"/>
    <text x="210" y="55" font-size="9.5" fill="#333" text-anchor="middle">Differential Privacy</text>
    <rect x="288" y="38" width="120" height="24" rx="3" fill="#fafafa" stroke="#3d9e5a" stroke-width="0.9"/>
    <text x="348" y="55" font-size="9.5" fill="#333" text-anchor="middle">Provenance Tracking</text>
    <rect x="421" y="38" width="58" height="24" rx="3" fill="#fafafa" stroke="#3d9e5a" stroke-width="0.9"/>
    <text x="450" y="55" font-size="9.5" fill="#333" text-anchor="middle">Audit Logs</text>
  </g>

  <!-- Side bracket: Defense in Depth -->
  <line x1="572" y1="76" x2="572" y2="412" stroke="#555" stroke-width="2"/>
  <line x1="572" y1="76" x2="582" y2="76" stroke="#555" stroke-width="2"/>
  <line x1="572" y1="412" x2="582" y2="412" stroke="#555" stroke-width="2"/>
  <text x="596" y="178" font-size="10" font-weight="700" fill="#333" text-anchor="middle" transform="rotate(90,596,244)">Defense in Depth</text>

  <!-- Layer labels on right -->
  <text x="560" y="116" font-size="8.5" fill="#1a5c30" text-anchor="end" font-style="italic">Data</text>
  <text x="560" y="204" font-size="8.5" fill="#7a3e00" text-anchor="end" font-style="italic">Model</text>
  <text x="560" y="292" font-size="8.5" fill="#1e4f7a" text-anchor="end" font-style="italic">System</text>
  <text x="560" y="380" font-size="8.5" fill="#444" text-anchor="end" font-style="italic">Hardware</text>

  <!-- Upward arrows between layers -->
  <line x1="305" y1="336" x2="305" y2="328" stroke="#999" stroke-width="1.2" marker-end="url(#arr-gray)"/>
  <line x1="305" y1="248" x2="305" y2="240" stroke="#999" stroke-width="1.2" marker-end="url(#arr-gray)"/>
  <line x1="305" y1="160" x2="305" y2="152" stroke="#999" stroke-width="1.2" marker-end="url(#arr-gray)"/>

  <!-- Bottom annotation -->
  <text x="340" y="453" font-size="9" fill="#999" text-anchor="middle" font-style="italic">Each layer provides independent protection; an attacker who penetrates one layer still faces all layers above.</text>
</svg>
