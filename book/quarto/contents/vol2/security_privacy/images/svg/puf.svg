<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arr-puf" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#4a90c4"/>
    </marker>
    <marker id="arr-arb" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#3d9e5a"/>
    </marker>
  </defs>

  <rect width="680" height="460" fill="#fff"/>

  <!-- ===== LEFT PANEL: Optical PUF ===== -->
  <rect x="20" y="30" width="300" height="390" rx="6" fill="#fafafa" stroke="#bbb" stroke-width="1.2"/>
  <text x="170" y="55" font-size="12" font-weight="700" fill="#333" text-anchor="middle">Optical PUF</text>
  <line x1="30" y1="62" x2="310" y2="62" stroke="#ddd" stroke-width="1"/>

  <!-- Silicon chip surface -->
  <rect x="90" y="100" width="160" height="80" rx="4" fill="#e0e0e0" stroke="#999" stroke-width="1.5"/>
  <text x="170" y="135" font-size="9.5" font-weight="600" fill="#666" text-anchor="middle">Silicon Surface</text>
  <text x="170" y="150" font-size="8.5" fill="#888" text-anchor="middle">(sub-wavelength roughness)</text>
  <!-- Random texture dots on surface -->
  <circle cx="110" cy="125" r="2.5" fill="#aaa" opacity="0.7"/>
  <circle cx="125" cy="118" r="1.5" fill="#999" opacity="0.8"/>
  <circle cx="138" cy="130" r="2" fill="#bbb" opacity="0.6"/>
  <circle cx="152" cy="115" r="3" fill="#999" opacity="0.7"/>
  <circle cx="167" cy="128" r="1.8" fill="#aaa" opacity="0.9"/>
  <circle cx="180" cy="118" r="2.2" fill="#bbb" opacity="0.7"/>
  <circle cx="194" cy="132" r="1.5" fill="#999" opacity="0.8"/>
  <circle cx="206" cy="122" r="2.8" fill="#aaa" opacity="0.6"/>
  <circle cx="218" cy="130" r="1.5" fill="#bbb" opacity="0.8"/>
  <circle cx="228" cy="116" r="2" fill="#aaa" opacity="0.7"/>
  <circle cx="118" cy="142" r="2" fill="#bbb" opacity="0.6"/>
  <circle cx="145" cy="155" r="1.5" fill="#aaa" opacity="0.7"/>
  <circle cx="195" cy="152" r="2.5" fill="#999" opacity="0.7"/>
  <circle cx="220" cy="145" r="1.8" fill="#bbb" opacity="0.8"/>

  <!-- Laser beam (red diagonal) hitting chip -->
  <line x1="55" y1="75" x2="120" y2="120" stroke="#a31f34" stroke-width="2.5" opacity="0.85"/>
  <polygon points="55,75 68,86 60,92" fill="#a31f34" opacity="0.85"/>
  <!-- Laser label -->
  <text x="52" y="72" font-size="8.5" fill="#a31f34" font-weight="700">Laser</text>
  <text x="52" y="83" font-size="8.5" fill="#a31f34" font-weight="700">beam</text>

  <!-- Arrow: chip â†’ speckle output -->
  <line x1="170" y1="182" x2="170" y2="220" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-puf)"/>
  <text x="185" y="205" font-size="8.5" fill="#4a90c4">scatter</text>

  <!-- Speckle pattern output: random dot pattern -->
  <rect x="90" y="222" width="160" height="80" rx="4" fill="#fff" stroke="#4a90c4" stroke-width="1.3"/>
  <text x="170" y="238" font-size="8.5" font-weight="600" fill="#1e4f7a" text-anchor="middle">Speckle Pattern Output</text>
  <!-- Random speckle dots -->
  <circle cx="108" cy="255" r="3" fill="#333" opacity="0.8"/>
  <circle cx="118" cy="270" r="2" fill="#333" opacity="0.6"/>
  <circle cx="130" cy="248" r="1.5" fill="#333" opacity="0.9"/>
  <circle cx="143" cy="263" r="2.5" fill="#333" opacity="0.7"/>
  <circle cx="155" cy="252" r="3.5" fill="#333" opacity="0.5"/>
  <circle cx="167" cy="273" r="2" fill="#333" opacity="0.8"/>
  <circle cx="178" cy="258" r="1.5" fill="#333" opacity="0.9"/>
  <circle cx="190" cy="268" r="3" fill="#333" opacity="0.6"/>
  <circle cx="200" cy="250" r="2" fill="#333" opacity="0.7"/>
  <circle cx="212" cy="264" r="1.5" fill="#333" opacity="0.8"/>
  <circle cx="222" cy="255" r="3" fill="#333" opacity="0.5"/>
  <circle cx="115" cy="280" r="2" fill="#333" opacity="0.7"/>
  <circle cx="148" cy="285" r="1.5" fill="#333" opacity="0.8"/>
  <circle cx="173" cy="289" r="2.5" fill="#333" opacity="0.6"/>
  <circle cx="196" cy="282" r="2" fill="#333" opacity="0.7"/>
  <circle cx="220" cy="278" r="1.5" fill="#333" opacity="0.9"/>

  <!-- Arrow to fingerprint -->
  <line x1="170" y1="304" x2="170" y2="334" stroke="#3d9e5a" stroke-width="1.5" marker-end="url(#arr-arb)"/>

  <!-- Unique fingerprint label -->
  <rect x="90" y="336" width="160" height="40" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="170" y="355" font-size="9.5" font-weight="700" fill="#1a5c30" text-anchor="middle">Unique Optical Fingerprint</text>
  <text x="170" y="369" font-size="8.5" fill="#555" text-anchor="middle">Chip-specific, unclonable</text>

  <!-- ===== RIGHT PANEL: Arbiter PUF ===== -->
  <rect x="360" y="30" width="300" height="390" rx="6" fill="#fafafa" stroke="#bbb" stroke-width="1.2"/>
  <text x="510" y="55" font-size="12" font-weight="700" fill="#333" text-anchor="middle">Arbiter PUF</text>
  <line x1="370" y1="62" x2="650" y2="62" stroke="#ddd" stroke-width="1"/>

  <!-- Challenge input -->
  <rect x="460" y="76" width="100" height="28" rx="3" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="510" y="93" font-size="9.5" font-weight="700" fill="#1e4f7a" text-anchor="middle">Challenge (n bits)</text>

  <!-- Upper delay path -->
  <text x="390" y="130" font-size="8.5" fill="#666">Upper path</text>
  <line x1="385" y1="140" x2="638" y2="140" stroke="#4a90c4" stroke-width="2"/>

  <!-- Lower delay path -->
  <text x="390" y="200" font-size="8.5" fill="#666">Lower path</text>
  <line x1="385" y1="210" x2="638" y2="210" stroke="#3d9e5a" stroke-width="2"/>

  <!-- Challenge arrow down to paths -->
  <line x1="510" y1="104" x2="510" y2="132" stroke="#999" stroke-width="1.2"/>
  <line x1="510" y1="132" x2="420" y2="132" stroke="#999" stroke-width="1.2" marker-end="url(#arr-puf)"/>
  <line x1="510" y1="132" x2="600" y2="132" stroke="#999" stroke-width="1.2"/>
  <line x1="510" y1="132" x2="510" y2="202" stroke="#999" stroke-width="1.2"/>
  <line x1="510" y1="202" x2="420" y2="202" stroke="#999" stroke-width="1.2"/>

  <!-- MUX gates on upper path -->
  <!-- MUX 1 upper -->
  <polygon points="405,130 425,122 425,150 405,142" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="415" y="140" font-size="7" fill="#1e4f7a" text-anchor="middle">MUX</text>

  <!-- MUX 2 upper -->
  <polygon points="470,130 490,122 490,150 470,142" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="480" y="140" font-size="7" fill="#1e4f7a" text-anchor="middle">MUX</text>

  <!-- MUX 3 upper -->
  <polygon points="535,130 555,122 555,150 535,142" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="545" y="140" font-size="7" fill="#1e4f7a" text-anchor="middle">MUX</text>

  <!-- MUX 1 lower -->
  <polygon points="405,200 425,192 425,220 405,212" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="415" y="210" font-size="7" fill="#1a5c30" text-anchor="middle">MUX</text>

  <!-- MUX 2 lower -->
  <polygon points="470,200 490,192 490,220 470,212" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="480" y="210" font-size="7" fill="#1a5c30" text-anchor="middle">MUX</text>

  <!-- MUX 3 lower -->
  <polygon points="535,200 555,192 555,220 535,212" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="545" y="210" font-size="7" fill="#1a5c30" text-anchor="middle">MUX</text>

  <!-- Arbiter / latch -->
  <rect x="600" y="116" width="48" height="94" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5"/>
  <text x="624" y="152" font-size="8.5" font-weight="700" fill="#7a3e00" text-anchor="middle">Arbiter</text>
  <text x="624" y="164" font-size="8" fill="#7a3e00" text-anchor="middle">/ Latch</text>
  <text x="624" y="178" font-size="7.5" fill="#888" text-anchor="middle">which path</text>
  <text x="624" y="189" font-size="7.5" fill="#888" text-anchor="middle">was faster?</text>

  <!-- 0 or 1 output (shifted left to stay within viewBox; right edge at x=666) -->
  <rect x="610" y="246" width="56" height="34" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5"/>
  <text x="638" y="263" font-size="14" font-weight="700" fill="#c87b2a" text-anchor="middle">0 / 1</text>
  <text x="638" y="275" font-size="7.5" fill="#888" text-anchor="middle">response bit</text>
  <!-- Connect arbiter right edge down and left to output box -->
  <line x1="648" y1="163" x2="638" y2="163" stroke="#c87b2a" stroke-width="1.5"/>
  <line x1="638" y1="163" x2="638" y2="244" stroke="#c87b2a" stroke-width="1.5" marker-end="url(#arr-puf)"/>

  <!-- Delay variation annotation -->
  <rect x="368" y="155" width="198" height="40" rx="3" fill="#fafafa" stroke="#bbb" stroke-width="1"/>
  <text x="467" y="173" font-size="8.5" fill="#555" text-anchor="middle">Manufacturing variations create</text>
  <text x="467" y="186" font-size="8.5" fill="#555" text-anchor="middle">unique per-chip delay differences (&#x03C3; &#x2248; ps)</text>

  <!-- Unique fingerprint label (right) -->
  <rect x="390" y="316" width="240" height="40" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="510" y="335" font-size="9.5" font-weight="700" fill="#1a5c30" text-anchor="middle">Manufacturing Variations</text>
  <text x="510" y="349" font-size="8.5" fill="#555" text-anchor="middle">&#x2192; Unique, unclonable fingerprint</text>

  <!-- Shared bottom note spanning both panels -->
  <rect x="20" y="432" width="640" height="22" rx="3" fill="#fafafa" stroke="#ddd" stroke-width="1"/>
  <text x="340" y="447" font-size="9" fill="#999" text-anchor="middle" font-style="italic">PUFs exploit uncontrollable manufacturing process variations to produce device-unique identifiers without stored secrets.</text>
</svg>
