<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arr-chain" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#a31f34"/>
    </marker>
  </defs>

  <rect width="680" height="460" fill="#fff"/>

  <!-- Node dimensions: width=88, height=64, gap=18 -->
  <!-- Centers at x: 54, 160, 266, 372, 478, 584 -->
  <!-- Node y: 148 top, so cy = 180 -->

  <!-- Node 1: USB Drive -->
  <rect x="10" y="148" width="88" height="64" rx="5" fill="#f9d6d5" stroke="#a31f34" stroke-width="2"/>
  <!-- USB icon: rectangle + lines -->
  <rect x="36" y="158" width="36" height="22" rx="2" fill="#a31f34" opacity="0.25"/>
  <line x1="48" y1="168" x2="48" y2="174" stroke="#a31f34" stroke-width="1.5"/>
  <line x1="54" y1="163" x2="54" y2="174" stroke="#a31f34" stroke-width="1.5"/>
  <line x1="60" y1="168" x2="60" y2="174" stroke="#a31f34" stroke-width="1.5"/>
  <text x="54" y="199" font-size="9" font-weight="700" fill="#a31f34" text-anchor="middle">USB Drive</text>
  <text x="54" y="210" font-size="8" fill="#555" text-anchor="middle">(infected)</text>

  <!-- Arrow 1→2 -->
  <line x1="98" y1="180" x2="116" y2="180" stroke="#a31f34" stroke-width="1.8" marker-end="url(#arr-chain)"/>
  <!-- Exploit label below arrow -->
  <rect x="98" y="190" width="18" height="1" fill="none"/>
  <text x="107" y="203" font-size="7.5" fill="#c87b2a" text-anchor="middle" font-style="italic">AutoRun</text>
  <text x="107" y="213" font-size="7.5" fill="#c87b2a" text-anchor="middle" font-style="italic">exploit</text>

  <!-- Node 2: Windows PC -->
  <rect x="116" y="148" width="88" height="64" rx="5" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.5"/>
  <!-- Monitor icon -->
  <rect x="134" y="157" width="52" height="36" rx="2" fill="#fff" stroke="#a31f34" stroke-width="1.2"/>
  <rect x="152" y="193" width="16" height="4" rx="1" fill="#a31f34" opacity="0.4"/>
  <text x="160" y="170" font-size="7" fill="#a31f34" text-anchor="middle">WIN</text>
  <text x="160" y="199" font-size="9" font-weight="700" fill="#a31f34" text-anchor="middle">Windows PC</text>
  <text x="160" y="210" font-size="8" fill="#555" text-anchor="middle">(engineer wkstn)</text>

  <!-- Arrow 2→3 -->
  <line x1="204" y1="180" x2="222" y2="180" stroke="#a31f34" stroke-width="1.8" marker-end="url(#arr-chain)"/>
  <text x="213" y="203" font-size="7.5" fill="#c87b2a" text-anchor="middle" font-style="italic">SCADA sw</text>
  <text x="213" y="213" font-size="7.5" fill="#c87b2a" text-anchor="middle" font-style="italic">injection</text>

  <!-- Node 3: Siemens Step7 -->
  <rect x="222" y="148" width="88" height="64" rx="5" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.5"/>
  <text x="266" y="171" font-size="9" font-weight="700" fill="#a31f34" text-anchor="middle">Siemens</text>
  <text x="266" y="183" font-size="9" font-weight="700" fill="#a31f34" text-anchor="middle">Step7 SCADA</text>
  <text x="266" y="199" font-size="8" fill="#555" text-anchor="middle">PLC programming</text>
  <text x="266" y="210" font-size="8" fill="#555" text-anchor="middle">environment</text>

  <!-- Arrow 3→4 -->
  <line x1="310" y1="180" x2="328" y2="180" stroke="#a31f34" stroke-width="1.8" marker-end="url(#arr-chain)"/>
  <text x="319" y="203" font-size="7.5" fill="#c87b2a" text-anchor="middle" font-style="italic">PLC firmware</text>
  <text x="319" y="213" font-size="7.5" fill="#c87b2a" text-anchor="middle" font-style="italic">rootkit</text>

  <!-- Node 4: Siemens PLC -->
  <rect x="328" y="148" width="88" height="64" rx="5" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.5"/>
  <text x="372" y="171" font-size="9" font-weight="700" fill="#a31f34" text-anchor="middle">Siemens</text>
  <text x="372" y="183" font-size="9" font-weight="700" fill="#a31f34" text-anchor="middle">S7-315 PLC</text>
  <text x="372" y="199" font-size="8" fill="#555" text-anchor="middle">Programmable</text>
  <text x="372" y="210" font-size="8" fill="#555" text-anchor="middle">logic controller</text>

  <!-- Arrow 4→5 -->
  <line x1="416" y1="180" x2="434" y2="180" stroke="#a31f34" stroke-width="1.8" marker-end="url(#arr-chain)"/>
  <text x="425" y="203" font-size="7.5" fill="#c87b2a" text-anchor="middle" font-style="italic">Frequency</text>
  <text x="425" y="213" font-size="7.5" fill="#c87b2a" text-anchor="middle" font-style="italic">manipulation</text>

  <!-- Node 5: Centrifuge Motor -->
  <rect x="434" y="148" width="88" height="64" rx="5" fill="#f9d6d5" stroke="#a31f34" stroke-width="1.5"/>
  <text x="478" y="171" font-size="9" font-weight="700" fill="#a31f34" text-anchor="middle">Centrifuge</text>
  <text x="478" y="183" font-size="9" font-weight="700" fill="#a31f34" text-anchor="middle">Motor Control</text>
  <text x="478" y="199" font-size="8" fill="#555" text-anchor="middle">IR-1 uranium</text>
  <text x="478" y="210" font-size="8" fill="#555" text-anchor="middle">enrichment</text>

  <!-- Arrow 5→6 -->
  <line x1="522" y1="180" x2="540" y2="180" stroke="#a31f34" stroke-width="1.8" marker-end="url(#arr-chain)"/>
  <text x="531" y="203" font-size="7.5" fill="#c87b2a" text-anchor="middle" font-style="italic">Mechanical</text>
  <text x="531" y="213" font-size="7.5" fill="#c87b2a" text-anchor="middle" font-style="italic">failure</text>

  <!-- Node 6: Physical Damage -->
  <rect x="540" y="140" width="96" height="80" rx="5" fill="#a31f34" stroke="#7a0e1a" stroke-width="2"/>
  <!-- Explosion star polygon (simplified as circle + rays) -->
  <circle cx="588" cy="170" r="14" fill="#fdebd0" stroke="#fff" stroke-width="1"/>
  <line x1="588" y1="152" x2="588" y2="146" stroke="#fdebd0" stroke-width="2"/>
  <line x1="600" y1="158" x2="605" y2="154" stroke="#fdebd0" stroke-width="2"/>
  <line x1="606" y1="170" x2="612" y2="170" stroke="#fdebd0" stroke-width="2"/>
  <line x1="600" y1="182" x2="605" y2="186" stroke="#fdebd0" stroke-width="2"/>
  <line x1="576" y1="182" x2="571" y2="186" stroke="#fdebd0" stroke-width="2"/>
  <line x1="570" y1="170" x2="564" y2="170" stroke="#fdebd0" stroke-width="2"/>
  <line x1="576" y1="158" x2="571" y2="154" stroke="#fdebd0" stroke-width="2"/>
  <text x="588" y="175" font-size="9" font-weight="700" fill="#a31f34" text-anchor="middle">!</text>
  <text x="588" y="197" font-size="9" font-weight="700" fill="#fff" text-anchor="middle">Physical</text>
  <text x="588" y="209" font-size="9" font-weight="700" fill="#fff" text-anchor="middle">Damage</text>

  <!-- Sensor spoofing annotation (top) -->
  <rect x="300" y="68" width="200" height="48" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.2"/>
  <text x="400" y="89" font-size="9" font-weight="700" fill="#c87b2a" text-anchor="middle">Key evasion: sensor spoofing</text>
  <text x="400" y="103" font-size="8.5" fill="#555" text-anchor="middle">Stuxnet reported normal RPMs to operators</text>
  <text x="400" y="114" font-size="8.5" fill="#555" text-anchor="middle">while sabotaging centrifuges covertly</text>
  <!-- Arrow from label to PLC -->
  <line x1="372" y1="116" x2="372" y2="147" stroke="#c87b2a" stroke-width="1" stroke-dasharray="3,3"/>

  <!-- Timeline label -->
  <text x="340" y="260" font-size="10" font-weight="700" fill="#555" text-anchor="middle">2010 discovery — est. 1,000 centrifuges destroyed at Natanz, Iran</text>

  <!-- Zero-day count -->
  <rect x="230" y="280" width="220" height="30" rx="4" fill="#e0e0e0" stroke="#999" stroke-width="1"/>
  <text x="340" y="300" font-size="9.5" fill="#444" text-anchor="middle">Exploited 4 Windows zero-day vulnerabilities simultaneously</text>

  <!-- Lesson box -->
  <rect x="30" y="328" width="620" height="56" rx="4" fill="#fafafa" stroke="#bbb" stroke-width="1"/>
  <text x="340" y="348" font-size="9.5" font-weight="700" fill="#333" text-anchor="middle">Systems Lesson</text>
  <text x="340" y="364" font-size="9" fill="#555" text-anchor="middle">Air-gap isolation is not sufficient when removable media bridges the gap. Firmware on safety-critical hardware</text>
  <text x="340" y="377" font-size="9" fill="#555" text-anchor="middle">must be cryptographically signed and verified — the same principle underlying secure boot in ML accelerators.</text>

  <!-- Bottom annotation -->
  <text x="340" y="453" font-size="9" fill="#999" text-anchor="middle" font-style="italic">Attack chain progresses from a physical vector (USB) through software layers to achieve irreversible physical destruction.</text>
</svg>
