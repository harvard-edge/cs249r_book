<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arr" markerWidth="9" markerHeight="7" refX="8" refY="3.5" orient="auto">
      <path d="M0,0 L9,3.5 L0,7 Z" fill="#333"/>
    </marker>
    <marker id="arr-blue" markerWidth="9" markerHeight="7" refX="8" refY="3.5" orient="auto">
      <path d="M0,0 L9,3.5 L0,7 Z" fill="#4a90c4"/>
    </marker>
    <marker id="arr-green" markerWidth="9" markerHeight="7" refX="8" refY="3.5" orient="auto">
      <path d="M0,0 L9,3.5 L0,7 Z" fill="#3d9e5a"/>
    </marker>
    <marker id="arr-orange" markerWidth="9" markerHeight="7" refX="8" refY="3.5" orient="auto">
      <path d="M0,0 L9,3.5 L0,7 Z" fill="#c87b2a"/>
    </marker>
  </defs>

  <rect width="680" height="460" fill="#fff"/>

  <!-- Stage 1: Cloud Pre-training -->
  <rect x="14" y="18" width="218" height="390" rx="6" fill="#fafafa" stroke="#4a90c4" stroke-width="1.5"/>
  <rect x="14" y="18" width="218" height="30" rx="6" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <rect x="14" y="34" width="218" height="14" fill="#cfe2f3"/>
  <text x="123" y="37" font-size="11" font-weight="700" fill="#1a5a8a" text-anchor="middle">Stage 1: Cloud Pre-training</text>

  <!-- Large dataset icon -->
  <rect x="30" y="62" width="186" height="38" rx="4" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1"/>
  <text x="123" y="79" font-size="9" font-weight="600" fill="#1a5a8a" text-anchor="middle">Massive Dataset</text>
  <text x="123" y="93" font-size="8.5" fill="#4a90c4" text-anchor="middle">billions of samples, diverse domains</text>

  <!-- Arrow down to network -->
  <line x1="123" y1="100" x2="123" y2="116" stroke="#4a90c4" stroke-width="1.2" marker-end="url(#arr-blue)"/>

  <!-- Neural network: all layers colored (fully trainable) -->
  <rect x="36" y="118" width="174" height="22" rx="3" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="123" y="133" font-size="8.5" fill="#1a5a8a" text-anchor="middle">Embedding Layer</text>

  <rect x="36" y="148" width="174" height="22" rx="3" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="123" y="163" font-size="8.5" fill="#1a5a8a" text-anchor="middle">Transformer Block 1</text>

  <rect x="36" y="178" width="174" height="22" rx="3" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="123" y="193" font-size="8.5" fill="#1a5a8a" text-anchor="middle">Transformer Block 2</text>

  <rect x="36" y="208" width="174" height="22" rx="3" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="123" y="223" font-size="8.5" fill="#1a5a8a" text-anchor="middle">Transformer Block 3</text>

  <rect x="36" y="238" width="174" height="22" rx="3" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="123" y="253" font-size="8.5" fill="#1a5a8a" text-anchor="middle">Transformer Block 4</text>

  <rect x="36" y="268" width="174" height="22" rx="3" fill="#4a90c4" stroke="#1a5a8a" stroke-width="1.5"/>
  <text x="123" y="283" font-size="8.5" fill="#fff" text-anchor="middle" font-weight="600">Output Head</text>

  <!-- Connecting lines -->
  <line x1="123" y1="140" x2="123" y2="148" stroke="#4a90c4" stroke-width="0.8" stroke-dasharray="2,2"/>
  <line x1="123" y1="170" x2="123" y2="178" stroke="#4a90c4" stroke-width="0.8" stroke-dasharray="2,2"/>
  <line x1="123" y1="200" x2="123" y2="208" stroke="#4a90c4" stroke-width="0.8" stroke-dasharray="2,2"/>
  <line x1="123" y1="230" x2="123" y2="238" stroke="#4a90c4" stroke-width="0.8" stroke-dasharray="2,2"/>
  <line x1="123" y1="260" x2="123" y2="268" stroke="#4a90c4" stroke-width="0.8" stroke-dasharray="2,2"/>

  <!-- Output: pre-trained weights -->
  <rect x="30" y="304" width="186" height="36" rx="4" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1"/>
  <text x="123" y="320" font-size="9" font-weight="600" fill="#1a5a8a" text-anchor="middle">Pre-trained Weights w*</text>
  <text x="123" y="333" font-size="8" fill="#4a90c4" text-anchor="middle">rich feature representations</text>

  <!-- Hardware label -->
  <rect x="30" y="354" width="186" height="40" rx="4" fill="#fafafa" stroke="#bbb" stroke-width="0.8"/>
  <text x="123" y="370" font-size="8.5" fill="#555" text-anchor="middle" font-weight="600">Cloud Infrastructure</text>
  <text x="123" y="384" font-size="8" fill="#777" text-anchor="middle">H100 cluster, petabyte storage</text>
  <text x="123" y="396" font-size="8" fill="#777" text-anchor="middle">weeks of training time</text>

  <!-- Stage 2: Device Constraints (center) -->
  <rect x="250" y="18" width="180" height="390" rx="6" fill="#fafafa" stroke="#e0e0e0" stroke-width="1.2"/>
  <rect x="250" y="18" width="180" height="30" rx="6" fill="#e0e0e0" stroke="#999" stroke-width="1.2"/>
  <rect x="250" y="34" width="180" height="14" fill="#e0e0e0"/>
  <text x="340" y="37" font-size="11" font-weight="700" fill="#444" text-anchor="middle">Device Constraints</text>

  <!-- Device icon -->
  <rect x="295" y="60" width="90" height="130" rx="8" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5"/>
  <rect x="306" y="70" width="68" height="98" rx="3" fill="#fff" stroke="#c87b2a" stroke-width="0.8"/>
  <circle cx="340" cy="180" r="5" fill="#c87b2a"/>
  <rect x="318" y="64" width="44" height="3" rx="1.5" fill="#c87b2a"/>

  <!-- Screen content: constraint icons -->
  <text x="340" y="88" font-size="8" fill="#c87b2a" text-anchor="middle" font-weight="600">Memory Wall</text>
  <rect x="312" y="92" width="56" height="6" rx="1" fill="#f9d6d5" stroke="#c44" stroke-width="0.5"/>
  <rect x="312" y="92" width="20" height="6" rx="1" fill="#c87b2a"/>

  <text x="340" y="114" font-size="8" fill="#c87b2a" text-anchor="middle" font-weight="600">Power Wall</text>
  <rect x="312" y="118" width="56" height="6" rx="1" fill="#f9d6d5" stroke="#c44" stroke-width="0.5"/>
  <rect x="312" y="118" width="14" height="6" rx="1" fill="#c87b2a"/>

  <text x="340" y="140" font-size="8" fill="#c87b2a" text-anchor="middle" font-weight="600">Data Wall</text>
  <rect x="312" y="144" width="56" height="6" rx="1" fill="#f9d6d5" stroke="#c44" stroke-width="0.5"/>
  <rect x="312" y="144" width="30" height="6" rx="1" fill="#c87b2a"/>

  <!-- Constraint specs -->
  <rect x="266" y="208" width="148" height="82" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1"/>
  <text x="340" y="225" font-size="9" font-weight="700" fill="#7a4a10" text-anchor="middle">Constraint Envelope</text>
  <text x="272" y="242" font-size="8.5" fill="#555">Memory:</text>
  <text x="408" y="242" font-size="8.5" fill="#c44" text-anchor="end">256 KB–8 MB</text>
  <text x="272" y="257" font-size="8.5" fill="#555">Compute:</text>
  <text x="408" y="257" font-size="8.5" fill="#c44" text-anchor="end">100 MOPS–16 TOPS</text>
  <text x="272" y="272" font-size="8.5" fill="#555">Data:</text>
  <text x="408" y="272" font-size="8.5" fill="#c44" text-anchor="end">local only, small</text>
  <text x="272" y="287" font-size="8.5" fill="#555">Power:</text>
  <text x="408" y="287" font-size="8.5" fill="#c44" text-anchor="end">mW–W budget</text>

  <!-- Solution annotation -->
  <rect x="266" y="306" width="148" height="58" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1"/>
  <text x="340" y="323" font-size="9" font-weight="700" fill="#1a6a3a" text-anchor="middle">Required Strategies</text>
  <text x="340" y="338" font-size="8" fill="#3d9e5a" text-anchor="middle">• Weight importance scoring</text>
  <text x="340" y="352" font-size="8" fill="#3d9e5a" text-anchor="middle">• Top-K layer selection</text>
  <text x="340" y="366" font-size="8" fill="#3d9e5a" text-anchor="middle">• Bias-only or adapter update</text>

  <!-- Stage 3: On-Device Adaptation -->
  <rect x="448" y="18" width="218" height="390" rx="6" fill="#fafafa" stroke="#3d9e5a" stroke-width="1.5"/>
  <rect x="448" y="18" width="218" height="30" rx="6" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.5"/>
  <rect x="448" y="34" width="218" height="14" fill="#d4edda"/>
  <text x="557" y="37" font-size="11" font-weight="700" fill="#1a6a3a" text-anchor="middle">Stage 3: On-Device Adaptation</text>

  <!-- Local data icon -->
  <rect x="464" y="62" width="186" height="38" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1"/>
  <text x="557" y="79" font-size="9" font-weight="600" fill="#1a6a3a" text-anchor="middle">Local Data</text>
  <text x="557" y="93" font-size="8.5" fill="#3d9e5a" text-anchor="middle">device-specific, private, small</text>

  <!-- Arrow down to network -->
  <line x1="557" y1="100" x2="557" y2="116" stroke="#3d9e5a" stroke-width="1.2" marker-end="url(#arr-green)"/>

  <!-- Network with importance scores overlay -->
  <rect x="470" y="118" width="174" height="22" rx="3" fill="#e0e0e0" stroke="#999" stroke-width="1.2"/>
  <text x="557" y="133" font-size="8.5" fill="#777" text-anchor="middle">Embedding Layer</text>
  <!-- Importance bar: low -->
  <rect x="634" y="120" width="8" height="18" rx="1" fill="#e0e0e0" stroke="#bbb" stroke-width="0.5"/>
  <rect x="634" y="132" width="8" height="6" rx="1" fill="#3d9e5a"/>

  <rect x="470" y="148" width="174" height="22" rx="3" fill="#e0e0e0" stroke="#999" stroke-width="1.2"/>
  <text x="557" y="163" font-size="8.5" fill="#777" text-anchor="middle">Transformer Block 1</text>
  <rect x="634" y="150" width="8" height="18" rx="1" fill="#e0e0e0" stroke="#bbb" stroke-width="0.5"/>
  <rect x="634" y="158" width="8" height="10" rx="1" fill="#3d9e5a"/>

  <!-- Top-K highlighted (trainable) -->
  <rect x="470" y="178" width="174" height="22" rx="3" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.8"/>
  <text x="557" y="193" font-size="8.5" fill="#1a6a3a" text-anchor="middle" font-weight="600">Block 2 ← update</text>
  <rect x="634" y="180" width="8" height="18" rx="1" fill="#e0e0e0" stroke="#bbb" stroke-width="0.5"/>
  <rect x="634" y="180" width="8" height="18" rx="1" fill="#3d9e5a"/>

  <rect x="470" y="208" width="174" height="22" rx="3" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.8"/>
  <text x="557" y="223" font-size="8.5" fill="#1a6a3a" text-anchor="middle" font-weight="600">Block 3 ← update</text>
  <rect x="634" y="210" width="8" height="18" rx="1" fill="#e0e0e0" stroke="#bbb" stroke-width="0.5"/>
  <rect x="634" y="210" width="8" height="18" rx="1" fill="#3d9e5a"/>

  <rect x="470" y="238" width="174" height="22" rx="3" fill="#e0e0e0" stroke="#999" stroke-width="1.2"/>
  <text x="557" y="253" font-size="8.5" fill="#777" text-anchor="middle">Transformer Block 4</text>
  <rect x="634" y="240" width="8" height="18" rx="1" fill="#e0e0e0" stroke="#bbb" stroke-width="0.5"/>
  <rect x="634" y="248" width="8" height="10" rx="1" fill="#3d9e5a"/>

  <rect x="470" y="268" width="174" height="22" rx="3" fill="#3d9e5a" stroke="#1a6a3a" stroke-width="1.5"/>
  <text x="557" y="283" font-size="8.5" fill="#fff" text-anchor="middle" font-weight="600">Head ← update</text>
  <rect x="634" y="270" width="8" height="18" rx="1" fill="#3d9e5a"/>

  <!-- Connecting lines -->
  <line x1="557" y1="140" x2="557" y2="148" stroke="#999" stroke-width="0.8" stroke-dasharray="2,2"/>
  <line x1="557" y1="170" x2="557" y2="178" stroke="#999" stroke-width="0.8" stroke-dasharray="2,2"/>
  <line x1="557" y1="200" x2="557" y2="208" stroke="#3d9e5a" stroke-width="0.8"/>
  <line x1="557" y1="230" x2="557" y2="238" stroke="#3d9e5a" stroke-width="0.8"/>
  <line x1="557" y1="260" x2="557" y2="268" stroke="#3d9e5a" stroke-width="0.8"/>

  <!-- Importance score legend -->
  <text x="648" y="128" font-size="7" fill="#999" text-anchor="start" transform="rotate(90,648,128)">importance</text>
  <text x="648" y="208" font-size="7" fill="#999" text-anchor="start" transform="rotate(90,648,208)">score</text>

  <!-- Output: adapted model -->
  <rect x="464" y="304" width="186" height="36" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1"/>
  <text x="557" y="320" font-size="9" font-weight="600" fill="#1a6a3a" text-anchor="middle">Adapted Model w*+Δw</text>
  <text x="557" y="333" font-size="8" fill="#3d9e5a" text-anchor="middle">personalized to local distribution</text>

  <!-- Hardware label -->
  <rect x="464" y="354" width="186" height="40" rx="4" fill="#fafafa" stroke="#bbb" stroke-width="0.8"/>
  <text x="557" y="370" font-size="8.5" fill="#555" text-anchor="middle" font-weight="600">Edge Hardware</text>
  <text x="557" y="384" font-size="8" fill="#777" text-anchor="middle">smartphone NPU, MCU</text>
  <text x="557" y="396" font-size="8" fill="#777" text-anchor="middle">minutes of adaptation time</text>

  <!-- Transfer arrow Stage 1 → Stage 3 via constraints box -->
  <line x1="232" y1="320" x2="250" y2="320" stroke="#4a90c4" stroke-width="1.8" marker-end="url(#arr-blue)"/>
  <text x="241" y="314" font-size="8" fill="#4a90c4" text-anchor="middle">w*</text>
  <line x1="430" y1="320" x2="448" y2="320" stroke="#4a90c4" stroke-width="1.8" marker-end="url(#arr-blue)"/>
  <text x="439" y="314" font-size="8" fill="#4a90c4" text-anchor="middle">w*</text>

  <!-- Local data flows in arrow -->
  <line x1="557" y1="100" x2="557" y2="116" stroke="#3d9e5a" stroke-width="1.2" marker-end="url(#arr-green)"/>

  <text x="340" y="443" font-size="9" fill="#999" text-anchor="middle" font-style="italic">Pre-training provides rich features;</text>
  <text x="340" y="455" font-size="9" fill="#999" text-anchor="middle" font-style="italic">on-device importance scoring selects which layers to update within the memory envelope.</text>
</svg>
