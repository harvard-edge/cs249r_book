<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#333"/>
    </marker>
  </defs>

  <rect width="680" height="460" fill="#fff"/>

  <!-- Chart area -->
  <!-- Y-axis -->
  <line x1="70" y1="380" x2="70" y2="30" stroke="#333" stroke-width="1.2"/>
  <!-- X-axis -->
  <line x1="70" y1="380" x2="650" y2="380" stroke="#333" stroke-width="1.2"/>

  <!-- Y-axis label -->
  <text x="18" y="210" font-size="11" font-weight="600" fill="#333" text-anchor="middle" transform="rotate(-90, 18, 210)">Training Memory (KB)</text>

  <!-- Y-axis ticks and gridlines -->
  <text x="62" y="380" font-size="9" fill="#555" text-anchor="end">0</text>
  <text x="62" y="310" font-size="9" fill="#555" text-anchor="end">500</text>
  <line x1="70" y1="310" x2="650" y2="310" stroke="#e8e8e8" stroke-width="0.8"/>
  <text x="62" y="240" font-size="9" fill="#555" text-anchor="end">1,000</text>
  <line x1="70" y1="240" x2="650" y2="240" stroke="#e8e8e8" stroke-width="0.8"/>
  <text x="62" y="170" font-size="9" fill="#555" text-anchor="end">1,500</text>
  <line x1="70" y1="170" x2="650" y2="170" stroke="#e8e8e8" stroke-width="0.8"/>
  <text x="62" y="100" font-size="9" fill="#555" text-anchor="end">2,000</text>
  <line x1="70" y1="100" x2="650" y2="100" stroke="#e8e8e8" stroke-width="0.8"/>
  <text x="62" y="66" font-size="9" fill="#555" text-anchor="end">2,250</text>
  <line x1="70" y1="66" x2="650" y2="66" stroke="#e8e8e8" stroke-width="0.8"/>

  <!-- MCU SRAM limit line -->
  <line x1="70" y1="308" x2="650" y2="308" stroke="#a31f34" stroke-width="1.8" stroke-dasharray="6,4"/>
  <rect x="555" y="295" width="92" height="16" rx="3" fill="#fff" stroke="none"/>
  <text x="600" y="306" font-size="9" font-weight="700" fill="#a31f34" text-anchor="middle">MCU SRAM: 512 KB</text>

  <!-- === Bar Chart A: Standard Fine-Tuning === -->
  <g transform="translate(110, 0)">
    <!-- Label -->
    <text x="85" y="410" font-size="11" font-weight="700" fill="#333" text-anchor="middle">(a) Standard Fine-Tuning</text>

    <!-- Stacked bar (total ~2100 KB, far exceeds 512) -->
    <!-- Frozen layers (gray) — base, always present -->
    <rect x="30" y="260" width="110" height="120" rx="0" fill="#ddd" stroke="#999" stroke-width="1"/>
    <text x="85" y="325" font-size="9" fill="#555" text-anchor="middle">Frozen layers</text>
    <text x="85" y="338" font-size="8" fill="#555" text-anchor="middle">340 KB</text>

    <!-- Trainable activations (orange, large) -->
    <rect x="30" y="120" width="110" height="140" rx="0" fill="#fdebd0" stroke="#c87b2a" stroke-width="1"/>
    <text x="85" y="185" font-size="9" fill="#333" text-anchor="middle">Trainable layer</text>
    <text x="85" y="198" font-size="9" fill="#333" text-anchor="middle">activations</text>
    <text x="85" y="214" font-size="8" fill="#c87b2a" text-anchor="middle">1,000 KB</text>

    <!-- Gradients (red) -->
    <rect x="30" y="72" width="110" height="48" rx="0" fill="#f9d6d5" stroke="#c44" stroke-width="1"/>
    <text x="85" y="96" font-size="9" fill="#333" text-anchor="middle">Gradients</text>
    <text x="85" y="110" font-size="8" fill="#c44" text-anchor="middle">340 KB</text>

    <!-- Optimizer states (purple) -->
    <rect x="30" y="38" width="110" height="34" rx="0" fill="#e8d5f5" stroke="#8855aa" stroke-width="1"/>
    <text x="85" y="58" font-size="9" fill="#333" text-anchor="middle">Optimizer</text>
    <text x="85" y="70" font-size="8" fill="#8855aa" text-anchor="middle">420 KB</text>

    <!-- Total label -->
    <text x="85" y="32" font-size="10" font-weight="700" fill="#a31f34" text-anchor="middle">Total: ~2,100 KB</text>

    <!-- X mark showing doesn't fit -->
    <line x1="56" y1="290" x2="74" y2="308" stroke="#a31f34" stroke-width="3" stroke-linecap="round"/>
    <line x1="74" y1="290" x2="56" y2="308" stroke="#a31f34" stroke-width="3" stroke-linecap="round"/>
    <text x="115" y="302" font-size="9" font-weight="700" fill="#a31f34">exceeds SRAM</text>
  </g>

  <!-- === Bar Chart B: TinyTL === -->
  <g transform="translate(380, 0)">
    <!-- Label -->
    <text x="85" y="410" font-size="11" font-weight="700" fill="#333" text-anchor="middle">(b) TinyTL</text>

    <!-- Stacked bar (total ~390 KB, fits within 512) -->
    <!-- Frozen layers (gray) — same base -->
    <rect x="30" y="260" width="110" height="120" rx="0" fill="#ddd" stroke="#999" stroke-width="1"/>
    <text x="85" y="325" font-size="9" fill="#555" text-anchor="middle">Frozen layers</text>
    <text x="85" y="338" font-size="8" fill="#555" text-anchor="middle">340 KB</text>

    <!-- Lite residual module (small orange) -->
    <rect x="30" y="238" width="110" height="22" rx="0" fill="#d4edda" stroke="#3d9e5a" stroke-width="1"/>
    <text x="85" y="253" font-size="8" fill="#3d9e5a" text-anchor="middle">Lite residual: 30 KB</text>

    <!-- Bias-only gradients (tiny red) -->
    <rect x="30" y="226" width="110" height="12" rx="0" fill="#f9d6d5" stroke="#c44" stroke-width="1"/>
    <text x="85" y="235" font-size="7" fill="#c44" text-anchor="middle">Bias grad: 20 KB</text>

    <!-- Total label -->
    <text x="85" y="218" font-size="10" font-weight="700" fill="#3d9e5a" text-anchor="middle">Total: ~390 KB</text>

    <!-- Check mark showing it fits -->
    <path d="M 58,297 L 63,306 L 76,288" fill="none" stroke="#3d9e5a" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
    <text x="115" y="302" font-size="9" font-weight="700" fill="#3d9e5a">fits in SRAM</text>
  </g>

  <!-- Reduction arrow between the two charts -->
  <!-- Callout box floats above the curve; arrow sweeps from left bar top down to right bar -->
  <g transform="translate(270, 90)">
    <!-- Label box above the arc -->
    <rect x="10" y="0" width="76" height="30" rx="3" fill="#fff" stroke="#a31f34" stroke-width="1.2"/>
    <text x="48" y="13" font-size="9" font-weight="700" fill="#a31f34" text-anchor="middle">~5x memory</text>
    <text x="48" y="25" font-size="9" font-weight="700" fill="#a31f34" text-anchor="middle">reduction</text>
    <!-- Arc from below box, curving down-right to TinyTL bar top -->
    <path d="M 48,30 Q 70,75 115,130" fill="none" stroke="#a31f34" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arrow)"/>
  </g>

  <!-- Legend — two rows to avoid clipping -->
  <g transform="translate(72, 425)">
    <!-- Row 1 -->
    <rect x="0" y="0" width="12" height="12" rx="2" fill="#ddd" stroke="#999" stroke-width="0.8"/>
    <text x="18" y="10" font-size="8.5" fill="#555">Frozen layers</text>

    <rect x="105" y="0" width="12" height="12" rx="2" fill="#fdebd0" stroke="#c87b2a" stroke-width="0.8"/>
    <text x="123" y="10" font-size="8.5" fill="#555">Activations</text>

    <rect x="200" y="0" width="12" height="12" rx="2" fill="#f9d6d5" stroke="#c44" stroke-width="0.8"/>
    <text x="218" y="10" font-size="8.5" fill="#555">Gradients</text>

    <rect x="285" y="0" width="12" height="12" rx="2" fill="#e8d5f5" stroke="#8855aa" stroke-width="0.8"/>
    <text x="303" y="10" font-size="8.5" fill="#555">Optimizer state</text>

    <!-- Row 2 -->
    <rect x="0" y="20" width="12" height="12" rx="2" fill="#d4edda" stroke="#3d9e5a" stroke-width="0.8"/>
    <text x="18" y="30" font-size="8.5" fill="#555">Lite residual (TinyTL)</text>

    <line x1="160" y1="26" x2="180" y2="26" stroke="#a31f34" stroke-width="1.8" stroke-dasharray="6,4"/>
    <text x="186" y="30" font-size="8.5" fill="#a31f34">MCU SRAM limit</text>
  </g>
</svg>
