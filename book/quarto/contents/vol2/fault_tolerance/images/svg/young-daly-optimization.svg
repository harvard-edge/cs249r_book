<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460"
     font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#333"/>
    </marker>
    <marker id="arrow-red" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#c44"/>
    </marker>
    <marker id="arrow-green" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#3d9e5a"/>
    </marker>
  </defs>

  <!-- ── Background ── -->
  <rect width="680" height="460" fill="white"/>

  <!-- ── Dividing line between two panels ── -->
  <line x1="340" y1="20" x2="340" y2="440" stroke="#e8e8e8" stroke-width="1.2"/>

  <!-- ══════════════════════════════════════════════════════════════════════ -->
  <!-- ── LEFT PANEL: Timeline showing checkpoint/failure/rework            -->
  <!-- ══════════════════════════════════════════════════════════════════════ -->
  <text x="170" y="30" text-anchor="middle" font-size="12" font-weight="700" fill="#333">Training Timeline</text>

  <!-- ── Timeline axis ── -->
  <line x1="30" y1="80" x2="320" y2="80" stroke="#333" stroke-width="1.2" marker-end="url(#arrow)"/>
  <text x="325" y="78" text-anchor="start" font-size="9" fill="#555">time</text>

  <!-- ── Checkpoint markers ── -->
  <g fill="#4a90c4" stroke="#4a90c4" stroke-width="1.5">
    <line x1="50"  y1="70" x2="50"  y2="90"/>
    <line x1="110" y1="70" x2="110" y2="90"/>
    <line x1="170" y1="70" x2="170" y2="90"/>
    <line x1="230" y1="70" x2="230" y2="90"/>
    <line x1="290" y1="70" x2="290" y2="90"/>
  </g>

  <!-- ── Checkpoint icons (small squares) ── -->
  <g fill="#cfe2f3" stroke="#4a90c4" stroke-width="1">
    <rect x="44"  y="62" width="12" height="8" rx="1"/>
    <rect x="104" y="62" width="12" height="8" rx="1"/>
    <rect x="164" y="62" width="12" height="8" rx="1"/>
    <rect x="224" y="62" width="12" height="8" rx="1"/>
    <rect x="284" y="62" width="12" height="8" rx="1"/>
  </g>
  <text x="50"  y="56" text-anchor="middle" font-size="8" fill="#4a90c4">C</text>
  <text x="110" y="56" text-anchor="middle" font-size="8" fill="#4a90c4">C</text>
  <text x="170" y="56" text-anchor="middle" font-size="8" fill="#4a90c4">C</text>
  <text x="230" y="56" text-anchor="middle" font-size="8" fill="#4a90c4">C</text>
  <text x="290" y="56" text-anchor="middle" font-size="8" fill="#4a90c4">C</text>

  <!-- ── Interval tau labels ── -->
  <line x1="50" y1="98" x2="110" y2="98" stroke="#333" stroke-width="0.8"/>
  <line x1="50" y1="95" x2="50" y2="101"/>
  <line x1="110" y1="95" x2="110" y2="101"/>
  <text x="80" y="112" text-anchor="middle" font-size="9" font-weight="700" fill="#333">&#x03C4;</text>

  <line x1="110" y1="98" x2="170" y2="98" stroke="#333" stroke-width="0.8"/>
  <line x1="170" y1="95" x2="170" y2="101"/>
  <text x="140" y="112" text-anchor="middle" font-size="9" font-weight="700" fill="#333">&#x03C4;</text>

  <!-- ── Training progress (green bar) ── -->
  <rect x="50" y="130" width="210" height="14" rx="3" fill="#d4edda" stroke="#3d9e5a" stroke-width="1"/>
  <text x="155" y="140" text-anchor="middle" font-size="8" font-weight="700" fill="#3d9e5a">Useful training work</text>

  <!-- ── Failure point ── -->
  <line x1="260" y1="122" x2="260" y2="152" stroke="#c44" stroke-width="2"/>
  <text x="260" y="118" text-anchor="middle" font-size="9" font-weight="700" fill="#c44">FAILURE</text>
  <path d="M 254,128 L 260,122 L 266,128" fill="none" stroke="#c44" stroke-width="1.5"/>
  <path d="M 254,146 L 260,152 L 266,146" fill="none" stroke="#c44" stroke-width="1.5"/>

  <!-- ── Wasted work (red bar) ── -->
  <rect x="230" y="130" width="30" height="14" rx="0" fill="#f9d6d5" stroke="#c44" stroke-width="1"/>

  <!-- ── Wasted work brace ── -->
  <line x1="230" y1="156" x2="260" y2="156" stroke="#c44" stroke-width="0.8"/>
  <line x1="230" y1="153" x2="230" y2="159"/>
  <line x1="260" y1="153" x2="260" y2="159"/>
  <text x="245" y="170" text-anchor="middle" font-size="8" font-weight="700" fill="#c44">wasted</text>

  <!-- ── Last good checkpoint annotation ── -->
  <path d="M 230,88 L 230,125" fill="none" stroke="#4a90c4" stroke-width="1" stroke-dasharray="3,3"/>
  <text x="230" y="104" text-anchor="end" font-size="8" fill="#4a90c4" dx="-4">last</text>
  <text x="230" y="114" text-anchor="end" font-size="8" fill="#4a90c4" dx="-4">ckpt</text>

  <!-- ── Recovery arrow ── -->
  <path d="M 260,178 C 260,195 230,195 230,195 L 230,192"
        fill="none" stroke="#3d9e5a" stroke-width="1.5" marker-end="url(#arrow-green)"/>
  <text x="270" y="192" text-anchor="start" font-size="8" fill="#3d9e5a" font-weight="700">Rollback to</text>
  <text x="270" y="203" text-anchor="start" font-size="8" fill="#3d9e5a" font-weight="700">last checkpoint</text>

  <!-- ── Formula box (left panel) ── -->
  <rect x="30" y="225" width="290" height="85" rx="5" fill="#f7f7f7" stroke="#bbb" stroke-width="1.2"/>
  <text x="175" y="246" text-anchor="middle" font-size="10" font-weight="700" fill="#333">Expected wasted work per failure</text>

  <text x="175" y="268" text-anchor="middle" font-size="9.5" fill="#555">Save overhead = T_write / &#x03C4;</text>
  <text x="175" y="284" text-anchor="middle" font-size="9.5" fill="#555">Rework cost = &#x03C4; / (2 &#x00B7; MTBF)</text>
  <text x="175" y="302" text-anchor="middle" font-size="10" font-weight="700" fill="#a31f34">Total waste = T_write/&#x03C4; + &#x03C4;/(2 &#x00B7; MTBF)</text>

  <!-- ── Worked example (left panel bottom) ── -->
  <rect x="30" y="322" width="290" height="108" rx="5" fill="white" stroke="#a31f34" stroke-width="1.2"/>
  <text x="175" y="340" text-anchor="middle" font-size="10" font-weight="700" fill="#a31f34">Worked Example</text>

  <text x="45" y="360" font-size="9" fill="#555">T_write = 20 min (checkpoint save time)</text>
  <text x="45" y="376" font-size="9" fill="#555">MTBF = 3,000 min (50 hrs, 10K GPU cluster)</text>
  <text x="45" y="396" font-size="9.5" font-weight="700" fill="#333">&#x03C4;* = &#x221A;(2 &#x00B7; 20 &#x00B7; 3000) = &#x221A;120,000</text>
  <text x="45" y="414" font-size="10" font-weight="700" fill="#a31f34">&#x03C4;* &#x2248; 346 min &#x2248; 5.8 hours</text>

  <!-- ══════════════════════════════════════════════════════════════════════ -->
  <!-- ── RIGHT PANEL: Cost function curve with optimal point               -->
  <!-- ══════════════════════════════════════════════════════════════════════ -->
  <text x="510" y="30" text-anchor="middle" font-size="12" font-weight="700" fill="#333">Cost Function</text>

  <!-- ── Grid lines (right panel) ── -->
  <g stroke="#e8e8e8" stroke-width="0.8">
    <line x1="390" y1="80"  x2="650" y2="80"/>
    <line x1="390" y1="120" x2="650" y2="120"/>
    <line x1="390" y1="160" x2="650" y2="160"/>
    <line x1="390" y1="200" x2="650" y2="200"/>
    <line x1="390" y1="240" x2="650" y2="240"/>
    <line x1="390" y1="280" x2="650" y2="280"/>
    <line x1="390" y1="320" x2="650" y2="320"/>
  </g>

  <!-- ── Axes (right panel) ── -->
  <line x1="390" y1="340" x2="656" y2="340" stroke="#333" stroke-width="1.2" marker-end="url(#arrow)"/>
  <line x1="390" y1="345" x2="390" y2="58"  stroke="#333" stroke-width="1.2" marker-end="url(#arrow)"/>

  <text x="520" y="370" text-anchor="middle" font-size="11" font-weight="600" fill="#333">&#x03C4;</text>
  <text x="365" y="200" text-anchor="middle" font-size="10" font-weight="600" fill="#333"
        transform="rotate(-90, 365, 200)">Overhead (%)</text>

  <!-- ── Save overhead curve (blue dashed, right panel) ── -->
  <path d="M 400,70 C 415,120 430,180 450,220
           C 470,255 500,290 540,310
           C 570,320 610,328 645,330"
        fill="none" stroke="#4a90c4" stroke-width="1.8" stroke-dasharray="6,4" stroke-linecap="round"/>

  <!-- ── Rework curve (red dashed, right panel) ── -->
  <path d="M 390,340 L 420,330 L 460,316 L 500,300 L 540,282 L 580,262 L 620,240 L 645,226"
        fill="none" stroke="#c44" stroke-width="1.8" stroke-dasharray="6,4" stroke-linecap="round"/>

  <!-- ── Total overhead curve (green solid, U-shape, right panel) ── -->
  <path d="M 400,70 C 410,95 420,150 435,195
           C 448,230 465,258 490,275
           C 510,284 530,288 548,286
           C 565,283 582,276 600,265
           C 618,252 635,236 645,224"
        fill="none" stroke="#3d9e5a" stroke-width="2.5" stroke-linecap="round"/>

  <!-- ── Optimal point on right panel ── -->
  <circle cx="540" cy="287" r="5" fill="#a31f34" stroke="white" stroke-width="1.5"/>

  <!-- ── Optimal vertical dashed ── -->
  <line x1="540" y1="292" x2="540" y2="340" stroke="#a31f34" stroke-width="1" stroke-dasharray="4,3"/>

  <!-- ── Label optimal ── -->
  <text x="540" y="356" text-anchor="middle" font-size="10" font-weight="700" fill="#a31f34">&#x03C4;*</text>

  <!-- ── Right panel curve labels ── -->
  <text x="440" y="165" text-anchor="start" font-size="9" font-weight="700" fill="#4a90c4">T_write / &#x03C4;</text>
  <text x="600" y="256" text-anchor="start" font-size="9" font-weight="700" fill="#c44">&#x03C4; / 2M</text>
  <text x="458" y="248" text-anchor="start" font-size="9" font-weight="700" fill="#3d9e5a">Total</text>

  <!-- ── Formula annotation (right panel) ── -->
  <rect x="400" y="390" width="240" height="42" rx="4" fill="#f7f7f7" stroke="#bbb" stroke-width="1.2"/>
  <text x="520" y="408" text-anchor="middle" font-size="10" font-weight="700" fill="#a31f34">&#x03C4;_opt = &#x221A;(2 &#x00B7; T_write &#x00B7; MTBF)</text>
  <text x="520" y="424" text-anchor="middle" font-size="9" fill="#555">Minimizes sum of save overhead + rework</text>

  <!-- ── Footnote ── -->
  <text x="340" y="452" text-anchor="middle" font-size="9" fill="#999" font-style="italic">
    Young-Daly optimization: timeline (left) and cost function (right)
  </text>
</svg>
