<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 420" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arrow-er" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#333"/>
    </marker>
  </defs>

  <!-- Chart area: left=80, right=600, top=30, bottom=355 -->
  <!-- X: log scale Arithmetic Intensity (FLOP/Byte): 0.1 to 1000, log range -1 to 3 -->
  <!-- xMap(v) = 80 + (log10(v)+1)/4 * 520 -->
  <!-- Y: log scale Energy Efficiency (GFLOP/Joule): 0.01 to 100, log range -2 to 2 -->
  <!-- yMap(v) = 355 - (log10(v)+2)/4 * 325 -->

  <!-- Gridlines -->
  <g stroke="#e8e8e8" stroke-width="0.8">
    <!-- Vertical grids: 0.1, 1, 10, 100, 1000 -->
    <line x1="80" y1="30" x2="80" y2="355"/>
    <line x1="210" y1="30" x2="210" y2="355"/>
    <line x1="340" y1="30" x2="340" y2="355"/>
    <line x1="470" y1="30" x2="470" y2="355"/>
    <line x1="600" y1="30" x2="600" y2="355"/>
    <!-- Horizontal grids: 0.01, 0.1, 1, 10, 100 -->
    <line x1="80" y1="355" x2="600" y2="355"/>
    <line x1="80" y1="273.75" x2="600" y2="273.75"/>
    <line x1="80" y1="192.5" x2="600" y2="192.5"/>
    <line x1="80" y1="111.25" x2="600" y2="111.25"/>
    <line x1="80" y1="30" x2="600" y2="30"/>
  </g>

  <!-- Axes -->
  <line x1="80" y1="355" x2="600" y2="355" stroke="#333" stroke-width="1.2"/>
  <line x1="80" y1="30" x2="80" y2="355" stroke="#333" stroke-width="1.2"/>

  <!-- Y-axis labels -->
  <g font-size="9" fill="#555" text-anchor="end">
    <text x="74" y="359">0.01</text>
    <text x="74" y="277">0.1</text>
    <text x="74" y="196">1</text>
    <text x="74" y="115">10</text>
    <text x="74" y="34">100</text>
  </g>
  <text x="18" y="192" text-anchor="middle" font-size="11" font-weight="600" fill="#333" transform="rotate(-90,18,192)">Energy Efficiency (GFLOP/Joule)</text>

  <!-- X-axis labels -->
  <g font-size="9" fill="#555" text-anchor="middle">
    <text x="80" y="372">0.1</text>
    <text x="210" y="372">1</text>
    <text x="340" y="372">10</text>
    <text x="470" y="372">100</text>
    <text x="600" y="372">1000</text>
  </g>
  <text x="340" y="395" text-anchor="middle" font-size="11" font-weight="600" fill="#333">Arithmetic Intensity (FLOP/Byte)</text>

  <!-- X-axis ticks -->
  <g stroke="#333" stroke-width="1">
    <line x1="80" y1="355" x2="80" y2="359"/>
    <line x1="210" y1="355" x2="210" y2="359"/>
    <line x1="340" y1="355" x2="340" y2="359"/>
    <line x1="470" y1="355" x2="470" y2="359"/>
    <line x1="600" y1="355" x2="600" y2="359"/>
  </g>

  <!-- Memory bandwidth energy ceiling (sloped line): slope = BW energy efficiency -->
  <!-- From (0.1, 0.01) to ridge point (32, 10) -->
  <!-- (0.1, 0.01): x=80, y=355 -->
  <!-- (32, 10): x=80+(log10(32)+1)/4*520 = 80+(1.505+1)/4*520 = 80+325.7 = 405.7, y=355-(log10(10)+2)/4*325=355-3/4*325=355-243.75=111.25 -->
  <line x1="80" y1="355" x2="406" y2="111.25" stroke="#4a90c4" stroke-width="2.5"/>

  <!-- Compute energy ceiling (flat line): peak circuit efficiency = 10 GFLOP/J -->
  <!-- From ridge point (32, 10) to (1000, 10) -->
  <line x1="406" y1="111.25" x2="600" y2="111.25" stroke="#a31f34" stroke-width="2.5"/>

  <!-- Ridge point -->
  <circle cx="406" cy="111.25" r="7" fill="#333" stroke="white" stroke-width="2"/>

  <!-- Ridge point vertical dashed line -->
  <line x1="406" y1="111.25" x2="406" y2="355" stroke="#555" stroke-width="1" stroke-dasharray="5,3"/>
  <text x="406" y="365" text-anchor="middle" font-size="9" font-weight="700" fill="#333">Ridge Point</text>
  <text x="406" y="377" text-anchor="middle" font-size="8" fill="#555">~32 FLOP/Byte</text>

  <!-- Labels for ceiling regions -->
  <text x="210" y="220" text-anchor="middle" font-size="10" font-weight="700" fill="#4a90c4" transform="rotate(-42,210,220)">Memory Energy Bound</text>
  <text x="503" y="102" text-anchor="middle" font-size="10" font-weight="700" fill="#a31f34">Compute Energy Bound</text>

  <!-- Workload points -->
  <!-- (a) Memory-bound inference: AI=2 FLOP/B, eff=0.06 GFLOP/J -->
  <!-- x=80+(log10(2)+1)/4*520 = 80+(0.301+1)/4*520 = 80+169.1=249.1, y=355-(log10(0.06)+2)/4*325=355-(-1.22+2)/4*325=355-0.78/4*325=355-63.4=291.6 -->
  <circle cx="249" cy="292" r="8" fill="#cfe2f3" stroke="#4a90c4" stroke-width="2"/>
  <text x="260" y="307" font-size="9.5" font-weight="700" fill="#4a90c4">(a) LLM Inference</text>
  <text x="260" y="318" font-size="8.5" fill="#555">Memory-bound, low efficiency</text>

  <!-- (b) Compute-bound training: AI=80 FLOP/B, eff=6 GFLOP/J -->
  <!-- x=80+(log10(80)+1)/4*520=80+(1.903+1)/4*520=80+377.4=457.4, y=355-(log10(6)+2)/4*325=355-(0.778+2)/4*325=355-225.9=129.1 -->
  <circle cx="457" cy="129" r="8" fill="#f9d6d5" stroke="#c44" stroke-width="2"/>
  <text x="468" y="124" font-size="9.5" font-weight="700" fill="#c44">(b) MatMul Training</text>
  <text x="468" y="135" font-size="8.5" fill="#555">Near peak compute efficiency</text>

  <!-- (c) Sparse inference: AI=5 FLOP/B, eff=0.15 GFLOP/J -->
  <!-- x=80+(log10(5)+1)/4*520=80+(0.699+1)/4*520=80+220.9=300.9, y=355-(log10(0.15)+2)/4*325=355-(-0.824+2)/4*325=355-95.6=259.4 -->
  <circle cx="301" cy="259" r="7" fill="#d4edda" stroke="#3d9e5a" stroke-width="2"/>
  <text x="313" y="254" font-size="9.5" font-weight="700" fill="#3d9e5a">(c) Sparse Inference</text>
  <text x="313" y="265" font-size="8.5" fill="#555">MoE / pruned models</text>

  <!-- Key insight box -->
  <rect x="88" y="38" width="270" height="48" rx="4" fill="white" stroke="#a31f34" stroke-width="1.2"/>
  <text x="98" y="55" font-size="10" font-weight="700" fill="#a31f34">Key Insight</text>
  <text x="98" y="70" font-size="9" fill="#333">Memory access costs ~100x more energy per</text>
  <text x="98" y="81" font-size="9" fill="#333">FLOP than computation. Inference is memory-bound.</text>

  <!-- Energy cost annotation -->
  <rect x="88" y="95" width="200" height="30" rx="3" fill="#f7f7f7" stroke="#bbb" stroke-width="0.8"/>
  <text x="98" y="108" font-size="8.5" fill="#555">DRAM access: ~20 pJ/byte</text>
  <text x="98" y="119" font-size="8.5" fill="#555">FP16 MAC: ~0.2 pJ/op (100x less)</text>

  <!-- Source -->
  <text x="600" y="412" text-anchor="end" font-size="9" fill="#999" font-style="italic">After Horowitz 2014, Williams et al. 2009</text>
</svg>
