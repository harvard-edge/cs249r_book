<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arrow-cl" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#555"/>
    </marker>
  </defs>

  <!-- Three-phase headers -->
  <!-- Phase 1: Manufacturing x=30..215 -->
  <rect x="30" y="22" width="185" height="52" rx="6" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5"/>
  <text x="122" y="44" text-anchor="middle" font-size="12" font-weight="700" fill="#333">Manufacturing</text>
  <text x="122" y="58" text-anchor="middle" font-size="9.5" fill="#666">Embodied Carbon</text>

  <!-- Arrow 1→2 -->
  <line x1="220" y1="48" x2="243" y2="48" stroke="#555" stroke-width="1.4" marker-end="url(#arrow-cl)"/>

  <!-- Phase 2: Training x=248..433 -->
  <rect x="248" y="22" width="185" height="52" rx="6" fill="#f9d6d5" stroke="#c44" stroke-width="1.5"/>
  <text x="340" y="44" text-anchor="middle" font-size="12" font-weight="700" fill="#333">Training</text>
  <text x="340" y="58" text-anchor="middle" font-size="9.5" fill="#666">Operational Carbon</text>

  <!-- Arrow 2→3 -->
  <line x1="438" y1="48" x2="461" y2="48" stroke="#555" stroke-width="1.4" marker-end="url(#arrow-cl)"/>

  <!-- Phase 3: Inference x=466..651 -->
  <rect x="466" y="22" width="185" height="52" rx="6" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="558" y="44" text-anchor="middle" font-size="12" font-weight="700" fill="#333">Inference</text>
  <text x="558" y="58" text-anchor="middle" font-size="9.5" fill="#666">Operational Carbon</text>

  <!-- Proportional bars — y range 95..325, total height 230px -->
  <!-- Manufacturing: 30% → 69px, Training: 50% → 115px, Inference: 20% → 46px -->

  <!-- Manufacturing bar -->
  <rect x="50" y="100" width="125" height="210" rx="5" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.2"/>
  <text x="112" y="170" text-anchor="middle" font-size="30" font-weight="700" fill="#c87b2a">30%</text>

  <!-- Manufacturing sub-components -->
  <rect x="62" y="195" width="102" height="20" rx="3" fill="white" stroke="#c87b2a" stroke-width="0.8"/>
  <text x="113" y="209" text-anchor="middle" font-size="8.5" font-weight="600" fill="#555">Chip Fabrication</text>

  <rect x="62" y="221" width="102" height="20" rx="3" fill="white" stroke="#c87b2a" stroke-width="0.8"/>
  <text x="113" y="235" text-anchor="middle" font-size="8.5" font-weight="600" fill="#555">Server Assembly</text>

  <rect x="62" y="247" width="102" height="20" rx="3" fill="white" stroke="#c87b2a" stroke-width="0.8"/>
  <text x="113" y="261" text-anchor="middle" font-size="8.5" font-weight="600" fill="#555">Rare Earth Mining</text>

  <rect x="62" y="273" width="102" height="20" rx="3" fill="white" stroke="#c87b2a" stroke-width="0.8"/>
  <text x="113" y="287" text-anchor="middle" font-size="8.5" font-weight="600" fill="#555">Supply Chain</text>

  <text x="112" y="97" text-anchor="middle" font-size="8.5" fill="#c87b2a" font-style="italic">150-200 kg CO&#x2082;/GPU</text>

  <!-- Training bar (tallest) -->
  <rect x="225" y="88" width="175" height="222" rx="5" fill="#f9d6d5" stroke="#c44" stroke-width="1.2"/>
  <text x="312" y="165" text-anchor="middle" font-size="34" font-weight="700" fill="#c44">50%</text>

  <!-- Training sub-components -->
  <rect x="240" y="195" width="140" height="20" rx="3" fill="white" stroke="#c44" stroke-width="0.8"/>
  <text x="310" y="209" text-anchor="middle" font-size="8.5" font-weight="600" fill="#555">Compute x PUE x Time</text>

  <rect x="240" y="221" width="140" height="20" rx="3" fill="white" stroke="#c44" stroke-width="0.8"/>
  <text x="310" y="235" text-anchor="middle" font-size="8.5" font-weight="600" fill="#555">Grid Carbon Intensity</text>

  <rect x="240" y="247" width="140" height="20" rx="3" fill="white" stroke="#c44" stroke-width="0.8"/>
  <text x="310" y="261" text-anchor="middle" font-size="8.5" font-weight="600" fill="#555">Gradient Sync Overhead</text>

  <rect x="240" y="273" width="140" height="20" rx="3" fill="white" stroke="#c44" stroke-width="0.8"/>
  <text x="310" y="287" text-anchor="middle" font-size="8.5" font-weight="600" fill="#555">Checkpoint I/O</text>

  <text x="312" y="83" text-anchor="middle" font-size="8.5" fill="#c44" font-style="italic">GPT-3: 1,287 MWh = 552 t CO&#x2082;</text>

  <!-- Inference bar -->
  <rect x="460" y="130" width="160" height="180" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="540" y="200" text-anchor="middle" font-size="28" font-weight="700" fill="#4a90c4">20%</text>

  <!-- Inference sub-components -->
  <rect x="475" y="225" width="130" height="20" rx="3" fill="white" stroke="#4a90c4" stroke-width="0.8"/>
  <text x="540" y="239" text-anchor="middle" font-size="8.5" font-weight="600" fill="#555">Requests x Energy/req</text>

  <rect x="475" y="251" width="130" height="20" rx="3" fill="white" stroke="#4a90c4" stroke-width="0.8"/>
  <text x="540" y="265" text-anchor="middle" font-size="8.5" font-weight="600" fill="#555">Grid Carbon Intensity</text>

  <rect x="475" y="277" width="130" height="20" rx="3" fill="white" stroke="#4a90c4" stroke-width="0.8"/>
  <text x="540" y="291" text-anchor="middle" font-size="8.5" font-weight="600" fill="#555">KV Cache Memory</text>

  <text x="540" y="125" text-anchor="middle" font-size="8.5" fill="#4a90c4" font-style="italic">Scales with deployment</text>

  <!-- Equation box -->
  <rect x="30" y="330" width="620" height="48" rx="5" fill="#f7f7f7" stroke="#bbb" stroke-width="1.2"/>
  <text x="340" y="350" text-anchor="middle" font-size="11" font-weight="700" fill="#333">Lifecycle Carbon Equation</text>
  <text x="340" y="368" text-anchor="middle" font-size="10" fill="#555">CO&#x2082;_total = CO&#x2082;_embodied + (E_train x PUE x CI_grid) + (N_requests x E_per_req x CI_grid)</text>

  <!-- Key insight -->
  <rect x="30" y="392" width="620" height="48" rx="5" fill="white" stroke="#a31f34" stroke-width="1.2"/>
  <text x="44" y="412" font-size="10" font-weight="700" fill="#a31f34">Key Insight:</text>
  <text x="126" y="412" font-size="9.5" fill="#333">In clean-grid regions (hydro, nuclear), embodied carbon can exceed operational carbon over the</text>
  <text x="44" y="428" font-size="9.5" fill="#333">hardware lifetime. Hardware longevity and utilization rate become first-order sustainability levers alongside energy source.</text>
</svg>
