<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arrow-down" markerWidth="8" markerHeight="6" refX="4" refY="6" orient="auto">
      <path d="M0,0 L8,0 L4,6 Z" fill="#555"/>
    </marker>
    <marker id="arrow-up" markerWidth="8" markerHeight="6" refX="4" refY="0" orient="auto">
      <path d="M0,6 L8,6 L4,0 Z" fill="#3d9e5a"/>
    </marker>
  </defs>

  <!-- === Tier 1: CDN / Edge Cache === -->
  <g transform="translate(40, 22)">
    <!-- Main box -->
    <rect x="0" y="0" width="600" height="85" rx="6" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
    <text x="20" y="24" font-size="12" font-weight="700" fill="#333">Tier 1: CDN / Edge Cache</text>
    <text x="20" y="42" font-size="9.5" fill="#555">Geographic distribution, cached static responses, prompt templates</text>

    <!-- Horizontal scaling: 3 edge nodes -->
    <rect x="20" y="52" width="100" height="26" rx="4" fill="#fff" stroke="#4a90c4" stroke-width="1"/>
    <text x="70" y="69" text-anchor="middle" font-size="9" fill="#333">Edge PoP 1</text>
    <rect x="135" y="52" width="100" height="26" rx="4" fill="#fff" stroke="#4a90c4" stroke-width="1"/>
    <text x="185" y="69" text-anchor="middle" font-size="9" fill="#333">Edge PoP 2</text>
    <rect x="250" y="52" width="100" height="26" rx="4" fill="#fff" stroke="#4a90c4" stroke-width="1"/>
    <text x="300" y="69" text-anchor="middle" font-size="9" fill="#333">Edge PoP 3</text>
    <text x="370" y="69" font-size="9" fill="#999">...</text>

    <!-- SLA label -->
    <rect x="460" y="52" width="120" height="26" rx="12" fill="#fff" stroke="#a31f34" stroke-width="1.2"/>
    <text x="520" y="69" text-anchor="middle" font-size="9.5" font-weight="700" fill="#a31f34">SLA: &lt;10 ms</text>
  </g>

  <!-- Arrow down: Tier 1 to Tier 2 (request flow) -->
  <line x1="280" y1="109" x2="280" y2="138" stroke="#555" stroke-width="1.2" marker-end="url(#arrow-down)"/>
  <text x="260" y="128" text-anchor="end" font-size="8.5" fill="#555">request</text>

  <!-- Arrow up: Tier 2 to Tier 1 (response flow) -->
  <line x1="400" y1="138" x2="400" y2="109" stroke="#3d9e5a" stroke-width="1.2" marker-end="url(#arrow-up)"/>
  <text x="420" y="128" font-size="8.5" fill="#3d9e5a">response</text>

  <!-- === Tier 2: Gateway / Router === -->
  <g transform="translate(40, 140)">
    <rect x="0" y="0" width="600" height="100" rx="6" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5"/>
    <text x="20" y="24" font-size="12" font-weight="700" fill="#333">Tier 2: Gateway / Router</text>
    <text x="20" y="42" font-size="9.5" fill="#555">Request routing, rate limiting, authentication, SLO classification</text>

    <!-- Horizontal scaling: gateway instances -->
    <rect x="20" y="55" width="110" height="34" rx="4" fill="#fff" stroke="#c87b2a" stroke-width="1"/>
    <text x="75" y="71" text-anchor="middle" font-size="9" font-weight="600" fill="#333">Rate Limiter</text>
    <text x="75" y="82" text-anchor="middle" font-size="8" fill="#555">token bucket</text>

    <rect x="145" y="55" width="110" height="34" rx="4" fill="#fff" stroke="#c87b2a" stroke-width="1"/>
    <text x="200" y="71" text-anchor="middle" font-size="9" font-weight="600" fill="#333">Auth / API Key</text>
    <text x="200" y="82" text-anchor="middle" font-size="8" fill="#555">validation</text>

    <rect x="270" y="55" width="110" height="34" rx="4" fill="#fff" stroke="#c87b2a" stroke-width="1"/>
    <text x="325" y="71" text-anchor="middle" font-size="9" font-weight="600" fill="#333">Router</text>
    <text x="325" y="82" text-anchor="middle" font-size="8" fill="#555">model selection</text>

    <!-- SLA label -->
    <rect x="460" y="60" width="120" height="26" rx="12" fill="#fff" stroke="#a31f34" stroke-width="1.2"/>
    <text x="520" y="77" text-anchor="middle" font-size="9.5" font-weight="700" fill="#a31f34">SLA: &lt;50 ms</text>
  </g>

  <!-- Arrow down: Tier 2 to Tier 3 -->
  <line x1="280" y1="242" x2="280" y2="271" stroke="#555" stroke-width="1.2" marker-end="url(#arrow-down)"/>
  <text x="260" y="261" text-anchor="end" font-size="8.5" fill="#555">request</text>

  <!-- Arrow up: Tier 3 to Tier 2 -->
  <line x1="400" y1="271" x2="400" y2="242" stroke="#3d9e5a" stroke-width="1.2" marker-end="url(#arrow-up)"/>
  <text x="420" y="261" font-size="8.5" fill="#3d9e5a">response</text>

  <!-- === Tier 3: Model Serving Cluster === -->
  <g transform="translate(40, 273)">
    <rect x="0" y="0" width="600" height="145" rx="6" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.5"/>
    <text x="20" y="24" font-size="12" font-weight="700" fill="#333">Tier 3: Model Serving Cluster</text>
    <text x="20" y="42" font-size="9.5" fill="#555">GPU workers, autoscaling, load balancing, continuous batching</text>

    <!-- GPU Worker boxes -->
    <rect x="20" y="54" width="105" height="76" rx="4" fill="#fff" stroke="#3d9e5a" stroke-width="1"/>
    <text x="72" y="72" text-anchor="middle" font-size="9" font-weight="600" fill="#333">GPU Worker 1</text>
    <rect x="34" y="78" width="76" height="16" rx="3" fill="#cfe2f3" stroke="#4a90c4" stroke-width="0.8"/>
    <text x="72" y="90" text-anchor="middle" font-size="7.5" fill="#333">Prefill</text>
    <rect x="34" y="98" width="76" height="16" rx="3" fill="#f9d6d5" stroke="#c44" stroke-width="0.8"/>
    <text x="72" y="110" text-anchor="middle" font-size="7.5" fill="#333">Decode</text>

    <rect x="140" y="54" width="105" height="76" rx="4" fill="#fff" stroke="#3d9e5a" stroke-width="1"/>
    <text x="192" y="72" text-anchor="middle" font-size="9" font-weight="600" fill="#333">GPU Worker 2</text>
    <rect x="154" y="78" width="76" height="16" rx="3" fill="#cfe2f3" stroke="#4a90c4" stroke-width="0.8"/>
    <text x="192" y="90" text-anchor="middle" font-size="7.5" fill="#333">Prefill</text>
    <rect x="154" y="98" width="76" height="16" rx="3" fill="#f9d6d5" stroke="#c44" stroke-width="0.8"/>
    <text x="192" y="110" text-anchor="middle" font-size="7.5" fill="#333">Decode</text>

    <rect x="260" y="54" width="105" height="76" rx="4" fill="#fff" stroke="#3d9e5a" stroke-width="1"/>
    <text x="312" y="72" text-anchor="middle" font-size="9" font-weight="600" fill="#333">GPU Worker 3</text>
    <rect x="274" y="78" width="76" height="16" rx="3" fill="#cfe2f3" stroke="#4a90c4" stroke-width="0.8"/>
    <text x="312" y="90" text-anchor="middle" font-size="7.5" fill="#333">Prefill</text>
    <rect x="274" y="98" width="76" height="16" rx="3" fill="#f9d6d5" stroke="#c44" stroke-width="0.8"/>
    <text x="312" y="110" text-anchor="middle" font-size="7.5" fill="#333">Decode</text>

    <text x="386" y="96" font-size="12" fill="#999">...</text>

    <!-- Autoscaler box -->
    <rect x="410" y="54" width="170" height="76" rx="4" fill="#fff" stroke="#3d9e5a" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="495" y="74" text-anchor="middle" font-size="9" font-weight="600" fill="#333">Autoscaler</text>
    <text x="495" y="90" text-anchor="middle" font-size="8.5" fill="#555">queue depth monitor</text>
    <text x="495" y="103" text-anchor="middle" font-size="8.5" fill="#555">scale-up / scale-down</text>
    <text x="495" y="116" text-anchor="middle" font-size="8.5" fill="#555">GPU cold start: ~60 s</text>

    <!-- SLA label -->
    <rect x="460" y="3" width="120" height="26" rx="12" fill="#fff" stroke="#a31f34" stroke-width="1.2"/>
    <text x="520" y="20" text-anchor="middle" font-size="9.5" font-weight="700" fill="#a31f34">SLA: &lt;2 s</text>
  </g>

  <!-- Bottom annotation -->
  <text x="340" y="445" text-anchor="middle" font-size="9" font-style="italic" fill="#999">Each tier scales horizontally; latency budget consumed cumulatively top to bottom</text>
</svg>
