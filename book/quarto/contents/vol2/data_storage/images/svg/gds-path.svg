<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="trad-arr" markerWidth="7" markerHeight="5" refX="6" refY="2.5" orient="auto">
      <path d="M0,0 L7,2.5 L0,5" fill="#c44"/>
    </marker>
    <marker id="gds-arr" markerWidth="7" markerHeight="5" refX="6" refY="2.5" orient="auto">
      <path d="M0,0 L7,2.5 L0,5" fill="#3d9e5a"/>
    </marker>
  </defs>

  <rect width="680" height="460" fill="#fafafa" rx="3"/>

  <!-- Section A: Traditional Path -->
  <text x="340" y="28" text-anchor="middle" font-size="11" font-weight="700" fill="#333">(a) Traditional Path: CPU Bounce Buffer</text>

  <!-- NVMe -->
  <rect x="30" y="60" width="110" height="50" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.2"/>
  <text x="85" y="82" text-anchor="middle" font-size="10" font-weight="700" fill="#5a3a10">NVMe SSD</text>
  <text x="85" y="96" text-anchor="middle" font-size="8" fill="#555">7 GB/s seq read</text>

  <!-- Arrow 1: NVMe -> PCIe -->
  <line x1="140" y1="85" x2="178" y2="85" stroke="#c44" stroke-width="1.4" marker-end="url(#trad-arr)"/>
  <text x="159" y="78" text-anchor="middle" font-size="7.5" fill="#c44" font-weight="600">PCIe</text>

  <!-- CPU RAM (bounce buffer) -->
  <rect x="180" y="50" width="130" height="70" rx="4" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="245" y="74" text-anchor="middle" font-size="10" font-weight="700" fill="#1a3a5c">CPU RAM</text>
  <text x="245" y="90" text-anchor="middle" font-size="8.5" fill="#555">(Bounce Buffer)</text>
  <text x="245" y="106" text-anchor="middle" font-size="8" fill="#c44" font-style="italic">Extra copy here</text>

  <!-- Arrow 2: CPU RAM -> CPU -->
  <line x1="310" y1="85" x2="348" y2="85" stroke="#c44" stroke-width="1.4" marker-end="url(#trad-arr)"/>
  <text x="329" y="78" text-anchor="middle" font-size="7.5" fill="#c44" font-weight="600">memcpy</text>

  <!-- CPU -->
  <rect x="350" y="60" width="90" height="50" rx="4" fill="#f7f7f7" stroke="#bbb" stroke-width="1.2"/>
  <text x="395" y="82" text-anchor="middle" font-size="10" font-weight="700" fill="#333">CPU</text>
  <text x="395" y="96" text-anchor="middle" font-size="8" fill="#555">kernel involved</text>

  <!-- Arrow 3: CPU -> PCIe -> GPU HBM -->
  <line x1="440" y1="85" x2="478" y2="85" stroke="#c44" stroke-width="1.4" marker-end="url(#trad-arr)"/>
  <text x="459" y="78" text-anchor="middle" font-size="7.5" fill="#c44" font-weight="600">PCIe</text>

  <!-- GPU HBM -->
  <rect x="480" y="60" width="120" height="50" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="540" y="82" text-anchor="middle" font-size="10" font-weight="700" fill="#1a4a2a">GPU HBM</text>
  <text x="540" y="96" text-anchor="middle" font-size="8" fill="#555">Training data</text>

  <!-- Traditional path summary -->
  <rect x="120" y="130" width="440" height="34" rx="3" fill="#f9d6d5" stroke="#c44" stroke-width="0.8"/>
  <text x="340" y="146" text-anchor="middle" font-size="9" fill="#8b1a1a" font-weight="600">2 PCIe crossings + CPU memcpy overhead + kernel context switches</text>
  <text x="340" y="158" text-anchor="middle" font-size="8.5" fill="#555">Data touches CPU memory before reaching GPU</text>

  <!-- Divider -->
  <line x1="30" y1="185" x2="650" y2="185" stroke="#ddd" stroke-width="1.0"/>

  <!-- Section B: GDS Path -->
  <text x="340" y="212" text-anchor="middle" font-size="11" font-weight="700" fill="#333">(b) GPUDirect Storage: CPU Bypass</text>

  <!-- NVMe -->
  <rect x="60" y="240" width="110" height="50" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.2"/>
  <text x="115" y="262" text-anchor="middle" font-size="10" font-weight="700" fill="#5a3a10">NVMe SSD</text>
  <text x="115" y="276" text-anchor="middle" font-size="8" fill="#555">7 GB/s seq read</text>

  <!-- Direct arrow: NVMe -> GPU HBM -->
  <line x1="170" y1="265" x2="428" y2="265" stroke="#3d9e5a" stroke-width="2.0" marker-end="url(#gds-arr)"/>
  <text x="300" y="256" text-anchor="middle" font-size="9" fill="#3d9e5a" font-weight="700">PCIe Direct DMA (GPU-initiated)</text>

  <!-- GPU HBM -->
  <rect x="430" y="240" width="120" height="50" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="490" y="262" text-anchor="middle" font-size="10" font-weight="700" fill="#1a4a2a">GPU HBM</text>
  <text x="490" y="276" text-anchor="middle" font-size="8" fill="#555">Training data</text>

  <!-- CPU shown as bypassed -->
  <rect x="240" y="300" width="90" height="40" rx="4" fill="#f7f7f7" stroke="#ddd" stroke-width="1.0" stroke-dasharray="4,3"/>
  <text x="285" y="320" text-anchor="middle" font-size="9" fill="#bbb" font-weight="600">CPU</text>
  <text x="285" y="332" text-anchor="middle" font-size="7.5" fill="#bbb" font-style="italic">bypassed</text>

  <!-- GDS path summary -->
  <rect x="120" y="355" width="440" height="34" rx="3" fill="#d4edda" stroke="#3d9e5a" stroke-width="0.8"/>
  <text x="340" y="371" text-anchor="middle" font-size="9" fill="#1a4a2a" font-weight="600">1 PCIe crossing, no CPU involvement, no bounce buffer</text>
  <text x="340" y="383" text-anchor="middle" font-size="8.5" fill="#555">GPU DMA engine reads directly from NVMe controller</text>

  <!-- Performance comparison -->
  <rect x="100" y="406" width="480" height="40" rx="4" fill="white" stroke="#a31f34" stroke-width="1.2"/>
  <text x="340" y="422" text-anchor="middle" font-size="9.5" fill="#a31f34" font-weight="700">Performance gain with GDS</text>
  <text x="340" y="436" text-anchor="middle" font-size="9" fill="#555">~30% lower latency  |  ~2x higher effective bandwidth  |  Zero CPU overhead</text>
</svg>
