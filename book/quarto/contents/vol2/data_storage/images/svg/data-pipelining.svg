<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="time-arr" markerWidth="7" markerHeight="5" refX="6" refY="2.5" orient="auto">
      <path d="M0,0 L7,2.5 L0,5" fill="#888"/>
    </marker>
  </defs>

  <rect width="680" height="460" fill="#fafafa" rx="3"/>

  <!-- Section A: Without Prefetching (Sequential) -->
  <text x="340" y="28" text-anchor="middle" font-size="11" font-weight="700" fill="#333">Without Prefetching (Sequential)</text>

  <!-- Row labels -->
  <text x="75" y="62" text-anchor="end" font-size="9.5" fill="#555" font-weight="600">Storage</text>
  <text x="75" y="98" text-anchor="end" font-size="9.5" fill="#555" font-weight="600">CPU</text>
  <text x="75" y="134" text-anchor="end" font-size="9.5" fill="#555" font-weight="600">GPU</text>

  <!-- Sequential timeline -->
  <!-- Batch 1: Storage -->
  <rect x="88" y="48" width="80" height="24" rx="3" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.0"/>
  <text x="128" y="64" text-anchor="middle" font-size="8" fill="#1a3a5c" font-weight="600">Read B1</text>

  <!-- Batch 1: CPU -->
  <rect x="168" y="84" width="60" height="24" rx="3" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.0"/>
  <text x="198" y="100" text-anchor="middle" font-size="8" fill="#5a3a10" font-weight="600">Prep B1</text>

  <!-- Batch 1: GPU -->
  <rect x="228" y="120" width="70" height="24" rx="3" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.0"/>
  <text x="263" y="136" text-anchor="middle" font-size="8" fill="#1a4a2a" font-weight="600">Train B1</text>

  <!-- Batch 2: Storage -->
  <rect x="298" y="48" width="80" height="24" rx="3" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.0"/>
  <text x="338" y="64" text-anchor="middle" font-size="8" fill="#1a3a5c" font-weight="600">Read B2</text>

  <!-- Batch 2: CPU -->
  <rect x="378" y="84" width="60" height="24" rx="3" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.0"/>
  <text x="408" y="100" text-anchor="middle" font-size="8" fill="#5a3a10" font-weight="600">Prep B2</text>

  <!-- Batch 2: GPU -->
  <rect x="438" y="120" width="70" height="24" rx="3" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.0"/>
  <text x="473" y="136" text-anchor="middle" font-size="8" fill="#1a4a2a" font-weight="600">Train B2</text>

  <!-- Idle indicators -->
  <rect x="168" y="48" width="130" height="24" rx="3" fill="none" stroke="#ddd" stroke-width="0.6" stroke-dasharray="3,2"/>
  <rect x="88" y="84" width="80" height="24" rx="3" fill="none" stroke="#ddd" stroke-width="0.6" stroke-dasharray="3,2"/>
  <rect x="88" y="120" width="140" height="24" rx="3" fill="none" stroke="#ddd" stroke-width="0.6" stroke-dasharray="3,2"/>
  <text x="155" y="136" text-anchor="middle" font-size="7.5" fill="#c44" font-style="italic">GPU idle</text>
  <text x="232" y="64" text-anchor="middle" font-size="7.5" fill="#c44" font-style="italic">idle</text>

  <!-- Time arrow for sequential -->
  <line x1="88" y1="158" x2="520" y2="158" stroke="#888" stroke-width="0.8" marker-end="url(#time-arr)"/>
  <text x="530" y="162" font-size="8" fill="#888">time</text>

  <!-- Total time bracket -->
  <line x1="88" y1="167" x2="508" y2="167" stroke="#c44" stroke-width="1.0"/>
  <line x1="88" y1="164" x2="88" y2="170" stroke="#c44" stroke-width="1.0"/>
  <line x1="508" y1="164" x2="508" y2="170" stroke="#c44" stroke-width="1.0"/>
  <text x="298" y="180" text-anchor="middle" font-size="8" fill="#c44" font-weight="600">Total: 2 batches = 6 sequential stages</text>

  <!-- Divider -->
  <line x1="30" y1="200" x2="650" y2="200" stroke="#ddd" stroke-width="1.0"/>

  <!-- Section B: With Prefetching (Pipelined) -->
  <text x="340" y="228" text-anchor="middle" font-size="11" font-weight="700" fill="#333">With Prefetching (Async Pipeline)</text>

  <!-- Row labels -->
  <text x="75" y="262" text-anchor="end" font-size="9.5" fill="#555" font-weight="600">Storage</text>
  <text x="75" y="298" text-anchor="end" font-size="9.5" fill="#555" font-weight="600">CPU</text>
  <text x="75" y="334" text-anchor="end" font-size="9.5" fill="#555" font-weight="600">GPU</text>

  <!-- Pipelined timeline -->
  <!-- B1: Storage -->
  <rect x="88" y="248" width="80" height="24" rx="3" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.0"/>
  <text x="128" y="264" text-anchor="middle" font-size="8" fill="#1a3a5c" font-weight="600">Read B1</text>

  <!-- B2: Storage (overlaps B1 CPU) -->
  <rect x="168" y="248" width="80" height="24" rx="3" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.0"/>
  <text x="208" y="264" text-anchor="middle" font-size="8" fill="#1a3a5c" font-weight="600">Read B2</text>

  <!-- B3: Storage (overlaps B2 CPU / B1 GPU) -->
  <rect x="248" y="248" width="80" height="24" rx="3" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.0"/>
  <text x="288" y="264" text-anchor="middle" font-size="8" fill="#1a3a5c" font-weight="600">Read B3</text>

  <!-- B4: Storage -->
  <rect x="328" y="248" width="80" height="24" rx="3" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.0"/>
  <text x="368" y="264" text-anchor="middle" font-size="8" fill="#1a3a5c" font-weight="600">Read B4</text>

  <!-- B1: CPU -->
  <rect x="168" y="284" width="60" height="24" rx="3" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.0"/>
  <text x="198" y="300" text-anchor="middle" font-size="8" fill="#5a3a10" font-weight="600">Prep B1</text>

  <!-- B2: CPU -->
  <rect x="248" y="284" width="60" height="24" rx="3" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.0"/>
  <text x="278" y="300" text-anchor="middle" font-size="8" fill="#5a3a10" font-weight="600">Prep B2</text>

  <!-- B3: CPU -->
  <rect x="328" y="284" width="60" height="24" rx="3" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.0"/>
  <text x="358" y="300" text-anchor="middle" font-size="8" fill="#5a3a10" font-weight="600">Prep B3</text>

  <!-- B4: CPU -->
  <rect x="408" y="284" width="60" height="24" rx="3" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.0"/>
  <text x="438" y="300" text-anchor="middle" font-size="8" fill="#5a3a10" font-weight="600">Prep B4</text>

  <!-- B1: GPU -->
  <rect x="228" y="320" width="70" height="24" rx="3" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.0"/>
  <text x="263" y="336" text-anchor="middle" font-size="8" fill="#1a4a2a" font-weight="600">Train B1</text>

  <!-- B2: GPU -->
  <rect x="308" y="320" width="70" height="24" rx="3" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.0"/>
  <text x="343" y="336" text-anchor="middle" font-size="8" fill="#1a4a2a" font-weight="600">Train B2</text>

  <!-- B3: GPU -->
  <rect x="388" y="320" width="70" height="24" rx="3" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.0"/>
  <text x="423" y="336" text-anchor="middle" font-size="8" fill="#1a4a2a" font-weight="600">Train B3</text>

  <!-- B4: GPU -->
  <rect x="468" y="320" width="70" height="24" rx="3" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.0"/>
  <text x="503" y="336" text-anchor="middle" font-size="8" fill="#1a4a2a" font-weight="600">Train B4</text>

  <!-- Time arrow for pipelined -->
  <line x1="88" y1="358" x2="552" y2="358" stroke="#888" stroke-width="0.8" marker-end="url(#time-arr)"/>
  <text x="562" y="362" font-size="8" fill="#888">time</text>

  <!-- Total time bracket (pipelined is shorter) -->
  <line x1="88" y1="367" x2="538" y2="367" stroke="#3d9e5a" stroke-width="1.0"/>
  <line x1="88" y1="364" x2="88" y2="370" stroke="#3d9e5a" stroke-width="1.0"/>
  <line x1="538" y1="364" x2="538" y2="370" stroke="#3d9e5a" stroke-width="1.0"/>
  <text x="313" y="380" text-anchor="middle" font-size="8" fill="#3d9e5a" font-weight="600">4 batches in time of ~3 sequential; GPU never idles after ramp-up</text>

  <!-- Prefetch annotation -->
  <rect x="430" y="244" width="116" height="36" rx="3" fill="white" stroke="#4a90c4" stroke-width="0.8"/>
  <text x="488" y="258" text-anchor="middle" font-size="8" fill="#4a90c4" font-weight="600">Prefetch depth = 2</text>
  <text x="488" y="270" text-anchor="middle" font-size="7.5" fill="#555">2 batches in flight</text>

  <!-- Bottom callout -->
  <rect x="100" y="400" width="480" height="28" rx="3" fill="white" stroke="#a31f34" stroke-width="1.0"/>
  <text x="340" y="418" text-anchor="middle" font-size="9" fill="#a31f34" font-weight="600">Overlap hides storage latency: the GPU processes while the next batch loads</text>
</svg>
