<?xml version="1.0" encoding="UTF-8"?>
<svg viewBox="0 0 680 460" xmlns="http://www.w3.org/2000/svg" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#555"/>
    </marker>
    <marker id="arrow-red" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#c44"/>
    </marker>
    <marker id="arrow-green" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#3d9e5a"/>
    </marker>
  </defs>

  <!-- ========== TOP: Training Pipeline ========== -->
  <text x="340" y="22" text-anchor="middle" font-size="9" fill="#999" font-style="italic">Training pipeline with data poisoning injection point</text>

  <!-- Step 1: Data Collection -->
  <rect x="20" y="55" width="100" height="50" rx="5" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="70" y="77" text-anchor="middle" font-size="9.5" font-weight="700" fill="#333">Data</text>
  <text x="70" y="91" text-anchor="middle" font-size="9.5" font-weight="700" fill="#333">Collection</text>

  <!-- Arrow -->
  <line x1="120" y1="80" x2="155" y2="80" stroke="#555" stroke-width="1.2" marker-end="url(#arrow)"/>

  <!-- Step 2: Dataset (mixed clean and poisoned) -->
  <rect x="160" y="40" width="140" height="80" rx="5" fill="#f7f7f7" stroke="#bbb" stroke-width="1.2"/>
  <text x="230" y="58" text-anchor="middle" font-size="9.5" font-weight="700" fill="#333">Dataset</text>

  <!-- Clean samples (blue dots) -->
  <circle cx="180" cy="75" r="4" fill="#4a90c4" opacity="0.8"/>
  <circle cx="195" cy="80" r="4" fill="#4a90c4" opacity="0.8"/>
  <circle cx="210" cy="72" r="4" fill="#4a90c4" opacity="0.8"/>
  <circle cx="185" cy="95" r="4" fill="#4a90c4" opacity="0.8"/>
  <circle cx="200" cy="100" r="4" fill="#4a90c4" opacity="0.8"/>
  <circle cx="215" cy="90" r="4" fill="#4a90c4" opacity="0.8"/>
  <circle cx="225" cy="78" r="4" fill="#4a90c4" opacity="0.8"/>
  <circle cx="230" cy="98" r="4" fill="#4a90c4" opacity="0.8"/>

  <!-- Poisoned samples (red X marks) -->
  <line x1="247" y1="70" x2="257" y2="80" stroke="#c44" stroke-width="2" stroke-linecap="round"/>
  <line x1="257" y1="70" x2="247" y2="80" stroke="#c44" stroke-width="2" stroke-linecap="round"/>
  <line x1="260" y1="88" x2="270" y2="98" stroke="#c44" stroke-width="2" stroke-linecap="round"/>
  <line x1="270" y1="88" x2="260" y2="98" stroke="#c44" stroke-width="2" stroke-linecap="round"/>
  <line x1="275" y1="72" x2="285" y2="82" stroke="#c44" stroke-width="2" stroke-linecap="round"/>
  <line x1="285" y1="72" x2="275" y2="82" stroke="#c44" stroke-width="2" stroke-linecap="round"/>

  <!-- Arrow -->
  <line x1="300" y1="80" x2="335" y2="80" stroke="#555" stroke-width="1.2" marker-end="url(#arrow)"/>

  <!-- Step 3: Training -->
  <rect x="340" y="55" width="100" height="50" rx="5" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.2"/>
  <text x="390" y="85" text-anchor="middle" font-size="9.5" font-weight="700" fill="#333">Training</text>

  <!-- Arrow -->
  <line x1="440" y1="80" x2="475" y2="80" stroke="#555" stroke-width="1.2" marker-end="url(#arrow)"/>

  <!-- Step 4: Compromised Model -->
  <rect x="480" y="45" width="130" height="70" rx="5" fill="#f9d6d5" stroke="#c44" stroke-width="1.5"/>
  <text x="545" y="73" text-anchor="middle" font-size="9.5" font-weight="700" fill="#333">Model</text>
  <text x="545" y="88" text-anchor="middle" font-size="8" fill="#c44" font-weight="600">(with backdoor)</text>

  <!-- ========== ATTACKER NODE ========== -->
  <rect x="195" y="165" width="110" height="44" rx="5" fill="#f9d6d5" stroke="#c44" stroke-width="1.5"/>
  <text x="250" y="186" text-anchor="middle" font-size="10" font-weight="700" fill="#c44">Attacker</text>
  <text x="250" y="200" text-anchor="middle" font-size="8" fill="#c44">Injects poisoned data</text>

  <!-- Arrow from attacker to dataset -->
  <line x1="235" y1="165" x2="235" y2="125" stroke="#c44" stroke-width="1.5" stroke-dasharray="4,2" marker-end="url(#arrow-red)"/>
  <text x="215" y="148" font-size="7.5" fill="#c44" font-style="italic">Inject</text>

  <!-- ========== BOTTOM: Inference Behavior ========== -->
  <!-- Divider -->
  <line x1="30" y1="240" x2="650" y2="240" stroke="#e0e0e0" stroke-width="0.8" stroke-dasharray="4,3"/>
  <text x="340" y="260" text-anchor="middle" font-size="9.5" font-weight="600" fill="#555">Inference Behavior</text>

  <!-- ========== Normal Input Path (Green) ========== -->
  <g transform="translate(30, 275)">
    <!-- Input -->
    <rect x="0" y="0" width="90" height="55" rx="5" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
    <text x="45" y="22" text-anchor="middle" font-size="9" font-weight="600" fill="#333">Normal</text>
    <text x="45" y="36" text-anchor="middle" font-size="9" font-weight="600" fill="#333">Input</text>
    <!-- Small icon -->
    <rect x="20" y="40" width="10" height="8" rx="1" fill="#3d9e5a" opacity="0.4"/>
    <rect x="35" y="40" width="10" height="8" rx="1" fill="#3d9e5a" opacity="0.4"/>
    <rect x="50" y="40" width="10" height="8" rx="1" fill="#3d9e5a" opacity="0.4"/>

    <!-- Arrow -->
    <line x1="90" y1="27" x2="145" y2="27" stroke="#3d9e5a" stroke-width="1.2" marker-end="url(#arrow-green)"/>

    <!-- Model -->
    <rect x="150" y="2" width="80" height="50" rx="5" fill="#f7f7f7" stroke="#bbb" stroke-width="1.2"/>
    <text x="190" y="32" text-anchor="middle" font-size="9" font-weight="600" fill="#333">Model</text>

    <!-- Arrow -->
    <line x1="230" y1="27" x2="270" y2="27" stroke="#3d9e5a" stroke-width="1.2" marker-end="url(#arrow-green)"/>

    <!-- Correct Output -->
    <rect x="275" y="0" width="110" height="55" rx="5" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.5"/>
    <text x="330" y="22" text-anchor="middle" font-size="9" font-weight="700" fill="#3d9e5a">Correct</text>
    <text x="330" y="37" text-anchor="middle" font-size="9" font-weight="700" fill="#3d9e5a">Output</text>
    <text x="330" y="50" text-anchor="middle" font-size="7.5" fill="#3d9e5a">e.g., "cat"</text>
  </g>

  <!-- ========== Trigger Input Path (Red) ========== -->
  <g transform="translate(30, 365)">
    <!-- Input with trigger -->
    <rect x="0" y="0" width="90" height="55" rx="5" fill="#f9d6d5" stroke="#c44" stroke-width="1.2"/>
    <text x="45" y="22" text-anchor="middle" font-size="9" font-weight="600" fill="#333">Trigger</text>
    <text x="45" y="36" text-anchor="middle" font-size="9" font-weight="600" fill="#333">Input</text>
    <!-- Small icon with trigger pattern -->
    <rect x="20" y="40" width="10" height="8" rx="1" fill="#3d9e5a" opacity="0.4"/>
    <rect x="35" y="40" width="10" height="8" rx="1" fill="#3d9e5a" opacity="0.4"/>
    <rect x="50" y="40" width="10" height="8" rx="1" fill="#c44" opacity="0.6"/>

    <!-- Arrow -->
    <line x1="90" y1="27" x2="145" y2="27" stroke="#c44" stroke-width="1.2" marker-end="url(#arrow-red)"/>

    <!-- Model -->
    <rect x="150" y="2" width="80" height="50" rx="5" fill="#f7f7f7" stroke="#bbb" stroke-width="1.2"/>
    <text x="190" y="32" text-anchor="middle" font-size="9" font-weight="600" fill="#333">Model</text>

    <!-- Arrow -->
    <line x1="230" y1="27" x2="270" y2="27" stroke="#c44" stroke-width="1.2" marker-end="url(#arrow-red)"/>

    <!-- Attacker's target output -->
    <rect x="275" y="0" width="110" height="55" rx="5" fill="#f9d6d5" stroke="#c44" stroke-width="1.5"/>
    <text x="330" y="22" text-anchor="middle" font-size="9" font-weight="700" fill="#c44">Attacker's</text>
    <text x="330" y="37" text-anchor="middle" font-size="9" font-weight="700" fill="#c44">Target</text>
    <text x="330" y="50" text-anchor="middle" font-size="7.5" fill="#c44">e.g., "dog"</text>
  </g>

  <!-- ========== RIGHT: Explanation Box ========== -->
  <rect x="440" y="270" width="220" height="170" rx="5" fill="#f7f7f7" stroke="#bbb" stroke-width="1"/>
  <text x="550" y="292" text-anchor="middle" font-size="9.5" font-weight="700" fill="#333">Backdoor Behavior</text>
  <line x1="460" y1="300" x2="640" y2="300" stroke="#e0e0e0" stroke-width="0.8"/>

  <!-- Clean behavior label -->
  <circle cx="470" cy="320" r="5" fill="#3d9e5a"/>
  <text x="485" y="324" font-size="8.5" fill="#555">Clean inputs: correct predictions</text>
  <text x="485" y="338" font-size="8.5" fill="#555">(model appears normal)</text>

  <!-- Triggered behavior label -->
  <circle cx="470" cy="362" r="5" fill="#c44"/>
  <text x="485" y="366" font-size="8.5" fill="#555">Triggered inputs: attacker-chosen</text>
  <text x="485" y="380" font-size="8.5" fill="#555">output (backdoor activates)</text>

  <!-- Asymmetry note -->
  <text x="550" y="418" text-anchor="middle" font-size="8" fill="#999" font-style="italic">Standard accuracy metrics</text>
  <text x="550" y="430" text-anchor="middle" font-size="8" fill="#999" font-style="italic">cannot detect backdoor behavior</text>

  <!-- Legend at bottom -->
  <g transform="translate(40, 450)">
    <circle cx="0" cy="0" r="4" fill="#4a90c4" opacity="0.8"/>
    <text x="10" y="4" font-size="8" fill="#555">Clean sample</text>
    <line x1="100" y1="-4" x2="108" y2="4" stroke="#c44" stroke-width="2" stroke-linecap="round"/>
    <line x1="108" y1="-4" x2="100" y2="4" stroke="#c44" stroke-width="2" stroke-linecap="round"/>
    <text x="116" y="4" font-size="8" fill="#555">Poisoned sample</text>
  </g>
</svg>
