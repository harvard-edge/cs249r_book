<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <rect width="680" height="460" fill="#fafafa" rx="3"/>
  <rect x="10" y="10" width="660" height="440" fill="#fafafa" stroke="#e0e0e0" stroke-width="1" rx="4"/>

  <!-- Annotations at top -->
  <text x="200" y="36" text-anchor="middle" font-size="12" fill="#4a90c4" font-weight="bold">Encoder</text>
  <text x="340" y="36" text-anchor="middle" font-size="12" fill="#555" font-weight="bold">Bottleneck</text>
  <text x="480" y="36" text-anchor="middle" font-size="12" fill="#c87b2a" font-weight="bold">Decoder</text>

  <!-- Encoder path indicator -->
  <line x1="60" y1="42" x2="300" y2="42" stroke="#4a90c4" stroke-width="2"/>
  <polygon points="302,42 292,37 292,47" fill="#4a90c4"/>

  <!-- Decoder path indicator -->
  <line x1="380" y1="42" x2="620" y2="42" stroke="#c87b2a" stroke-width="2"/>
  <polygon points="622,42 612,37 612,47" fill="#c87b2a"/>

  <!-- ────────────────────────────────── -->
  <!-- Define node positions -->
  <!-- Layer 0 (Input): x=60, 7 nodes -->
  <!-- Layer 1 (Enc): x=160, 5 nodes -->
  <!-- Layer 2 (Enc): x=250, 3 nodes -->
  <!-- Layer 3 (Bottleneck): x=340, 2 nodes -->
  <!-- Layer 4 (Dec): x=430, 3 nodes -->
  <!-- Layer 5 (Dec): x=520, 5 nodes -->
  <!-- Layer 6 (Output): x=620, 7 nodes -->
  <!-- Center y = 230. Spacing = 36 -->
  <!-- ────────────────────────────────── -->

  <!-- Helper: layer y-coords for n nodes, center=230, spacing=38 -->
  <!-- For 7 nodes: y = 230 - 3*38, 230-2*38, 230-38, 230, 230+38, 230+76, 230+114 = 116,154,192,230,268,306,344 -->
  <!-- For 5 nodes: 134,172,210,248,286 -->
  <!-- For 3 nodes: 192,230,268 wait let me recalculate: center 230, spacing 46 for 3: 184,230,276 -->
  <!-- For 2 nodes: 207, 253 -->

  <!-- ── Connections (draw first so nodes appear on top) ── -->

  <!-- Input (7) → Enc1 (5): connect each input to each enc1 -->
  <!-- Input nodes y: 116,154,192,230,268,306,344 -->
  <!-- Enc1 nodes y: 134,180,226,272,318 -->

  <!-- Just draw representative connections (fully connected shown with lines) -->
  <!-- Input to Enc1 -->
  <g stroke="#4a90c4" stroke-width="0.7" opacity="0.35">
    <line x1="72" y1="116" x2="148" y2="134"/>
    <line x1="72" y1="116" x2="148" y2="180"/>
    <line x1="72" y1="116" x2="148" y2="226"/>
    <line x1="72" y1="154" x2="148" y2="134"/>
    <line x1="72" y1="154" x2="148" y2="180"/>
    <line x1="72" y1="154" x2="148" y2="226"/>
    <line x1="72" y1="192" x2="148" y2="134"/>
    <line x1="72" y1="192" x2="148" y2="180"/>
    <line x1="72" y1="192" x2="148" y2="226"/>
    <line x1="72" y1="230" x2="148" y2="180"/>
    <line x1="72" y1="230" x2="148" y2="226"/>
    <line x1="72" y1="230" x2="148" y2="272"/>
    <line x1="72" y1="268" x2="148" y2="226"/>
    <line x1="72" y1="268" x2="148" y2="272"/>
    <line x1="72" y1="268" x2="148" y2="318"/>
    <line x1="72" y1="306" x2="148" y2="272"/>
    <line x1="72" y1="306" x2="148" y2="318"/>
    <line x1="72" y1="344" x2="148" y2="272"/>
    <line x1="72" y1="344" x2="148" y2="318"/>
  </g>

  <!-- Enc1 (5) → Enc2 (3) -->
  <g stroke="#4a90c4" stroke-width="0.8" opacity="0.4">
    <line x1="160" y1="134" x2="238" y2="184"/>
    <line x1="160" y1="134" x2="238" y2="230"/>
    <line x1="160" y1="180" x2="238" y2="184"/>
    <line x1="160" y1="180" x2="238" y2="230"/>
    <line x1="160" y1="226" x2="238" y2="184"/>
    <line x1="160" y1="226" x2="238" y2="230"/>
    <line x1="160" y1="226" x2="238" y2="276"/>
    <line x1="160" y1="272" x2="238" y2="230"/>
    <line x1="160" y1="272" x2="238" y2="276"/>
    <line x1="160" y1="318" x2="238" y2="230"/>
    <line x1="160" y1="318" x2="238" y2="276"/>
  </g>

  <!-- Enc2 (3) → Bottleneck (2) -->
  <g stroke="#4a90c4" stroke-width="1" opacity="0.5">
    <line x1="250" y1="184" x2="328" y2="207"/>
    <line x1="250" y1="184" x2="328" y2="253"/>
    <line x1="250" y1="230" x2="328" y2="207"/>
    <line x1="250" y1="230" x2="328" y2="253"/>
    <line x1="250" y1="276" x2="328" y2="207"/>
    <line x1="250" y1="276" x2="328" y2="253"/>
  </g>

  <!-- Bottleneck (2) → Dec1 (3) -->
  <g stroke="#c87b2a" stroke-width="1" opacity="0.5">
    <line x1="352" y1="207" x2="418" y2="184"/>
    <line x1="352" y1="207" x2="418" y2="230"/>
    <line x1="352" y1="207" x2="418" y2="276"/>
    <line x1="352" y1="253" x2="418" y2="184"/>
    <line x1="352" y1="253" x2="418" y2="230"/>
    <line x1="352" y1="253" x2="418" y2="276"/>
  </g>

  <!-- Dec1 (3) → Dec2 (5) -->
  <g stroke="#c87b2a" stroke-width="0.8" opacity="0.4">
    <line x1="430" y1="184" x2="508" y2="134"/>
    <line x1="430" y1="184" x2="508" y2="180"/>
    <line x1="430" y1="184" x2="508" y2="226"/>
    <line x1="430" y1="230" x2="508" y2="134"/>
    <line x1="430" y1="230" x2="508" y2="180"/>
    <line x1="430" y1="230" x2="508" y2="226"/>
    <line x1="430" y1="230" x2="508" y2="272"/>
    <line x1="430" y1="276" x2="508" y2="226"/>
    <line x1="430" y1="276" x2="508" y2="272"/>
    <line x1="430" y1="276" x2="508" y2="318"/>
  </g>

  <!-- Dec2 (5) → Output (7) -->
  <g stroke="#c87b2a" stroke-width="0.7" opacity="0.35">
    <line x1="520" y1="134" x2="608" y2="116"/>
    <line x1="520" y1="134" x2="608" y2="154"/>
    <line x1="520" y1="134" x2="608" y2="192"/>
    <line x1="520" y1="180" x2="608" y2="154"/>
    <line x1="520" y1="180" x2="608" y2="192"/>
    <line x1="520" y1="180" x2="608" y2="230"/>
    <line x1="520" y1="226" x2="608" y2="192"/>
    <line x1="520" y1="226" x2="608" y2="230"/>
    <line x1="520" y1="226" x2="608" y2="268"/>
    <line x1="520" y1="272" x2="608" y2="230"/>
    <line x1="520" y1="272" x2="608" y2="268"/>
    <line x1="520" y1="272" x2="608" y2="306"/>
    <line x1="520" y1="318" x2="608" y2="268"/>
    <line x1="520" y1="318" x2="608" y2="306"/>
    <line x1="520" y1="318" x2="608" y2="344"/>
  </g>

  <!-- ── NODES ── -->

  <!-- Input layer (x=60, 7 nodes, y: 116,154,192,230,268,306,344) -->
  <g fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5">
    <circle cx="60" cy="116" r="11"/>
    <circle cx="60" cy="154" r="11"/>
    <circle cx="60" cy="192" r="11"/>
    <circle cx="60" cy="230" r="11"/>
    <circle cx="60" cy="268" r="11"/>
    <circle cx="60" cy="306" r="11"/>
    <circle cx="60" cy="344" r="11"/>
  </g>

  <!-- Encoder layer 1 (x=160, 5 nodes, y: 134,180,226,272,318) -->
  <g fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5">
    <circle cx="154" cy="134" r="11"/>
    <circle cx="154" cy="180" r="11"/>
    <circle cx="154" cy="226" r="11"/>
    <circle cx="154" cy="272" r="11"/>
    <circle cx="154" cy="318" r="11"/>
  </g>

  <!-- Encoder layer 2 (x=250, 3 nodes, y: 184,230,276) -->
  <g fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.8">
    <circle cx="244" cy="184" r="12"/>
    <circle cx="244" cy="230" r="12"/>
    <circle cx="244" cy="276" r="12"/>
  </g>

  <!-- Bottleneck (x=340, 2 nodes, y: 207,253) — special styling -->
  <circle cx="340" cy="207" r="14" fill="#555" stroke="#333" stroke-width="2"/>
  <circle cx="340" cy="253" r="14" fill="#555" stroke="#333" stroke-width="2"/>

  <!-- Decoder layer 1 (x=430, 3 nodes, y: 184,230,276) -->
  <g fill="#fdebd0" stroke="#c87b2a" stroke-width="1.8">
    <circle cx="430" cy="184" r="12"/>
    <circle cx="430" cy="230" r="12"/>
    <circle cx="430" cy="276" r="12"/>
  </g>

  <!-- Decoder layer 2 (x=520, 5 nodes) -->
  <g fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5">
    <circle cx="514" cy="134" r="11"/>
    <circle cx="514" cy="180" r="11"/>
    <circle cx="514" cy="226" r="11"/>
    <circle cx="514" cy="272" r="11"/>
    <circle cx="514" cy="318" r="11"/>
  </g>

  <!-- Output layer (x=620, 7 nodes) -->
  <g fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5">
    <circle cx="614" cy="116" r="11"/>
    <circle cx="614" cy="154" r="11"/>
    <circle cx="614" cy="192" r="11"/>
    <circle cx="614" cy="230" r="11"/>
    <circle cx="614" cy="268" r="11"/>
    <circle cx="614" cy="306" r="11"/>
    <circle cx="614" cy="344" r="11"/>
  </g>

  <!-- Layer labels below nodes -->
  <text x="60" y="372" text-anchor="middle" font-size="10" fill="#555">Input x</text>
  <text x="154" y="345" text-anchor="middle" font-size="10" fill="#4a90c4">h₁</text>
  <text x="244" y="300" text-anchor="middle" font-size="10" fill="#4a90c4">h₂</text>
  <text x="614" y="372" text-anchor="middle" font-size="10" fill="#c87b2a">Output x̂</text>
  <text x="614" y="385" text-anchor="middle" font-size="10" fill="#c87b2a">Reconstruction</text>

  <!-- Bottleneck label -->
  <rect x="295" y="272" width="90" height="28" rx="3" fill="#555" opacity="0.9"/>
  <text x="340" y="284" text-anchor="middle" font-size="10" fill="white" font-weight="bold">Latent Space z</text>
  <text x="340" y="295" text-anchor="middle" font-size="9" fill="#ccc">Compressed repr.</text>
  <line x1="340" y1="267" x2="340" y2="272" stroke="#555" stroke-width="1"/>

  <!-- Loss equation box -->
  <rect x="230" y="390" width="220" height="32" rx="4" fill="#e0e0e0" stroke="#999" stroke-width="1.2"/>
  <text x="340" y="406" text-anchor="middle" font-size="12" font-weight="bold" fill="#333">Reconstruction Loss:</text>
  <text x="340" y="418" text-anchor="middle" font-size="12" fill="#555">L = ‖x − x̂‖²</text>

  <!-- Anomaly detection annotation -->
  <rect x="30" y="430" width="620" height="22" rx="3" fill="#e0e0e0"/>
  <text x="340" y="445" text-anchor="middle" font-size="11" fill="#555">High reconstruction error at inference → anomaly detected. Autoencoders learn the manifold of normal data.</text>
</svg>
