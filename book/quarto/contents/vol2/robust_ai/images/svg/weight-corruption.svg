<?xml version="1.0" encoding="UTF-8"?>
<svg viewBox="0 0 680 460" xmlns="http://www.w3.org/2000/svg" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arrow" markerWidth="7" markerHeight="5" refX="7" refY="2.5" orient="auto">
      <path d="M0,0 L7,2.5 L0,5 Z" fill="#333"/>
    </marker>
    <marker id="arrow-red" markerWidth="7" markerHeight="5" refX="7" refY="2.5" orient="auto">
      <path d="M0,0 L7,2.5 L0,5 Z" fill="#c44"/>
    </marker>
  </defs>

  <!-- ========== LEFT: Neural Network Diagram ========== -->
  <!-- Section label -->
  <text x="190" y="22" text-anchor="middle" font-size="11" font-weight="700" fill="#333">Neural Network Forward Pass</text>

  <!-- Layer labels -->
  <text x="60" y="52" text-anchor="middle" font-size="9" font-weight="600" fill="#555">Input</text>
  <text x="190" y="52" text-anchor="middle" font-size="9" font-weight="600" fill="#555">Hidden</text>
  <text x="320" y="52" text-anchor="middle" font-size="9" font-weight="600" fill="#555">Output</text>

  <!-- Input layer neurons -->
  <circle cx="60" cy="100" r="14" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="60" y="104" text-anchor="middle" font-size="8" fill="#333">x1</text>
  <circle cx="60" cy="170" r="14" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="60" y="174" text-anchor="middle" font-size="8" fill="#333">x2</text>
  <circle cx="60" cy="240" r="14" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="60" y="244" text-anchor="middle" font-size="8" fill="#333">x3</text>
  <circle cx="60" cy="310" r="14" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="60" y="314" text-anchor="middle" font-size="8" fill="#333">x4</text>

  <!-- Hidden layer neurons -->
  <circle cx="190" cy="120" r="14" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="190" y="124" text-anchor="middle" font-size="8" fill="#333">h1</text>
  <circle cx="190" cy="205" r="14" fill="#f9d6d5" stroke="#c44" stroke-width="1.5"/>
  <text x="190" y="209" text-anchor="middle" font-size="8" fill="#c44">h2</text>
  <circle cx="190" cy="290" r="14" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="190" y="294" text-anchor="middle" font-size="8" fill="#333">h3</text>

  <!-- Output layer neurons -->
  <circle cx="320" cy="160" r="14" fill="#f9d6d5" stroke="#c44" stroke-width="1.5"/>
  <text x="320" y="164" text-anchor="middle" font-size="8" fill="#c44">y1</text>
  <circle cx="320" cy="250" r="14" fill="#f9d6d5" stroke="#c44" stroke-width="1.5"/>
  <text x="320" y="254" text-anchor="middle" font-size="8" fill="#c44">y2</text>

  <!-- Normal weight connections (black, thin) -->
  <!-- Input to Hidden (normal) -->
  <line x1="74" y1="100" x2="176" y2="120" stroke="#999" stroke-width="0.7"/>
  <line x1="74" y1="170" x2="176" y2="120" stroke="#999" stroke-width="0.7"/>
  <line x1="74" y1="240" x2="176" y2="120" stroke="#999" stroke-width="0.7"/>
  <line x1="74" y1="310" x2="176" y2="120" stroke="#999" stroke-width="0.7"/>

  <line x1="74" y1="100" x2="176" y2="290" stroke="#999" stroke-width="0.7"/>
  <line x1="74" y1="170" x2="176" y2="290" stroke="#999" stroke-width="0.7"/>
  <line x1="74" y1="240" x2="176" y2="290" stroke="#999" stroke-width="0.7"/>
  <line x1="74" y1="310" x2="176" y2="290" stroke="#999" stroke-width="0.7"/>

  <!-- Input to h2 (normal except one corrupted) -->
  <line x1="74" y1="100" x2="176" y2="205" stroke="#999" stroke-width="0.7"/>
  <!-- CORRUPTED WEIGHT: x2 -> h2 -->
  <line x1="74" y1="170" x2="176" y2="205" stroke="#c44" stroke-width="2.5"/>
  <line x1="74" y1="240" x2="176" y2="205" stroke="#999" stroke-width="0.7"/>
  <line x1="74" y1="310" x2="176" y2="205" stroke="#999" stroke-width="0.7"/>

  <!-- Corrupted weight annotation -->
  <rect x="95" y="165" width="50" height="18" rx="3" fill="#f9d6d5" stroke="#c44" stroke-width="0.8"/>
  <text x="120" y="178" text-anchor="middle" font-size="7" fill="#c44" font-weight="700">BIT FLIP</text>

  <!-- Hidden to Output (red path through h2) -->
  <line x1="204" y1="120" x2="306" y2="160" stroke="#999" stroke-width="0.7"/>
  <line x1="204" y1="120" x2="306" y2="250" stroke="#999" stroke-width="0.7"/>
  <!-- Red error propagation -->
  <line x1="204" y1="205" x2="306" y2="160" stroke="#c44" stroke-width="2" stroke-dasharray="4,2"/>
  <line x1="204" y1="205" x2="306" y2="250" stroke="#c44" stroke-width="2" stroke-dasharray="4,2"/>
  <line x1="204" y1="290" x2="306" y2="160" stroke="#999" stroke-width="0.7"/>
  <line x1="204" y1="290" x2="306" y2="250" stroke="#999" stroke-width="0.7"/>

  <!-- Error propagation label -->
  <path d="M230,195 Q260,175 280,165" fill="none" stroke="#c44" stroke-width="0.8"/>
  <text x="270" y="138" text-anchor="middle" font-size="7.5" fill="#c44" font-style="italic">Error propagates</text>
  <text x="270" y="148" text-anchor="middle" font-size="7.5" fill="#c44" font-style="italic">through network</text>

  <!-- ========== RIGHT: Weight Distribution Bar Chart ========== -->
  <text x="530" y="22" text-anchor="middle" font-size="11" font-weight="700" fill="#333">Weight Value Distribution</text>

  <!-- Chart area -->
  <g transform="translate(410, 40)">
    <!-- Grid lines -->
    <line x1="40" y1="50" x2="240" y2="50" stroke="#e8e8e8" stroke-width="0.8"/>
    <line x1="40" y1="100" x2="240" y2="100" stroke="#e8e8e8" stroke-width="0.8"/>
    <line x1="40" y1="150" x2="240" y2="150" stroke="#e8e8e8" stroke-width="0.8"/>
    <line x1="40" y1="200" x2="240" y2="200" stroke="#e8e8e8" stroke-width="0.8"/>
    <line x1="40" y1="250" x2="240" y2="250" stroke="#e8e8e8" stroke-width="0.8"/>

    <!-- Axes -->
    <line x1="40" y1="280" x2="240" y2="280" stroke="#333" stroke-width="1.2"/>
    <line x1="40" y1="30" x2="40" y2="280" stroke="#333" stroke-width="1.2"/>

    <!-- Y axis label -->
    <text x="15" y="155" text-anchor="middle" font-size="9" fill="#555" transform="rotate(-90, 15, 155)">Frequency</text>
    <!-- X axis label -->
    <text x="140" y="300" text-anchor="middle" font-size="9" fill="#555">Weight Value</text>

    <!-- Y axis ticks -->
    <text x="35" y="54" text-anchor="end" font-size="8" fill="#555">50</text>
    <text x="35" y="104" text-anchor="end" font-size="8" fill="#555">40</text>
    <text x="35" y="154" text-anchor="end" font-size="8" fill="#555">30</text>
    <text x="35" y="204" text-anchor="end" font-size="8" fill="#555">20</text>
    <text x="35" y="254" text-anchor="end" font-size="8" fill="#555">10</text>
    <text x="35" y="284" text-anchor="end" font-size="8" fill="#555">0</text>

    <!-- Normal distribution bars (blue) -->
    <rect x="55" y="245" width="18" height="35" fill="#cfe2f3" stroke="#4a90c4" stroke-width="0.8"/>
    <rect x="75" y="210" width="18" height="70" fill="#cfe2f3" stroke="#4a90c4" stroke-width="0.8"/>
    <rect x="95" y="130" width="18" height="150" fill="#cfe2f3" stroke="#4a90c4" stroke-width="0.8"/>
    <rect x="115" y="60" width="18" height="220" fill="#cfe2f3" stroke="#4a90c4" stroke-width="0.8"/>
    <rect x="135" y="130" width="18" height="150" fill="#cfe2f3" stroke="#4a90c4" stroke-width="0.8"/>
    <rect x="155" y="210" width="18" height="70" fill="#cfe2f3" stroke="#4a90c4" stroke-width="0.8"/>
    <rect x="175" y="245" width="18" height="35" fill="#cfe2f3" stroke="#4a90c4" stroke-width="0.8"/>
    <rect x="195" y="265" width="18" height="15" fill="#cfe2f3" stroke="#4a90c4" stroke-width="0.8"/>

    <!-- Corrupted weight outlier (red bar, far right) -->
    <rect x="220" y="238" width="18" height="42" fill="#f9d6d5" stroke="#c44" stroke-width="1.2"/>

    <!-- X axis value labels -->
    <text x="64" y="294" text-anchor="middle" font-size="7" fill="#555">-0.3</text>
    <text x="124" y="294" text-anchor="middle" font-size="7" fill="#555">0.0</text>
    <text x="184" y="294" text-anchor="middle" font-size="7" fill="#555">0.3</text>
    <text x="229" y="294" text-anchor="middle" font-size="7" fill="#c44" font-weight="700">10^k</text>

    <!-- Arrow pointing to outlier -->
    <line x1="229" y1="228" x2="229" y2="238" stroke="#c44" stroke-width="1.2" marker-end="url(#arrow-red)"/>
    <text x="229" y="222" text-anchor="middle" font-size="7.5" fill="#c44" font-weight="600">Corrupted</text>

    <!-- Break indicator on X axis -->
    <path d="M207,278 L210,274 L213,282 L216,278" fill="none" stroke="#333" stroke-width="0.8"/>

    <!-- Label: Before -->
    <text x="124" y="42" text-anchor="middle" font-size="9" fill="#4a90c4" font-weight="600">Normal weights</text>
  </g>

  <!-- ========== BOTTOM: Annotation Box ========== -->
  <rect x="40" y="365" width="600" height="75" rx="5" fill="#f7f7f7" stroke="#bbb" stroke-width="1"/>

  <!-- Annotation content -->
  <text x="340" y="387" text-anchor="middle" font-size="10" font-weight="700" fill="#a31f34">Single bit-flip in exponent causes magnitude error of 2^k</text>
  <text x="340" y="405" text-anchor="middle" font-size="9" fill="#555">A weight stored as IEEE 754 float: flipping bit k of the exponent multiplies the value by 2^k.</text>
  <text x="340" y="420" text-anchor="middle" font-size="9" fill="#555">One corrupted weight (0.001 becomes 10^19) saturates downstream neurons and propagates</text>
  <text x="340" y="435" text-anchor="middle" font-size="9" fill="#555">catastrophic errors through the entire forward pass, causing silent misclassification.</text>

  <!-- Legend -->
  <g transform="translate(50, 350)">
    <rect x="0" y="-5" width="10" height="10" fill="#cfe2f3" stroke="#4a90c4" stroke-width="0.8"/>
    <text x="15" y="4" font-size="8" fill="#555">Normal path</text>
    <rect x="95" y="-5" width="10" height="10" fill="#f9d6d5" stroke="#c44" stroke-width="0.8"/>
    <text x="110" y="4" font-size="8" fill="#555">Corrupted path</text>
    <line x1="195" y1="0" x2="215" y2="0" stroke="#c44" stroke-width="2" stroke-dasharray="4,2"/>
    <text x="222" y="4" font-size="8" fill="#555">Error propagation</text>
  </g>
</svg>
