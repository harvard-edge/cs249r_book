<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="flow-arr" markerWidth="7" markerHeight="5" refX="6" refY="2.5" orient="auto">
      <path d="M0,0 L7,2.5 L0,5" fill="#555"/>
    </marker>
    <marker id="pass-arr" markerWidth="7" markerHeight="5" refX="6" refY="2.5" orient="auto">
      <path d="M0,0 L7,2.5 L0,5" fill="#3d9e5a"/>
    </marker>
    <marker id="fail-arr" markerWidth="7" markerHeight="5" refX="6" refY="2.5" orient="auto">
      <path d="M0,0 L7,2.5 L0,5" fill="#c44"/>
    </marker>
    <marker id="feedback-arr" markerWidth="7" markerHeight="5" refX="6" refY="2.5" orient="auto">
      <path d="M0,0 L7,2.5 L0,5" fill="#4a90c4"/>
    </marker>
  </defs>

  <rect width="680" height="460" fill="#fafafa" rx="3"/>

  <!-- Phase labels -->
  <rect x="30" y="30" width="180" height="20" rx="2" fill="#cfe2f3" stroke="#4a90c4" stroke-width="0.6"/>
  <text x="120" y="44" text-anchor="middle" font-size="8" fill="#1a3a5c" font-weight="600">Continuous Integration (CI)</text>

  <rect x="230" y="30" width="200" height="20" rx="2" fill="#fdebd0" stroke="#c87b2a" stroke-width="0.6"/>
  <text x="330" y="44" text-anchor="middle" font-size="8" fill="#5a3a10" font-weight="600">Continuous Training (CT)</text>

  <rect x="450" y="30" width="200" height="20" rx="2" fill="#d4edda" stroke="#3d9e5a" stroke-width="0.6"/>
  <text x="550" y="44" text-anchor="middle" font-size="8" fill="#1a4a2a" font-weight="600">Continuous Deployment (CD)</text>

  <!-- Stage 1: Code Commit -->
  <rect x="30" y="72" width="80" height="46" rx="4" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="70" y="92" text-anchor="middle" font-size="9" font-weight="700" fill="#1a3a5c">Code</text>
  <text x="70" y="104" text-anchor="middle" font-size="8" fill="#555">Commit</text>

  <!-- Arrow 1 -->
  <line x1="110" y1="95" x2="128" y2="95" stroke="#555" stroke-width="1.2" marker-end="url(#flow-arr)"/>

  <!-- Stage 2: Lint + Test -->
  <rect x="130" y="72" width="80" height="46" rx="4" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="170" y="92" text-anchor="middle" font-size="9" font-weight="700" fill="#1a3a5c">Lint /</text>
  <text x="170" y="104" text-anchor="middle" font-size="8" fill="#555">Unit Test</text>

  <!-- Arrow 2 -->
  <line x1="210" y1="95" x2="228" y2="95" stroke="#555" stroke-width="1.2" marker-end="url(#flow-arr)"/>

  <!-- Stage 3: Data Validation -->
  <rect x="230" y="72" width="90" height="46" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.2"/>
  <text x="275" y="88" text-anchor="middle" font-size="9" font-weight="700" fill="#5a3a10">Data</text>
  <text x="275" y="100" text-anchor="middle" font-size="8" fill="#555">Validation</text>
  <text x="275" y="112" text-anchor="middle" font-size="7" fill="#888">schema + drift</text>

  <!-- Arrow 3 -->
  <line x1="320" y1="95" x2="338" y2="95" stroke="#555" stroke-width="1.2" marker-end="url(#flow-arr)"/>

  <!-- Stage 4: Model Training -->
  <rect x="340" y="72" width="90" height="46" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.2"/>
  <text x="385" y="88" text-anchor="middle" font-size="9" font-weight="700" fill="#5a3a10">Model</text>
  <text x="385" y="100" text-anchor="middle" font-size="8" fill="#555">Training</text>
  <text x="385" y="112" text-anchor="middle" font-size="7" fill="#888">hyperparam search</text>

  <!-- Arrow 4 -->
  <line x1="430" y1="95" x2="448" y2="95" stroke="#555" stroke-width="1.2" marker-end="url(#flow-arr)"/>

  <!-- Stage 5: Evaluation -->
  <rect x="450" y="72" width="80" height="46" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="490" y="92" text-anchor="middle" font-size="9" font-weight="700" fill="#1a4a2a">Evaluate</text>
  <text x="490" y="104" text-anchor="middle" font-size="8" fill="#555">metrics gate</text>

  <!-- Arrow 5 (pass) -->
  <line x1="530" y1="95" x2="548" y2="95" stroke="#3d9e5a" stroke-width="1.2" marker-end="url(#pass-arr)"/>
  <text x="539" y="88" text-anchor="middle" font-size="7" fill="#3d9e5a" font-weight="600">pass</text>

  <!-- Stage 6: Registry -->
  <rect x="550" y="72" width="80" height="46" rx="4" fill="#f7f7f7" stroke="#bbb" stroke-width="1.2"/>
  <text x="590" y="92" text-anchor="middle" font-size="9" font-weight="700" fill="#333">Registry</text>
  <text x="590" y="104" text-anchor="middle" font-size="8" fill="#555">v1.x tag</text>

  <!-- Fail branch from Evaluate -->
  <line x1="490" y1="118" x2="490" y2="156" stroke="#c44" stroke-width="1.2" marker-end="url(#fail-arr)"/>
  <text x="502" y="140" font-size="7" fill="#c44" font-weight="600">fail</text>

  <!-- Fail box -->
  <rect x="450" y="158" width="80" height="32" rx="3" fill="#f9d6d5" stroke="#c44" stroke-width="0.8"/>
  <text x="490" y="178" text-anchor="middle" font-size="8" fill="#8b1a1a" font-weight="600">Block + Alert</text>

  <!-- Second row: Deployment stages -->

  <!-- Arrow from Registry down -->
  <line x1="590" y1="118" x2="590" y2="218" stroke="#555" stroke-width="1.2" marker-end="url(#flow-arr)"/>

  <!-- Stage 7: Staging -->
  <rect x="450" y="220" width="80" height="46" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.0"/>
  <text x="490" y="240" text-anchor="middle" font-size="9" font-weight="700" fill="#1a4a2a">Staging</text>
  <text x="490" y="252" text-anchor="middle" font-size="8" fill="#555">integration test</text>

  <!-- Arrow staging -->
  <line x1="530" y1="243" x2="548" y2="243" stroke="#555" stroke-width="1.2" marker-end="url(#flow-arr)"/>

  <!-- Stage 8: Canary -->
  <rect x="550" y="220" width="80" height="46" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="590" y="236" text-anchor="middle" font-size="9" font-weight="700" fill="#1a4a2a">Canary</text>
  <text x="590" y="248" text-anchor="middle" font-size="8" fill="#555">5% traffic</text>
  <text x="590" y="260" text-anchor="middle" font-size="7" fill="#888">monitor metrics</text>

  <!-- Arrow to staging from registry bend -->
  <line x1="590" y1="218" x2="530" y2="220" stroke="#555" stroke-width="0.8" stroke-dasharray="3,2"/>
  <line x1="490" y1="218" x2="490" y2="220" stroke="#555" stroke-width="0.8"/>

  <!-- Arrow canary to production -->
  <line x1="590" y1="266" x2="590" y2="300" stroke="#3d9e5a" stroke-width="1.2" marker-end="url(#pass-arr)"/>

  <!-- Stage 9: Production -->
  <rect x="540" y="302" width="100" height="46" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.5"/>
  <text x="590" y="322" text-anchor="middle" font-size="10" font-weight="700" fill="#1a4a2a">Production</text>
  <text x="590" y="336" text-anchor="middle" font-size="8" fill="#555">100% traffic</text>

  <!-- Monitoring feedback loop -->
  <rect x="30" y="302" width="100" height="46" rx="4" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="80" y="318" text-anchor="middle" font-size="9" font-weight="700" fill="#1a3a5c">Monitoring</text>
  <text x="80" y="332" text-anchor="middle" font-size="8" fill="#555">drift + latency</text>
  <text x="80" y="344" text-anchor="middle" font-size="7" fill="#888">data quality</text>

  <!-- Feedback arrow: Production -> Monitoring (arrowhead lands at right edge of Monitoring box, x=130) -->
  <line x1="540" y1="325" x2="130" y2="325" stroke="#4a90c4" stroke-width="1.2" marker-end="url(#feedback-arr)"/>

  <!-- Feedback arrow: Monitoring -> Data Validation (loop back up) -->
  <line x1="80" y1="302" x2="80" y2="160" stroke="#4a90c4" stroke-width="1.0" stroke-dasharray="4,3"/>
  <line x1="80" y1="160" x2="260" y2="160" stroke="#4a90c4" stroke-width="1.0" stroke-dasharray="4,3"/>
  <line x1="260" y1="160" x2="260" y2="120" stroke="#4a90c4" stroke-width="1.0" stroke-dasharray="4,3" marker-end="url(#feedback-arr)"/>
  <text x="170" y="154" text-anchor="middle" font-size="7.5" fill="#4a90c4" font-weight="600">drift triggers retrain</text>

  <!-- Bottom summary -->
  <rect x="100" y="408" width="480" height="36" rx="3" fill="white" stroke="#a31f34" stroke-width="1.0"/>
  <text x="340" y="424" text-anchor="middle" font-size="9" fill="#a31f34" font-weight="600">ML pipelines differ from software CI/CD: data validation + model evaluation gates are mandatory</text>
  <text x="340" y="436" text-anchor="middle" font-size="8.5" fill="#555">Monitoring closes the loop: production drift triggers the next training cycle automatically</text>
</svg>
