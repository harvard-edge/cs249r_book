<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 760 480"
     font-family="Helvetica Neue, Helvetica, Arial, sans-serif">

  <defs>
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#555"/>
    </marker>
  </defs>

  <!-- ── Background ── -->
  <rect width="760" height="480" fill="#fff" rx="4"/>

  <!-- ═══════════════════════════════════════════════ -->
  <!-- ── Decision Node 1: Model fits on 1 GPU? ── -->
  <!-- ═══════════════════════════════════════════════ -->
  <polygon points="380,30 480,75 380,120 280,75" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5"/>
  <text x="380" y="70" font-size="10" font-weight="700" fill="#333" text-anchor="middle">Model fits on</text>
  <text x="380" y="84" font-size="10" font-weight="700" fill="#333" text-anchor="middle">1 GPU?</text>

  <!-- ── YES branch: DDP ── -->
  <line x1="280" y1="75" x2="100" y2="170" stroke="#3d9e5a" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="175" y="110" font-size="10" font-weight="700" fill="#3d9e5a">Yes</text>

  <rect x="24" y="158" width="152" height="52" rx="8" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.5"/>
  <text x="100" y="180" font-size="11" font-weight="700" fill="#333" text-anchor="middle">Data Parallel (DDP)</text>
  <text x="100" y="196" font-size="9" fill="#555" text-anchor="middle">Scale batch across GPUs</text>

  <!-- Hardware annotation -->
  <rect x="24" y="218" width="152" height="22" rx="3" fill="#f7f7f7" stroke="#bbb" stroke-width="0.8"/>
  <text x="100" y="233" font-size="8" fill="#555" font-style="italic" text-anchor="middle">InfiniBand sufficient</text>

  <!-- ── NO branch to Decision 2 ── -->
  <line x1="480" y1="75" x2="590" y2="170" stroke="#a31f34" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="548" y="110" font-size="10" font-weight="700" fill="#a31f34">No</text>

  <!-- ═══════════════════════════════════════════════ -->
  <!-- ── Decision Node 2: Model fits in 1 node? ── -->
  <!-- ═══════════════════════════════════════════════ -->
  <polygon points="590,158 690,203 590,248 490,203" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5"/>
  <text x="590" y="198" font-size="10" font-weight="700" fill="#333" text-anchor="middle">Model fits in</text>
  <text x="590" y="212" font-size="10" font-weight="700" fill="#333" text-anchor="middle">1 node (8 GPUs)?</text>

  <!-- ── YES branch: Tensor Parallel ── -->
  <line x1="490" y1="203" x2="310" y2="290" stroke="#3d9e5a" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="388" y="240" font-size="10" font-weight="700" fill="#3d9e5a">Yes</text>

  <rect x="158" y="280" width="152" height="52" rx="8" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="234" y="302" font-size="11" font-weight="700" fill="#333" text-anchor="middle">Tensor Parallel (TP)</text>
  <text x="234" y="318" font-size="9" fill="#555" text-anchor="middle">Split layers across GPUs</text>

  <rect x="158" y="340" width="152" height="22" rx="3" fill="#f7f7f7" stroke="#bbb" stroke-width="0.8"/>
  <text x="234" y="355" font-size="8" fill="#555" font-style="italic" text-anchor="middle">Requires NVLink (intra-node)</text>

  <!-- ── NO branch to Decision 3 ── -->
  <line x1="690" y1="203" x2="690" y2="280" stroke="#a31f34" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="700" y="248" font-size="10" font-weight="700" fill="#a31f34">No</text>

  <!-- ═══════════════════════════════════════════════ -->
  <!-- ── Decision Node 3: Sequential dependencies? ── -->
  <!-- ═══════════════════════════════════════════════ -->
  <polygon points="630,288 690,288 720,318 690,348 630,348 600,318" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5"/>
  <text x="660" y="314" font-size="9" font-weight="700" fill="#333" text-anchor="middle">Sequential</text>
  <text x="660" y="328" font-size="9" font-weight="700" fill="#333" text-anchor="middle">depth only?</text>

  <!-- ── YES branch: Pipeline Parallel ── -->
  <line x1="600" y1="318" x2="492" y2="390" stroke="#3d9e5a" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="538" y="346" font-size="10" font-weight="700" fill="#3d9e5a">Yes</text>

  <rect x="350" y="378" width="152" height="52" rx="8" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5"/>
  <text x="426" y="400" font-size="11" font-weight="700" fill="#333" text-anchor="middle">Pipeline Parallel (PP)</text>
  <text x="426" y="416" font-size="9" fill="#555" text-anchor="middle">Stage layers across nodes</text>

  <rect x="350" y="436" width="152" height="22" rx="3" fill="#f7f7f7" stroke="#bbb" stroke-width="0.8"/>
  <text x="426" y="451" font-size="8" fill="#555" font-style="italic" text-anchor="middle">Low BW OK (Ethernet sufficient)</text>

  <!-- ── NO branch: 3D Hybrid ── -->
  <line x1="720" y1="318" x2="720" y2="390" stroke="#a31f34" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="728" y="360" font-size="10" font-weight="700" fill="#a31f34">No</text>

  <rect x="640" y="378" width="98" height="52" rx="8" fill="#e8d5f5" stroke="#7b2d8b" stroke-width="1.5"/>
  <text x="689" y="398" font-size="10" font-weight="700" fill="#333" text-anchor="middle">3D Hybrid</text>
  <text x="689" y="412" font-size="9" fill="#555" text-anchor="middle">TP + PP + DP</text>

  <rect x="640" y="436" width="98" height="22" rx="3" fill="#f7f7f7" stroke="#bbb" stroke-width="0.8"/>
  <text x="689" y="451" font-size="8" fill="#555" font-style="italic" text-anchor="middle">NVLink + IB + Eth</text>

  <!-- ═══════════════════════════════════════════════ -->
  <!-- ── Optional: Memory optimization branch ── -->
  <!-- ═══════════════════════════════════════════════ -->
  <!-- From DDP down to ZeRO/FSDP — kept in left column, well clear of TP box at x=158 -->
  <line x1="100" y1="240" x2="100" y2="280" stroke="#4a90c4" stroke-width="1.2" stroke-dasharray="4,3" marker-end="url(#arrow)"/>
  <text x="108" y="262" font-size="8" fill="#4a90c4" font-weight="600">Memory pressure?</text>

  <rect x="24" y="286" width="152" height="42" rx="8" fill="#e8f5e9" stroke="#2d7a2d" stroke-width="1.2"/>
  <text x="100" y="304" font-size="10" font-weight="700" fill="#2d7a2d" text-anchor="middle">ZeRO / FSDP</text>
  <text x="100" y="318" font-size="8.5" fill="#555" text-anchor="middle">Shard optimizer + grads + params</text>

</svg>
