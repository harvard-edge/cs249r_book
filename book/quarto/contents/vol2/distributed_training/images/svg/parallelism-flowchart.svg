<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460"
     font-family="Helvetica Neue, Helvetica, Arial, sans-serif">

  <defs>
    <marker id="arr" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <path d="M0,0 L10,3.5 L0,7 Z" fill="#555"/>
    </marker>
    <marker id="arr-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <path d="M0,0 L10,3.5 L0,7 Z" fill="#3d9e5a"/>
    </marker>
    <marker id="arr-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <path d="M0,0 L10,3.5 L0,7 Z" fill="#4a90c4"/>
    </marker>
    <marker id="arr-orange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <path d="M0,0 L10,3.5 L0,7 Z" fill="#c87b2a"/>
    </marker>
    <marker id="arr-purple" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <path d="M0,0 L10,3.5 L0,7 Z" fill="#7b2d8b"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="680" height="460" fill="#fafafa" rx="3"/>

  <!-- ══════════════════════════════════════════════════════ -->
  <!-- START BOX                                              -->
  <!-- ══════════════════════════════════════════════════════ -->
  <rect x="252" y="14" width="176" height="38" rx="6" fill="#e0e0e0" stroke="#999" stroke-width="1.5"/>
  <text x="340" y="28" font-size="10.5" font-weight="700" fill="#333" text-anchor="middle">Model + Dataset</text>
  <text x="340" y="44" font-size="9" fill="#555" text-anchor="middle">characterize constraints</text>

  <!-- Arrow down to D1 -->
  <line x1="340" y1="52" x2="340" y2="72" stroke="#555" stroke-width="1.5" marker-end="url(#arr)"/>

  <!-- ══════════════════════════════════════════════════════ -->
  <!-- DIAMOND 1: Model fits on 1 GPU?                       -->
  <!-- Center: (340, 94)                                      -->
  <!-- ══════════════════════════════════════════════════════ -->
  <polygon points="340,72 400,94 340,116 280,94" fill="#f7f7f7" stroke="#888" stroke-width="1.5"/>
  <text x="340" y="89" font-size="9.5" font-weight="700" fill="#333" text-anchor="middle">Model fits</text>
  <text x="340" y="102" font-size="9.5" font-weight="700" fill="#333" text-anchor="middle">on 1 GPU?</text>

  <!-- YES branch: right → D2 -->
  <line x1="400" y1="94" x2="460" y2="94" stroke="#3d9e5a" stroke-width="1.5" marker-end="url(#arr-green)"/>
  <text x="432" y="88" font-size="9" fill="#3d9e5a" font-weight="700">Yes</text>

  <!-- NO branch: left → D3 -->
  <line x1="280" y1="94" x2="198" y2="94" stroke="#c44" stroke-width="1.5" marker-end="url(#arr)"/>
  <text x="237" y="88" font-size="9" fill="#c44" font-weight="700">No</text>

  <!-- ══════════════════════════════════════════════════════ -->
  <!-- DIAMOND 2 (right branch): Dataset fits on 1 GPU?      -->
  <!-- Center: (510, 94)                                      -->
  <!-- ══════════════════════════════════════════════════════ -->
  <polygon points="510,72 580,94 510,116 440,94" fill="#f7f7f7" stroke="#888" stroke-width="1.5"/>
  <text x="510" y="89" font-size="9.5" font-weight="700" fill="#333" text-anchor="middle">Dataset fits</text>
  <text x="510" y="102" font-size="9.5" font-weight="700" fill="#333" text-anchor="middle">on 1 GPU?</text>

  <!-- YES → Single Device terminal (below D2) -->
  <line x1="510" y1="116" x2="510" y2="146" stroke="#3d9e5a" stroke-width="1.5" marker-end="url(#arr-green)"/>
  <text x="530" y="133" font-size="9" fill="#3d9e5a" font-weight="700">Yes</text>

  <!-- Terminal: Single Device -->
  <rect x="448" y="146" width="124" height="42" rx="6" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.8"/>
  <text x="510" y="162" font-size="10" font-weight="700" fill="#2d7040" text-anchor="middle">Single Device</text>
  <text x="510" y="178" font-size="8.5" fill="#2d7040" text-anchor="middle">no parallelism needed</text>

  <!-- NO (Dataset doesn't fit) → Data Parallelism -->
  <!-- Arrow from D2 top-left going up then left... we'll go: D2 right side up, then down to DP -->
  <!-- Actually: NO from D2 goes down -->
  <line x1="510" y1="116" x2="510" y2="116"/>
  <!-- No arrow needed for D2-yes handled; D2-No handled below -->
  <!-- D2 No: goes upward right -->
  <!-- Let's route: D2 No goes right edge of D2 (x=580) then down to Data Parallel terminal -->
  <line x1="580" y1="94" x2="626" y2="94" stroke="#c44" stroke-width="1.5"/>
  <line x1="626" y1="94" x2="626" y2="210" stroke="#c44" stroke-width="1.5"/>
  <line x1="626" y1="210" x2="584" y2="210" stroke="#c44" stroke-width="1.5" marker-end="url(#arr)"/>
  <text x="598" y="88" font-size="9" fill="#c44" font-weight="700">No</text>

  <!-- Terminal: Data Parallelism (right column) -->
  <rect x="448" y="188" width="136" height="44" rx="6" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.8"/>
  <text x="516" y="205" font-size="10" font-weight="700" fill="#2a6099" text-anchor="middle">Data Parallelism</text>
  <text x="516" y="221" font-size="8.5" fill="#2a6099" text-anchor="middle">replicate model, split batch</text>

  <!-- ══════════════════════════════════════════════════════ -->
  <!-- LEFT SUBTREE: Model doesn't fit on 1 GPU              -->
  <!-- DIAMOND 3: Sequential layers too slow?                 -->
  <!-- Center: (148, 188)                                     -->
  <!-- ══════════════════════════════════════════════════════ -->
  <line x1="198" y1="94" x2="148" y2="94" stroke="#c44" stroke-width="1.5"/>
  <line x1="148" y1="94" x2="148" y2="166" stroke="#c44" stroke-width="1.5" marker-end="url(#arr)"/>

  <polygon points="148,166 218,188 148,210 78,188" fill="#f7f7f7" stroke="#888" stroke-width="1.5"/>
  <text x="148" y="183" font-size="9.5" font-weight="700" fill="#333" text-anchor="middle">Sequential</text>
  <text x="148" y="196" font-size="9.5" font-weight="700" fill="#333" text-anchor="middle">layers slow?</text>

  <!-- YES → Pipeline Parallelism -->
  <line x1="148" y1="166" x2="148" y2="148" stroke="#c87b2a" stroke-width="1.5"/>
  <line x1="148" y1="148" x2="44" y2="148" stroke="#c87b2a" stroke-width="1.5"/>
  <line x1="44" y1="148" x2="44" y2="248" stroke="#c87b2a" stroke-width="1.5" marker-end="url(#arr-orange)"/>
  <text x="96" y="142" font-size="9" fill="#c87b2a" font-weight="700">Yes</text>

  <!-- Terminal: Pipeline Parallelism (far left column) -->
  <rect x="4" y="248" width="80" height="44" rx="6" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.8"/>
  <text x="44" y="264" font-size="9.5" font-weight="700" fill="#7a4010" text-anchor="middle">Pipeline</text>
  <text x="44" y="278" font-size="9.5" font-weight="700" fill="#7a4010" text-anchor="middle">Parallelism</text>

  <!-- NO from D3 → D4 -->
  <line x1="148" y1="210" x2="148" y2="250" stroke="#3d9e5a" stroke-width="1.5" marker-end="url(#arr)"/>
  <text x="160" y="234" font-size="9" fill="#3d9e5a" font-weight="700">No</text>

  <!-- ══════════════════════════════════════════════════════ -->
  <!-- DIAMOND 4: Single layer too large?                     -->
  <!-- Center: (148, 272)                                     -->
  <!-- ══════════════════════════════════════════════════════ -->
  <polygon points="148,250 218,272 148,294 78,272" fill="#f7f7f7" stroke="#888" stroke-width="1.5"/>
  <text x="148" y="267" font-size="9.5" font-weight="700" fill="#333" text-anchor="middle">Single layer</text>
  <text x="148" y="280" font-size="9.5" font-weight="700" fill="#333" text-anchor="middle">too large?</text>

  <!-- YES → Tensor Parallelism (left) -->
  <line x1="78" y1="272" x2="44" y2="272" stroke="#7b2d8b" stroke-width="1.5"/>
  <line x1="44" y1="272" x2="44" y2="310" stroke="#7b2d8b" stroke-width="1.5" marker-end="url(#arr-purple)"/>
  <text x="60" y="266" font-size="9" fill="#7b2d8b" font-weight="700">Yes</text>

  <!-- Terminal: Tensor Parallelism -->
  <rect x="4" y="310" width="80" height="44" rx="6" fill="#e8d5f5" stroke="#7b2d8b" stroke-width="1.8"/>
  <text x="44" y="326" font-size="9.5" font-weight="700" fill="#7b2d8b" text-anchor="middle">Tensor</text>
  <text x="44" y="340" font-size="9.5" font-weight="700" fill="#7b2d8b" text-anchor="middle">Parallelism</text>

  <!-- NO from D4 → Model Parallelism -->
  <line x1="148" y1="294" x2="148" y2="320" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arr-blue)"/>
  <text x="162" y="312" font-size="9" fill="#4a90c4" font-weight="700">No</text>

  <!-- Terminal: Model Parallelism -->
  <rect x="88" y="320" width="120" height="44" rx="6" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.8"/>
  <text x="148" y="336" font-size="10" font-weight="700" fill="#2a6099" text-anchor="middle">Model</text>
  <text x="148" y="350" font-size="10" font-weight="700" fill="#2a6099" text-anchor="middle">Parallelism</text>

  <!-- ══════════════════════════════════════════════════════ -->
  <!-- SUMMARY BOX: 3D Parallelism at bottom                  -->
  <!-- ══════════════════════════════════════════════════════ -->
  <rect x="172" y="400" width="336" height="46" rx="6" fill="#e8f5e9" stroke="#3d9e5a" stroke-width="2"/>
  <text x="340" y="418" font-size="11" font-weight="700" fill="#2d7040" text-anchor="middle">Combine strategies &#x2192; 3D Parallelism</text>
  <text x="340" y="436" font-size="9.5" fill="#3d9e5a" text-anchor="middle">Data × Pipeline × Tensor for production scale</text>

  <!-- Connector lines from terminals to summary box -->
  <!-- From Pipeline Parallelism -->
  <line x1="44" y1="292" x2="44" y2="422" stroke="#ccc" stroke-width="1" stroke-dasharray="5,3"/>
  <line x1="44" y1="422" x2="172" y2="422" stroke="#ccc" stroke-width="1" stroke-dasharray="5,3" marker-end="url(#arr)"/>

  <!-- From Tensor Parallelism -->
  <line x1="84" y1="332" x2="172" y2="422" stroke="#ccc" stroke-width="1" stroke-dasharray="5,3" marker-end="url(#arr)"/>

  <!-- From Model Parallelism -->
  <line x1="148" y1="364" x2="200" y2="400" stroke="#ccc" stroke-width="1" stroke-dasharray="5,3" marker-end="url(#arr)"/>

  <!-- From Data Parallelism -->
  <line x1="516" y1="232" x2="516" y2="390" stroke="#ccc" stroke-width="1" stroke-dasharray="5,3"/>
  <line x1="516" y1="390" x2="508" y2="400" stroke="#ccc" stroke-width="1" stroke-dasharray="5,3" marker-end="url(#arr)"/>

  <!-- From Single Device (no combiner) -->
  <!-- (Single device doesn't combine, intentionally left without connector) -->

</svg>
