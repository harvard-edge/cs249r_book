<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460"
     font-family="Helvetica Neue, Helvetica, Arial, sans-serif">

  <defs>
    <marker id="arr-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <path d="M0,0 L10,3.5 L0,7 Z" fill="#4a90c4"/>
    </marker>
    <marker id="arr-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <path d="M0,0 L10,3.5 L0,7 Z" fill="#3d9e5a"/>
    </marker>
    <marker id="arr-orange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <path d="M0,0 L10,3.5 L0,7 Z" fill="#c87b2a"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="680" height="460" fill="#fafafa" rx="3"/>

  <!-- ══════════════════════════════════════════════════════════ -->
  <!-- Isometric cube: origin at (300, 310)                      -->
  <!-- Isometric unit vectors:                                   -->
  <!--   X (right):       dx = (80, 0)                          -->
  <!--   Y (up):          dy = (0, -90)                         -->
  <!--   Z (left-back):   dz = (-55, 35)                        -->
  <!-- Cube corners: O=(300,310), A=O+X, B=O+Y, C=O+Z           -->
  <!--   D=O+X+Y, E=O+X+Z, F=O+Y+Z, G=O+X+Y+Z                  -->
  <!--                                                            -->
  <!-- O   = (300, 310)                                          -->
  <!-- A   = (380, 310)   O + X                                  -->
  <!-- B   = (300, 220)   O + Y                                  -->
  <!-- C   = (245, 345)   O + Z                                  -->
  <!-- D   = (380, 220)   O + X + Y                              -->
  <!-- E   = (325, 345)   O + X + Z                              -->
  <!-- F   = (245, 255)   O + Y + Z                              -->
  <!-- G   = (325, 255)   O + X + Y + Z                          -->
  <!-- ══════════════════════════════════════════════════════════ -->

  <!-- Right face (X+Y plane, at Z=0): orange — Tensor Parallel -->
  <polygon points="300,310 380,310 380,220 300,220"
           fill="#fdebd0" stroke="#c87b2a" stroke-width="1.8" opacity="0.85"/>

  <!-- Top face (X+Z plane, at Y=1): blue — Data Parallel -->
  <polygon points="300,220 380,220 325,255 245,255"
           fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.8" opacity="0.85"/>

  <!-- Left face (Y+Z plane, at X=0): green — Pipeline Parallel -->
  <polygon points="300,310 245,345 245,255 300,220"
           fill="#d4edda" stroke="#3d9e5a" stroke-width="1.8" opacity="0.85"/>

  <!-- Dashed hidden edges of the cube -->
  <!-- Back bottom edge (O to E: O+X+Z) -->
  <line x1="380" y1="310" x2="325" y2="345"
        stroke="#999" stroke-width="1.2" stroke-dasharray="5,3"/>
  <!-- Back right edge (E to G) -->
  <line x1="325" y1="345" x2="325" y2="255"
        stroke="#999" stroke-width="1.2" stroke-dasharray="5,3"/>
  <!-- Back bottom to G -->
  <line x1="245" y1="345" x2="325" y2="345"
        stroke="#999" stroke-width="1.2" stroke-dasharray="5,3"/>
  <!-- G to D -->
  <line x1="325" y1="255" x2="380" y2="220"
        stroke="#999" stroke-width="1.2" stroke-dasharray="5,3"/>

  <!-- Visible outer edges -->
  <!-- Bottom: O to A -->
  <line x1="300" y1="310" x2="380" y2="310"
        stroke="#555" stroke-width="1.6"/>
  <!-- Left bottom: O to C -->
  <line x1="300" y1="310" x2="245" y2="345"
        stroke="#555" stroke-width="1.6"/>
  <!-- Vertical: O to B -->
  <line x1="300" y1="310" x2="300" y2="220"
        stroke="#555" stroke-width="1.6"/>
  <!-- A to D -->
  <line x1="380" y1="310" x2="380" y2="220"
        stroke="#555" stroke-width="1.6"/>
  <!-- B to D -->
  <line x1="300" y1="220" x2="380" y2="220"
        stroke="#555" stroke-width="1.6"/>
  <!-- B to F -->
  <line x1="300" y1="220" x2="245" y2="255"
        stroke="#555" stroke-width="1.6"/>
  <!-- D to G -->
  <line x1="380" y1="220" x2="325" y2="255"
        stroke="#555" stroke-width="1.6"/>
  <!-- F to G -->
  <line x1="245" y1="255" x2="325" y2="255"
        stroke="#555" stroke-width="1.6"/>
  <!-- C to F -->
  <line x1="245" y1="345" x2="245" y2="255"
        stroke="#555" stroke-width="1.6"/>

  <!-- Face labels -->
  <!-- Right face center ≈ (340, 265) -->
  <text x="342" y="262" font-size="10" font-weight="700" fill="#c87b2a" text-anchor="middle">Tensor</text>
  <text x="342" y="275" font-size="10" font-weight="700" fill="#c87b2a" text-anchor="middle">Parallel</text>

  <!-- Top face center ≈ (312, 242) -->
  <text x="310" y="237" font-size="10" font-weight="700" fill="#2a6099" text-anchor="middle">Data</text>
  <text x="310" y="250" font-size="10" font-weight="700" fill="#2a6099" text-anchor="middle">Parallel</text>

  <!-- Left face center ≈ (270, 285) -->
  <text x="268" y="283" font-size="10" font-weight="700" fill="#2d7040" text-anchor="middle">Pipeline</text>
  <text x="268" y="296" font-size="10" font-weight="700" fill="#2d7040" text-anchor="middle">Parallel</text>

  <!-- ════════════════ Axis arrows ════════════════ -->
  <!-- X axis: Tensor Parallel (right), from A=(380,310) -->
  <line x1="390" y1="310" x2="465" y2="310"
        stroke="#c87b2a" stroke-width="2.2" marker-end="url(#arr-orange)"/>
  <text x="432" y="300" font-size="10.5" font-weight="700" fill="#c87b2a" text-anchor="middle">Tensor Parallel (t)</text>

  <!-- Y axis: Pipeline Parallel (up), from B=(300,220) -->
  <line x1="300" y1="210" x2="300" y2="140"
        stroke="#3d9e5a" stroke-width="2.2" marker-end="url(#arr-green)"/>
  <text x="300" y="130" font-size="10.5" font-weight="700" fill="#3d9e5a" text-anchor="middle">Pipeline Parallel (p)</text>

  <!-- Z axis: Data Parallel (left-back), from C=(245,345) -->
  <line x1="237" y1="351" x2="178" y2="389"
        stroke="#4a90c4" stroke-width="2.2" marker-end="url(#arr-blue)"/>
  <text x="182" y="410" font-size="10.5" font-weight="700" fill="#4a90c4" text-anchor="middle">Data Parallel (d)</text>

  <!-- ════════════════ Annotation point on cube corner G=(325,255) ════════════════ -->
  <circle cx="325" cy="255" r="4" fill="#c44" stroke="#fff" stroke-width="1.5"/>

  <!-- ════════════════ Right panel: formula box ════════════════ -->
  <rect x="478" y="88" width="182" height="62" rx="5" fill="#e8f5e9" stroke="#3d9e5a" stroke-width="1.4"/>
  <text x="569" y="112" font-size="12" font-weight="700" fill="#2d7040" text-anchor="middle">Total GPUs = d × p × t</text>
  <text x="569" y="132" font-size="10.5" fill="#555" text-anchor="middle">e.g., 64 × 16 × 8 = 8,192</text>

  <!-- Right panel: dimension descriptions -->
  <rect x="478" y="168" width="182" height="168" rx="5" fill="#f7f7f7" stroke="#bbb" stroke-width="1"/>

  <!-- Tensor Parallel row -->
  <rect x="488" y="178" width="12" height="12" rx="2" fill="#fdebd0" stroke="#c87b2a" stroke-width="1"/>
  <text x="506" y="188" font-size="9.5" font-weight="700" fill="#c87b2a">Tensor Parallel (t)</text>
  <text x="506" y="201" font-size="8.5" fill="#666">Split matrices within a layer</text>
  <text x="506" y="213" font-size="8.5" fill="#666">Requires NVLink (intra-node)</text>

  <!-- Pipeline Parallel row -->
  <rect x="488" y="223" width="12" height="12" rx="2" fill="#d4edda" stroke="#3d9e5a" stroke-width="1"/>
  <text x="506" y="233" font-size="9.5" font-weight="700" fill="#2d7040">Pipeline Parallel (p)</text>
  <text x="506" y="246" font-size="8.5" fill="#666">Partition layers into stages</text>
  <text x="506" y="258" font-size="8.5" fill="#666">Suitable for inter-node links</text>

  <!-- Data Parallel row -->
  <rect x="488" y="268" width="12" height="12" rx="2" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1"/>
  <text x="506" y="278" font-size="9.5" font-weight="700" fill="#2a6099">Data Parallel (d)</text>
  <text x="506" y="291" font-size="8.5" fill="#666">Replicate model; split batch</text>
  <text x="506" y="303" font-size="8.5" fill="#666">AllReduce over replicas</text>

  <!-- Placement rule box -->
  <rect x="478" y="352" width="182" height="82" rx="5" fill="#f7f7f7" stroke="#bbb" stroke-width="1"/>
  <text x="569" y="370" font-size="9" font-weight="700" fill="#a31f34" text-anchor="middle">Hardware Placement Rule</text>
  <text x="488" y="386" font-size="8.5" fill="#555">t: within node  (NVLink ~600 GB/s)</text>
  <text x="488" y="400" font-size="8.5" fill="#555">p: across nodes (IB ~25 GB/s/port)</text>
  <text x="488" y="414" font-size="8.5" fill="#555">d: across racks  (Eth ~12.5 GB/s)</text>

  <!-- Bottom annotation -->
  <text x="340" y="446" font-size="9" fill="#999" font-style="italic" text-anchor="middle">
    Each dimension is orthogonal: changing t does not affect p or d.
  </text>

</svg>
