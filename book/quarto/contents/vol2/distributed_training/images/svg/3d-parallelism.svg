<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460"
     font-family="Helvetica Neue, Helvetica, Arial, sans-serif">

  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <path d="M0,0 L10,3.5 L0,7 Z" fill="#555"/>
    </marker>
    <marker id="arrow-blue" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <path d="M0,0 L10,3.5 L0,7 Z" fill="#4a90c4"/>
    </marker>
    <marker id="arrow-green" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <path d="M0,0 L10,3.5 L0,7 Z" fill="#3d9e5a"/>
    </marker>
    <marker id="arrow-orange" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <path d="M0,0 L10,3.5 L0,7 Z" fill="#c87b2a"/>
    </marker>
  </defs>

  <!-- ── Background ── -->
  <rect width="680" height="460" fill="#fff" rx="4"/>

  <!-- ═══════════════════════════════════════════════ -->
  <!-- ── 3D Grid: 2x2x2 = 8 GPUs ── -->
  <!-- Isometric projection of a 2x2x2 cube -->
  <!-- X-axis = Data Parallel (right) -->
  <!-- Y-axis = Pipeline Parallel (up) -->
  <!-- Z-axis = Tensor Parallel (diagonal left-down) -->
  <!-- ═══════════════════════════════════════════════ -->

  <!-- Isometric unit vectors: -->
  <!-- dx = (100, 0), dy = (0, -90), dz = (-60, 40) -->

  <!-- ── Back-bottom row (z=0, y=0): DP replicas ── -->
  <!-- GPU (0,0,0) at base (200, 310) -->
  <rect x="174" y="288" width="52" height="44" rx="4" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="200" y="306" font-size="8" font-weight="700" fill="#333" text-anchor="middle">GPU 0</text>
  <text x="200" y="318" font-size="7" fill="#555" text-anchor="middle">d=0,t=0,p=0</text>

  <!-- GPU (1,0,0) at (300, 310) -->
  <rect x="274" y="288" width="52" height="44" rx="4" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="300" y="306" font-size="8" font-weight="700" fill="#333" text-anchor="middle">GPU 1</text>
  <text x="300" y="318" font-size="7" fill="#555" text-anchor="middle">d=1,t=0,p=0</text>

  <!-- ── Back-top row (z=0, y=1): PP stage 1 ── -->
  <!-- GPU (0,1,0) at (200, 220) -->
  <rect x="174" y="198" width="52" height="44" rx="4" fill="#f9d6d5" stroke="#c44" stroke-width="1.2"/>
  <text x="200" y="216" font-size="8" font-weight="700" fill="#333" text-anchor="middle">GPU 4</text>
  <text x="200" y="228" font-size="7" fill="#555" text-anchor="middle">d=0,t=0,p=1</text>

  <!-- GPU (1,1,0) at (300, 220) -->
  <rect x="274" y="198" width="52" height="44" rx="4" fill="#f9d6d5" stroke="#c44" stroke-width="1.2"/>
  <text x="300" y="216" font-size="8" font-weight="700" fill="#333" text-anchor="middle">GPU 5</text>
  <text x="300" y="228" font-size="7" fill="#555" text-anchor="middle">d=1,t=0,p=1</text>

  <!-- ── Front-bottom row (z=1, y=0): TP shard 1 ── -->
  <!-- GPU (0,0,1) at (200-60, 310+40) = (140, 350) -->
  <rect x="114" y="328" width="52" height="44" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.2"/>
  <text x="140" y="346" font-size="8" font-weight="700" fill="#333" text-anchor="middle">GPU 2</text>
  <text x="140" y="358" font-size="7" fill="#555" text-anchor="middle">d=0,t=1,p=0</text>

  <!-- GPU (1,0,1) at (300-60, 310+40) = (240, 350) -->
  <rect x="214" y="328" width="52" height="44" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.2"/>
  <text x="240" y="346" font-size="8" font-weight="700" fill="#333" text-anchor="middle">GPU 3</text>
  <text x="240" y="358" font-size="7" fill="#555" text-anchor="middle">d=1,t=1,p=0</text>

  <!-- ── Front-top row (z=1, y=1) ── -->
  <!-- GPU (0,1,1) at (140, 260) -->
  <rect x="114" y="238" width="52" height="44" rx="4" fill="#e8d5f5" stroke="#7b2d8b" stroke-width="1.2"/>
  <text x="140" y="256" font-size="8" font-weight="700" fill="#333" text-anchor="middle">GPU 6</text>
  <text x="140" y="268" font-size="7" fill="#555" text-anchor="middle">d=0,t=1,p=1</text>

  <!-- GPU (1,1,1) at (240, 260) -->
  <rect x="214" y="238" width="52" height="44" rx="4" fill="#e8d5f5" stroke="#7b2d8b" stroke-width="1.2"/>
  <text x="240" y="256" font-size="8" font-weight="700" fill="#333" text-anchor="middle">GPU 7</text>
  <text x="240" y="268" font-size="7" fill="#555" text-anchor="middle">d=1,t=1,p=1</text>

  <!-- ── Connecting edges (cube wireframe) ── -->
  <!-- Bottom face edges (y=0) -->
  <line x1="200" y1="332" x2="200" y2="310" stroke="#999" stroke-width="0.8" stroke-dasharray="3,2"/>
  <line x1="300" y1="332" x2="300" y2="310" stroke="#999" stroke-width="0.8" stroke-dasharray="3,2"/>
  <line x1="166" y1="350" x2="174" y2="310" stroke="#999" stroke-width="0.8" stroke-dasharray="3,2"/>
  <line x1="266" y1="350" x2="274" y2="310" stroke="#999" stroke-width="0.8" stroke-dasharray="3,2"/>

  <!-- Top face edges (y=1) -->
  <line x1="200" y1="242" x2="200" y2="220" stroke="#999" stroke-width="0.8" stroke-dasharray="3,2"/>
  <line x1="300" y1="242" x2="300" y2="220" stroke="#999" stroke-width="0.8" stroke-dasharray="3,2"/>
  <line x1="166" y1="260" x2="174" y2="220" stroke="#999" stroke-width="0.8" stroke-dasharray="3,2"/>
  <line x1="266" y1="260" x2="274" y2="220" stroke="#999" stroke-width="0.8" stroke-dasharray="3,2"/>

  <!-- Vertical edges (y connections) -->
  <line x1="200" y1="288" x2="200" y2="242" stroke="#999" stroke-width="0.8" stroke-dasharray="3,2"/>
  <line x1="300" y1="288" x2="300" y2="242" stroke="#999" stroke-width="0.8" stroke-dasharray="3,2"/>
  <line x1="140" y1="328" x2="140" y2="282" stroke="#999" stroke-width="0.8" stroke-dasharray="3,2"/>
  <line x1="240" y1="328" x2="240" y2="282" stroke="#999" stroke-width="0.8" stroke-dasharray="3,2"/>

  <!-- ═══════════════════════════════════════════════ -->
  <!-- ── Axis arrows ── -->
  <!-- ═══════════════════════════════════════════════ -->

  <!-- X-axis: Data Parallel (right) -->
  <line x1="340" y1="310" x2="430" y2="310" stroke="#4a90c4" stroke-width="2" marker-end="url(#arrow-blue)"/>
  <text x="385" y="302" font-size="10" font-weight="700" fill="#4a90c4" text-anchor="middle">Data Parallel (d)</text>

  <!-- Y-axis: Pipeline Parallel (up) -->
  <line x1="340" y1="310" x2="340" y2="180" stroke="#c44" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="368" y="240" font-size="10" font-weight="700" fill="#c44" text-anchor="middle" transform="rotate(-90,368,240)">Pipeline Parallel (p)</text>

  <!-- Z-axis: Tensor Parallel (diagonal) -->
  <line x1="340" y1="310" x2="280" y2="380" stroke="#c87b2a" stroke-width="2" marker-end="url(#arrow-orange)"/>
  <text x="296" y="362" font-size="10" font-weight="700" fill="#c87b2a" text-anchor="middle" transform="rotate(35,296,362)">Tensor Parallel (t)</text>

  <!-- ═══════════════════════════════════════════════ -->
  <!-- ── Right panel: axis descriptions ── -->
  <!-- ═══════════════════════════════════════════════ -->

  <rect x="410" y="48" width="250" height="200" rx="5" fill="#f7f7f7" stroke="#bbb" stroke-width="1"/>

  <!-- Data Parallel -->
  <rect x="420" y="58" width="12" height="12" rx="2" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1"/>
  <text x="438" y="68" font-size="10" font-weight="700" fill="#4a90c4">Data Parallel (d = 2)</text>
  <text x="438" y="82" font-size="8.5" fill="#555">Replicate model, split batch</text>
  <text x="438" y="94" font-size="8.5" fill="#555">Sync: AllReduce gradients</text>
  <text x="438" y="106" font-size="8.5" fill="#555">Interconnect: InfiniBand (inter-node)</text>

  <!-- Pipeline Parallel -->
  <rect x="420" y="118" width="12" height="12" rx="2" fill="#f9d6d5" stroke="#c44" stroke-width="1"/>
  <text x="438" y="128" font-size="10" font-weight="700" fill="#c44">Pipeline Parallel (p = 2)</text>
  <text x="438" y="142" font-size="8.5" fill="#555">Partition layers across stages</text>
  <text x="438" y="154" font-size="8.5" fill="#555">Sync: Point-to-point activations</text>
  <text x="438" y="166" font-size="8.5" fill="#555">Interconnect: Ethernet sufficient</text>

  <!-- Tensor Parallel -->
  <rect x="420" y="178" width="12" height="12" rx="2" fill="#fdebd0" stroke="#c87b2a" stroke-width="1"/>
  <text x="438" y="188" font-size="10" font-weight="700" fill="#c87b2a">Tensor Parallel (t = 2)</text>
  <text x="438" y="202" font-size="8.5" fill="#555">Split layers (column/row)</text>
  <text x="438" y="214" font-size="8.5" fill="#555">Sync: AllReduce per layer</text>
  <text x="438" y="226" font-size="8.5" fill="#555">Interconnect: NVLink (intra-node)</text>

  <!-- ═══════════════════════════════════════════════ -->
  <!-- ── Formula box ── -->
  <!-- ═══════════════════════════════════════════════ -->
  <rect x="410" y="260" width="250" height="48" rx="4" fill="#e8f5e9" stroke="#2d7a2d" stroke-width="1.2"/>
  <text x="535" y="280" font-size="11" font-weight="700" fill="#2d7a2d" text-anchor="middle">Total GPUs = d &#x00D7; t &#x00D7; p</text>
  <text x="535" y="298" font-size="10" fill="#555" text-anchor="middle">2 &#x00D7; 2 &#x00D7; 2 = 8 GPUs</text>

  <!-- ═══════════════════════════════════════════════ -->
  <!-- ── Placement constraint note ── -->
  <!-- ═══════════════════════════════════════════════ -->
  <rect x="410" y="320" width="250" height="72" rx="4" fill="#f7f7f7" stroke="#bbb" stroke-width="1"/>
  <text x="535" y="338" font-size="9" font-weight="700" fill="#a31f34" text-anchor="middle">Hardware Placement Rule</text>
  <text x="420" y="354" font-size="8.5" fill="#555">TP within node (NVLink: 600 GB/s)</text>
  <text x="420" y="368" font-size="8.5" fill="#555">PP across nodes (IB: 25 GB/s per port)</text>
  <text x="420" y="382" font-size="8.5" fill="#555">DP across racks (Ethernet: 12.5 GB/s)</text>

  <!-- ── Bottom annotation ── -->
  <text x="340" y="430" font-size="9" fill="#999" font-style="italic" text-anchor="middle">Example: 2 DP replicas, each with 2 pipeline stages, each stage split across 2 tensor-parallel GPUs.</text>
  <text x="340" y="446" font-size="9" fill="#999" font-style="italic" text-anchor="middle">Production configs (e.g., GPT-4): d=64, t=8, p=16 = 8,192 GPUs.</text>

</svg>
