<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460"
     font-family="Helvetica Neue, Helvetica, Arial, sans-serif">

  <defs>
    <marker id="arrow" markerWidth="7" markerHeight="5" refX="7" refY="2.5" orient="auto">
      <path d="M0,0 L7,2.5 L0,5 Z" fill="#555"/>
    </marker>
    <marker id="arrow-blue" markerWidth="7" markerHeight="5" refX="7" refY="2.5" orient="auto">
      <path d="M0,0 L7,2.5 L0,5 Z" fill="#4a90c4"/>
    </marker>
  </defs>

  <!-- ── Background ── -->
  <rect width="680" height="460" fill="#fff" rx="4"/>

  <!-- ── Column dividers ── -->
  <line x1="227" y1="10" x2="227" y2="450" stroke="#e0e0e0" stroke-width="0.8"/>
  <line x1="453" y1="10" x2="453" y2="450" stroke="#e0e0e0" stroke-width="0.8"/>

  <!-- ═══════════════════════════════════════════════ -->
  <!-- ── (a) Ring AllReduce ── -->
  <!-- ═══════════════════════════════════════════════ -->
  <text x="113" y="28" font-size="12" font-weight="700" fill="#333" text-anchor="middle">(a) Ring AllReduce</text>

  <!-- 4 GPU nodes in a ring -->
  <circle cx="113" cy="115" r="26" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="113" y="119" font-size="10" font-weight="700" fill="#333" text-anchor="middle">GPU 0</text>

  <circle cx="190" cy="190" r="26" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="190" y="194" font-size="10" font-weight="700" fill="#333" text-anchor="middle">GPU 1</text>

  <circle cx="113" cy="265" r="26" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="113" y="269" font-size="10" font-weight="700" fill="#333" text-anchor="middle">GPU 3</text>

  <circle cx="36" cy="190" r="26" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="36" y="194" font-size="10" font-weight="700" fill="#333" text-anchor="middle">GPU 2</text>

  <!-- Clockwise ring arrows -->
  <path d="M137,125 Q168,136 180,165" fill="none" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arrow-blue)"/>
  <path d="M180,216 Q168,244 137,256" fill="none" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arrow-blue)"/>
  <path d="M89,256 Q58,244 46,216" fill="none" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arrow-blue)"/>
  <path d="M46,165 Q58,136 89,125" fill="none" stroke="#4a90c4" stroke-width="1.5" marker-end="url(#arrow-blue)"/>

  <!-- Data chunk labels -->
  <text x="164" y="128" font-size="8" fill="#4a90c4" font-weight="600">chunk 0</text>
  <text x="188" y="248" font-size="8" fill="#4a90c4" font-weight="600">chunk 1</text>
  <text x="26" y="248" font-size="8" fill="#4a90c4" font-weight="600" text-anchor="end">chunk 2</text>
  <text x="26" y="135" font-size="8" fill="#4a90c4" font-weight="600" text-anchor="end">chunk 3</text>

  <!-- Characteristics box -->
  <rect x="14" y="308" width="200" height="106" rx="4" fill="#f7f7f7" stroke="#bbb" stroke-width="1"/>
  <text x="114" y="328" font-size="10" font-weight="700" fill="#333" text-anchor="middle">Bandwidth Optimal</text>
  <line x1="24" y1="335" x2="204" y2="335" stroke="#e0e0e0" stroke-width="0.8"/>
  <text x="22" y="352" font-size="9" fill="#555">Volume: 2(N-1)/N per GPU</text>
  <text x="22" y="368" font-size="9" fill="#555">Latency: O(N) steps</text>
  <text x="22" y="384" font-size="9" fill="#555">BW utilization: ~100%</text>
  <text x="22" y="402" font-size="9" fill="#999" font-style="italic">Default in NCCL / PyTorch DDP</text>

  <!-- ═══════════════════════════════════════════════ -->
  <!-- ── (b) Parameter Server ── -->
  <!-- ═══════════════════════════════════════════════ -->
  <text x="340" y="28" font-size="12" font-weight="700" fill="#333" text-anchor="middle">(b) Parameter Server</text>

  <!-- PS central node -->
  <rect x="308" y="90" width="64" height="40" rx="6" fill="#f9d6d5" stroke="#c44" stroke-width="1.5"/>
  <text x="340" y="106" font-size="10" font-weight="700" fill="#a31f34" text-anchor="middle">Param</text>
  <text x="340" y="120" font-size="10" font-weight="700" fill="#a31f34" text-anchor="middle">Server</text>

  <!-- Bottleneck label -->
  <rect x="300" y="68" width="80" height="16" rx="3" fill="#f9d6d5" stroke="#c44" stroke-width="0.8"/>
  <text x="340" y="80" font-size="8" font-weight="600" fill="#a31f34" text-anchor="middle">Bottleneck</text>

  <!-- Worker nodes -->
  <circle cx="268" cy="210" r="22" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.5"/>
  <text x="268" y="214" font-size="9" font-weight="700" fill="#333" text-anchor="middle">W 0</text>

  <circle cx="316" cy="262" r="22" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.5"/>
  <text x="316" y="266" font-size="9" font-weight="700" fill="#333" text-anchor="middle">W 1</text>

  <circle cx="364" cy="262" r="22" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.5"/>
  <text x="364" y="266" font-size="9" font-weight="700" fill="#333" text-anchor="middle">W 2</text>

  <circle cx="412" cy="210" r="22" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.5"/>
  <text x="412" y="214" font-size="9" font-weight="700" fill="#333" text-anchor="middle">W 3</text>

  <!-- Bidirectional arrows -->
  <line x1="322" y1="130" x2="278" y2="190" stroke="#555" stroke-width="1.2" marker-end="url(#arrow)"/>
  <line x1="278" y1="192" x2="322" y2="132" stroke="#999" stroke-width="0.8" stroke-dasharray="3,2"/>
  <line x1="332" y1="130" x2="318" y2="240" stroke="#555" stroke-width="1.2" marker-end="url(#arrow)"/>
  <line x1="318" y1="242" x2="332" y2="132" stroke="#999" stroke-width="0.8" stroke-dasharray="3,2"/>
  <line x1="348" y1="130" x2="362" y2="240" stroke="#555" stroke-width="1.2" marker-end="url(#arrow)"/>
  <line x1="362" y1="242" x2="348" y2="132" stroke="#999" stroke-width="0.8" stroke-dasharray="3,2"/>
  <line x1="358" y1="130" x2="402" y2="190" stroke="#555" stroke-width="1.2" marker-end="url(#arrow)"/>
  <line x1="402" y1="192" x2="358" y2="132" stroke="#999" stroke-width="0.8" stroke-dasharray="3,2"/>

  <!-- Flow labels -->
  <text x="0" y="0" font-size="7.5" fill="#555" text-anchor="middle" transform="translate(276,156) rotate(-42) translate(0,-6)">push grads</text>
  <text x="0" y="0" font-size="7.5" fill="#555" text-anchor="middle" transform="translate(398,156) rotate(42) translate(0,-6)">pull params</text>

  <!-- Characteristics box -->
  <rect x="240" y="308" width="200" height="106" rx="4" fill="#f7f7f7" stroke="#bbb" stroke-width="1"/>
  <text x="340" y="328" font-size="10" font-weight="700" fill="#333" text-anchor="middle">Centralized (Legacy)</text>
  <line x1="250" y1="335" x2="430" y2="335" stroke="#e0e0e0" stroke-width="0.8"/>
  <text x="248" y="352" font-size="9" fill="#555">Volume: 2M per worker</text>
  <text x="248" y="368" font-size="9" fill="#555">Latency: O(1) rounds</text>
  <text x="248" y="384" font-size="9" fill="#555">BW utilization: limited by PS</text>
  <text x="248" y="402" font-size="9" fill="#999" font-style="italic">Used in DistBelief (2012)</text>

  <!-- ═══════════════════════════════════════════════ -->
  <!-- ── (c) All-to-All (Mesh) ── -->
  <!-- ═══════════════════════════════════════════════ -->
  <text x="567" y="28" font-size="12" font-weight="700" fill="#333" text-anchor="middle">(c) All-to-All Mesh</text>

  <!-- 4 GPU nodes in a grid -->
  <circle cx="520" cy="120" r="24" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5"/>
  <text x="520" y="124" font-size="10" font-weight="700" fill="#333" text-anchor="middle">GPU 0</text>

  <circle cx="614" cy="120" r="24" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5"/>
  <text x="614" y="124" font-size="10" font-weight="700" fill="#333" text-anchor="middle">GPU 1</text>

  <circle cx="520" cy="230" r="24" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5"/>
  <text x="520" y="234" font-size="10" font-weight="700" fill="#333" text-anchor="middle">GPU 2</text>

  <circle cx="614" cy="230" r="24" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.5"/>
  <text x="614" y="234" font-size="10" font-weight="700" fill="#333" text-anchor="middle">GPU 3</text>

  <!-- All-to-all connections: 6 links -->
  <line x1="544" y1="120" x2="590" y2="120" stroke="#c87b2a" stroke-width="1.2"/>
  <line x1="544" y1="230" x2="590" y2="230" stroke="#c87b2a" stroke-width="1.2"/>
  <line x1="520" y1="144" x2="520" y2="206" stroke="#c87b2a" stroke-width="1.2"/>
  <line x1="614" y1="144" x2="614" y2="206" stroke="#c87b2a" stroke-width="1.2"/>
  <line x1="538" y1="138" x2="596" y2="212" stroke="#c87b2a" stroke-width="1" stroke-dasharray="4,3"/>
  <line x1="596" y1="138" x2="538" y2="212" stroke="#c87b2a" stroke-width="1" stroke-dasharray="4,3"/>

  <!-- Link count -->
  <text x="567" y="178" font-size="9" fill="#c87b2a" font-weight="600" text-anchor="middle">6 links</text>

  <!-- Characteristics box -->
  <rect x="467" y="308" width="200" height="106" rx="4" fill="#f7f7f7" stroke="#bbb" stroke-width="1"/>
  <text x="567" y="328" font-size="10" font-weight="700" fill="#333" text-anchor="middle">Fully Connected</text>
  <line x1="477" y1="335" x2="657" y2="335" stroke="#e0e0e0" stroke-width="0.8"/>
  <text x="475" y="352" font-size="9" fill="#555">Volume: M(N-1) total</text>
  <text x="475" y="368" font-size="9" fill="#555">Latency: O(1) rounds</text>
  <text x="475" y="384" font-size="9" fill="#555">BW utilization: high if N small</text>
  <text x="475" y="402" font-size="9" fill="#999" font-style="italic">Impractical beyond 8 nodes</text>

  <!-- ── Bottom annotation ── -->
  <text x="340" y="440" font-size="9" fill="#999" font-style="italic" text-anchor="middle">N = 4 GPUs, M = model size in bytes. Ring AllReduce is the modern default for dense GPU clusters.</text>

</svg>
