<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arr" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="none" stroke="#a31f34" stroke-width="1.2"/>
    </marker>
    <marker id="arr-rev" markerWidth="8" markerHeight="6" refX="1" refY="3" orient="auto">
      <path d="M8,0 L0,3 L8,6" fill="none" stroke="#a31f34" stroke-width="1.2"/>
    </marker>
  </defs>

  <rect width="680" height="460" fill="#fafafa" rx="3"/>

  <!-- Column 1: Compute -->
  <g transform="translate(28, 42)">
    <rect x="0" y="0" width="188" height="38" rx="4" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.4"/>
    <text x="94" y="24" text-anchor="middle" font-size="12" font-weight="700" fill="#1a3a5c">Compute (C1)</text>
  </g>
  <g transform="translate(28, 92)">
    <rect x="0" y="0" width="188" height="320" rx="4" fill="#f7f7f7" stroke="#bbb" stroke-width="1.0"/>
    <text x="16" y="28" font-size="10" font-weight="700" fill="#333">GPU / TPU Kernels</text>
    <text x="16" y="44" font-size="9" fill="#555">GEMM, attention, activation ops</text>

    <line x1="12" y1="56" x2="176" y2="56" stroke="#e0e0e0" stroke-width="0.6"/>
    <text x="16" y="76" font-size="10" font-weight="700" fill="#333">FLOP Throughput</text>
    <text x="16" y="92" font-size="9" fill="#555">Peak vs. sustained TFLOPS</text>
    <text x="16" y="106" font-size="9" fill="#555">utilization (MFU)</text>

    <line x1="12" y1="118" x2="176" y2="118" stroke="#e0e0e0" stroke-width="0.6"/>
    <text x="16" y="138" font-size="10" font-weight="700" fill="#333">Accelerator Efficiency</text>
    <text x="16" y="154" font-size="9" fill="#555">Arithmetic intensity,</text>
    <text x="16" y="168" font-size="9" fill="#555">roofline position</text>

    <line x1="12" y1="180" x2="176" y2="180" stroke="#e0e0e0" stroke-width="0.6"/>
    <text x="16" y="200" font-size="10" font-weight="700" fill="#333">Memory Hierarchy</text>
    <text x="16" y="216" font-size="9" fill="#555">HBM bandwidth, SRAM</text>
    <text x="16" y="230" font-size="9" fill="#555">capacity, memory wall</text>
  </g>

  <!-- Column 2: Communication -->
  <g transform="translate(246, 42)">
    <rect x="0" y="0" width="188" height="38" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.4"/>
    <text x="94" y="24" text-anchor="middle" font-size="12" font-weight="700" fill="#1a4a2a">Communication (C2)</text>
  </g>
  <g transform="translate(246, 92)">
    <rect x="0" y="0" width="188" height="320" rx="4" fill="#f7f7f7" stroke="#bbb" stroke-width="1.0"/>
    <text x="16" y="28" font-size="10" font-weight="700" fill="#333">Point-to-Point</text>
    <text x="16" y="44" font-size="9" fill="#555">Send/Recv, NVLink, PCIe,</text>
    <text x="16" y="58" font-size="9" fill="#555">InfiniBand RDMA</text>

    <line x1="12" y1="70" x2="176" y2="70" stroke="#e0e0e0" stroke-width="0.6"/>
    <text x="16" y="90" font-size="10" font-weight="700" fill="#333">Collective Operations</text>
    <text x="16" y="106" font-size="9" fill="#555">AllReduce, AllGather,</text>
    <text x="16" y="120" font-size="9" fill="#555">ReduceScatter, AlltoAll</text>

    <line x1="12" y1="132" x2="176" y2="132" stroke="#e0e0e0" stroke-width="0.6"/>
    <text x="16" y="152" font-size="10" font-weight="700" fill="#333">Bandwidth / Latency</text>
    <text x="16" y="168" font-size="9" fill="#555">Bisection BW, network</text>
    <text x="16" y="182" font-size="9" fill="#555">diameter, congestion</text>

    <line x1="12" y1="194" x2="176" y2="194" stroke="#e0e0e0" stroke-width="0.6"/>
    <text x="16" y="214" font-size="10" font-weight="700" fill="#333">Topology</text>
    <text x="16" y="230" font-size="9" fill="#555">Fat-tree, Dragonfly,</text>
    <text x="16" y="244" font-size="9" fill="#555">rail-optimized networks</text>
  </g>

  <!-- Column 3: Coordination -->
  <g transform="translate(464, 42)">
    <rect x="0" y="0" width="188" height="38" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.4"/>
    <text x="94" y="24" text-anchor="middle" font-size="12" font-weight="700" fill="#5a3a10">Coordination (C3)</text>
  </g>
  <g transform="translate(464, 92)">
    <rect x="0" y="0" width="188" height="320" rx="4" fill="#f7f7f7" stroke="#bbb" stroke-width="1.0"/>
    <text x="16" y="28" font-size="10" font-weight="700" fill="#333">Scheduling</text>
    <text x="16" y="44" font-size="9" fill="#555">Job placement, preemption,</text>
    <text x="16" y="58" font-size="9" fill="#555">gang scheduling</text>

    <line x1="12" y1="70" x2="176" y2="70" stroke="#e0e0e0" stroke-width="0.6"/>
    <text x="16" y="90" font-size="10" font-weight="700" fill="#333">Checkpointing</text>
    <text x="16" y="106" font-size="9" fill="#555">State preservation,</text>
    <text x="16" y="120" font-size="9" fill="#555">async checkpoint, recovery</text>

    <line x1="12" y1="132" x2="176" y2="132" stroke="#e0e0e0" stroke-width="0.6"/>
    <text x="16" y="152" font-size="10" font-weight="700" fill="#333">Job Management</text>
    <text x="16" y="168" font-size="9" fill="#555">Slurm, Kubernetes,</text>
    <text x="16" y="182" font-size="9" fill="#555">resource orchestration</text>

    <line x1="12" y1="194" x2="176" y2="194" stroke="#e0e0e0" stroke-width="0.6"/>
    <text x="16" y="214" font-size="10" font-weight="700" fill="#333">Consistency</text>
    <text x="16" y="230" font-size="9" fill="#555">Synchronous vs. async</text>
    <text x="16" y="244" font-size="9" fill="#555">training, CAP trade-offs</text>
  </g>

  <!--
    Bottleneck indicators between columns.
    Gap between C1 (ends x=216) and C2 (starts x=246): center = 231.
    Gap between C2 (ends x=434) and C3 (starts x=464): center = 449.
    Arrow runs horizontally across the 30px gap.
    Label pill sits ABOVE the arrow with clear clearance.
  -->

  <!-- Bottleneck pill: C1 <-> C2 — centered at x=231, above arrow -->
  <rect x="208" y="224" width="46" height="16" rx="8" fill="#fff0f0" stroke="#a31f34" stroke-width="0.9"/>
  <text x="231" y="235" text-anchor="middle" font-size="7" fill="#a31f34" font-weight="700" letter-spacing="0.3">bottleneck</text>
  <!-- Arrow below the pill -->
  <line x1="216" y1="252" x2="246" y2="252" stroke="#a31f34" stroke-width="1.4"
        marker-start="url(#arr-rev)" marker-end="url(#arr)"/>
  <!-- Connector from pill to arrow -->
  <line x1="231" y1="240" x2="231" y2="249" stroke="#a31f34" stroke-width="0.7" stroke-dasharray="2,1"/>

  <!-- Bottleneck pill: C2 <-> C3 — centered at x=449, above arrow -->
  <rect x="426" y="224" width="46" height="16" rx="8" fill="#fff0f0" stroke="#a31f34" stroke-width="0.9"/>
  <text x="449" y="235" text-anchor="middle" font-size="7" fill="#a31f34" font-weight="700" letter-spacing="0.3">bottleneck</text>
  <!-- Arrow below the pill -->
  <line x1="434" y1="252" x2="464" y2="252" stroke="#a31f34" stroke-width="1.4"
        marker-start="url(#arr-rev)" marker-end="url(#arr)"/>
  <!-- Connector from pill to arrow -->
  <line x1="449" y1="240" x2="449" y2="249" stroke="#a31f34" stroke-width="0.7" stroke-dasharray="2,1"/>

  <!-- Bottom summary line -->
  <rect x="28" y="424" width="624" height="24" rx="3" fill="white" stroke="#ddd" stroke-width="0.8"/>
  <text x="340" y="440" text-anchor="middle" font-size="9" fill="#555" font-weight="600">Every distributed ML bottleneck maps to one of these three dimensions</text>
</svg>
