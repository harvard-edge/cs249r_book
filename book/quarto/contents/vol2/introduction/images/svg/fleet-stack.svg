<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arr-up" markerWidth="7" markerHeight="5" refX="3.5" refY="0" orient="auto">
      <path d="M0,5 L3.5,0 L7,5" fill="none" stroke="#888" stroke-width="0.8"/>
    </marker>
  </defs>

  <rect width="680" height="460" fill="#fafafa" rx="3"/>

  <!-- Left axis label + arrow -->
  <text x="18" y="230" text-anchor="middle" font-size="8.5" fill="#aaa" font-weight="500"
        transform="rotate(-90, 18, 230)">Hardware ··················· Software</text>
  <line x1="38" y1="425" x2="38" y2="22" stroke="#ccc" stroke-width="0.8" marker-end="url(#arr-up)"/>

  <!--
    Layout:
      7 layers, each h=50, gap=6
      Total stack = 7×50 + 6×6 = 350+36 = 386px
      Top margin = 22px → bottom = 22+386 = 408px  ✓ well inside 460
      Layer rects: x=54, width=526, right=580
      Brackets:    x=586, width=44, right=630  ✓ inside 680
      Left label text: x=90 (inside rect, left-anchored)
      Detail text: x=340 (centered in the full layer width, avoiding label area)
                   but label col ≈ 54..220 → detail starts after x=230
                   Use text-anchor="start" x=230 for detail lines
  -->

  <!-- ── LAYER 7 (top): Experiment Tracking  y=22..72 ── -->
  <rect x="54" y="22" width="526" height="50" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="90" y="48" font-size="11" font-weight="700" fill="#1a4a2a">Experiment Tracking</text>
  <text x="310" y="41" text-anchor="middle" font-size="9"   fill="#555">MLflow  |  W&amp;B  |  TensorBoard</text>
  <text x="310" y="54" text-anchor="middle" font-size="8.5" fill="#888" font-style="italic">Metrics logging, model registry, artifact storage</text>

  <!-- ── LAYER 6: Job Scheduler  y=78..128 ── -->
  <rect x="54" y="78" width="526" height="50" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="90" y="104" font-size="11" font-weight="700" fill="#1a4a2a">Job Scheduler</text>
  <text x="310" y="97" text-anchor="middle" font-size="9"   fill="#555">Slurm  |  Kubernetes  |  YARN</text>
  <text x="310" y="110" text-anchor="middle" font-size="8.5" fill="#888" font-style="italic">Resource allocation, queuing, preemption</text>

  <!-- ── LAYER 5: Distributed Orchestration  y=134..184 ── -->
  <rect x="54" y="134" width="526" height="50" rx="4" fill="#b8d4e8" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="90" y="160" font-size="11" font-weight="700" fill="#1a3a5c">Distributed Orchestration</text>
  <!-- detail text shifted right to clear the long label (~220px) -->
  <text x="390" y="153" text-anchor="middle" font-size="9"   fill="#555">torch.distributed  |  Megatron-LM  |  DeepSpeed  |  FSDP</text>
  <text x="390" y="166" text-anchor="middle" font-size="8.5" fill="#888" font-style="italic">Parallelism strategies, gradient sync, pipeline scheduling</text>

  <!-- ── LAYER 4: Training Framework  y=190..240 ── -->
  <rect x="54" y="190" width="526" height="50" rx="4" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="90" y="216" font-size="11" font-weight="700" fill="#1a3a5c">Training Framework</text>
  <text x="370" y="209" text-anchor="middle" font-size="9"   fill="#555">PyTorch  |  JAX  |  TensorFlow</text>
  <text x="370" y="222" text-anchor="middle" font-size="8.5" fill="#888" font-style="italic">Autograd, tensor ops, model definition</text>

  <!-- ── LAYER 3: Collective Library  y=246..296 ── -->
  <rect x="54" y="246" width="526" height="50" rx="4" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.2"/>
  <text x="90" y="272" font-size="11" font-weight="700" fill="#1a3a5c">Collective Library</text>
  <text x="370" y="265" text-anchor="middle" font-size="9"   fill="#555">NCCL  |  Gloo  |  MPI  |  RCCL</text>
  <text x="370" y="278" text-anchor="middle" font-size="8.5" fill="#888" font-style="italic">AllReduce, AllGather, point-to-point primitives</text>

  <!-- ── LAYER 2: Drivers / Firmware  y=302..352 ── -->
  <rect x="54" y="302" width="526" height="50" rx="4" fill="#e0e0e0" stroke="#999" stroke-width="1.2"/>
  <text x="90" y="328" font-size="11" font-weight="700" fill="#444">Drivers / Firmware</text>
  <text x="370" y="321" text-anchor="middle" font-size="9"   fill="#555">CUDA Driver  |  GPU Firmware  |  BIOS  |  BMC</text>
  <text x="370" y="334" text-anchor="middle" font-size="8.5" fill="#888" font-style="italic">Low-level hardware abstraction</text>

  <!-- ── LAYER 1 (bottom): Hardware  y=358..408 ── -->
  <rect x="54" y="358" width="526" height="50" rx="4" fill="#e8e8e8" stroke="#999" stroke-width="1.2"/>
  <text x="90" y="384" font-size="11" font-weight="700" fill="#444">Hardware</text>
  <text x="370" y="377" text-anchor="middle" font-size="9"   fill="#555">GPUs  |  NVLink  |  InfiniBand  |  NVMe  |  Power / Cooling</text>
  <text x="370" y="390" text-anchor="middle" font-size="8.5" fill="#888" font-style="italic">Physical silicon, interconnect, storage media</text>

  <!--
    Side brackets — x=586, width=44, right=630
    Operational: layers 6-7  → y=22,  height=106  (22 to 128)
    Logical:     layers 3-5  → y=134, height=162  (134 to 296)
    Physical:    layers 1-2  → y=302, height=106  (302 to 408)
    Each bracket center x = 586+22 = 608
  -->

  <!-- Operational (green) -->
  <rect x="586" y="22" width="44" height="106" rx="3" fill="none" stroke="#3d9e5a" stroke-width="0.9" stroke-dasharray="4,2"/>
  <text x="608" y="75" text-anchor="middle" font-size="7.5" fill="#3d9e5a" font-weight="600"
        transform="rotate(-90, 608, 75)">Operational</text>

  <!-- Logical (blue) -->
  <rect x="586" y="134" width="44" height="162" rx="3" fill="none" stroke="#4a90c4" stroke-width="0.9" stroke-dasharray="4,2"/>
  <text x="608" y="215" text-anchor="middle" font-size="7.5" fill="#4a90c4" font-weight="600"
        transform="rotate(-90, 608, 215)">Logical</text>

  <!-- Physical (grey) -->
  <rect x="586" y="302" width="44" height="106" rx="3" fill="none" stroke="#999" stroke-width="0.9" stroke-dasharray="4,2"/>
  <text x="608" y="355" text-anchor="middle" font-size="7.5" fill="#888" font-weight="600"
        transform="rotate(-90, 608, 355)">Physical</text>

</svg>
