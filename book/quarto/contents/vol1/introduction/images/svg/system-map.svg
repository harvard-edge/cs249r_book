<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 460"
     font-family="Helvetica Neue, Helvetica, Arial, sans-serif">

  <defs>
    <marker id="arr" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#555"/>
    </marker>
    <marker id="arr-green" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#3d9e5a"/>
    </marker>
  </defs>

  <!-- ── Background ── -->
  <rect width="680" height="460" fill="white"/>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- ── (A) Single-Machine Stack (left) ── -->
  <!-- ═══════════════════════════════════════════════════════ -->

  <text x="170" y="38" text-anchor="middle" font-size="11" font-weight="700" fill="#333">A. Single-Machine Stack</text>
  <text x="170" y="54" text-anchor="middle" font-size="8.5" fill="#888">1–8 GPUs, shared memory</text>

  <!-- Layer 4 top: Application -->
  <rect x="50" y="68" width="240" height="44" rx="4" fill="#f9d6d5" stroke="#c44" stroke-width="1.2"/>
  <text x="170" y="87" text-anchor="middle" font-size="10" font-weight="700" fill="#8b1a1a">Application</text>
  <text x="170" y="101" text-anchor="middle" font-size="8.5" fill="#555">Training loop / inference</text>

  <!-- Layer 3: ML Framework -->
  <rect x="50" y="122" width="240" height="44" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.2"/>
  <text x="170" y="141" text-anchor="middle" font-size="10" font-weight="700" fill="#5a3a10">ML Framework</text>
  <text x="170" y="155" text-anchor="middle" font-size="8.5" fill="#555">PyTorch / JAX / CUDA kernels</text>

  <!-- Layer 2: Operating System -->
  <rect x="50" y="176" width="240" height="44" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="170" y="195" text-anchor="middle" font-size="10" font-weight="700" fill="#1a4a2a">Operating System</text>
  <text x="170" y="209" text-anchor="middle" font-size="8.5" fill="#555">CUDA runtime, PCIe DMA</text>

  <!-- Layer 1 bottom: Hardware -->
  <rect x="50" y="230" width="240" height="44" rx="4" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="170" y="249" text-anchor="middle" font-size="10" font-weight="700" fill="#1a3a5c">Hardware (PCIe / HBM)</text>
  <text x="170" y="263" text-anchor="middle" font-size="8.5" fill="#555">GPU ↔ GPU: NVLink 900 GB/s</text>

  <!-- Bottleneck annotation A -->
  <rect x="50" y="284" width="240" height="28" rx="3" fill="rgba(163,31,52,0.06)" stroke="#a31f34" stroke-width="0.8" stroke-dasharray="4,3"/>
  <text x="170" y="302" text-anchor="middle" font-size="8.5" font-weight="700" fill="#a31f34">Bottleneck: Memory Wall (HBM bandwidth)</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- ── Scaling arrow (center) ── -->
  <!-- ═══════════════════════════════════════════════════════ -->

  <line x1="310" y1="230" x2="376" y2="230" stroke="#3d9e5a" stroke-width="2.5" marker-end="url(#arr-green)"/>
  <text x="340" y="220" text-anchor="middle" font-size="9" font-weight="700" fill="#3d9e5a">Scaling</text>
  <text x="340" y="244" text-anchor="middle" font-size="7.5" fill="#888">Vol. I → Vol. II</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- ── (B) Fleet Stack (right) ── -->
  <!-- ═══════════════════════════════════════════════════════ -->

  <text x="510" y="38" text-anchor="middle" font-size="11" font-weight="700" fill="#333">B. Fleet Stack</text>
  <text x="510" y="54" text-anchor="middle" font-size="8.5" fill="#888">1,000–100,000+ GPUs, message passing</text>

  <!-- Layer 4 top: Governance -->
  <rect x="390" y="68" width="240" height="44" rx="4" fill="#e8d5f5" stroke="#7b2d8b" stroke-width="1.2"/>
  <text x="510" y="87" text-anchor="middle" font-size="10" font-weight="700" fill="#4a1460">Governance</text>
  <text x="510" y="101" text-anchor="middle" font-size="8.5" fill="#555">Responsible AI, Privacy, Robustness</text>

  <!-- Layer 3: Serving / Ops -->
  <rect x="390" y="122" width="240" height="44" rx="4" fill="#fdebd0" stroke="#c87b2a" stroke-width="1.2"/>
  <text x="510" y="141" text-anchor="middle" font-size="10" font-weight="700" fill="#5a3a10">Serving / Ops</text>
  <text x="510" y="155" text-anchor="middle" font-size="8.5" fill="#555">Fleet orchestration, CI/CD, inference</text>

  <!-- Layer 2: Distribution -->
  <rect x="390" y="176" width="240" height="44" rx="4" fill="#d4edda" stroke="#3d9e5a" stroke-width="1.2"/>
  <text x="510" y="195" text-anchor="middle" font-size="10" font-weight="700" fill="#1a4a2a">Distribution</text>
  <text x="510" y="209" text-anchor="middle" font-size="8.5" fill="#555">NCCL, RDMA, collective comms</text>

  <!-- Layer 1 bottom: Infrastructure -->
  <rect x="390" y="230" width="240" height="44" rx="4" fill="#cfe2f3" stroke="#4a90c4" stroke-width="1.5"/>
  <text x="510" y="249" text-anchor="middle" font-size="10" font-weight="700" fill="#1a3a5c">Infrastructure (Fabric / RDMA)</text>
  <text x="510" y="263" text-anchor="middle" font-size="8.5" fill="#555">InfiniBand NDR 400 Gb/s · Ethernet</text>

  <!-- Bottleneck annotation B -->
  <rect x="390" y="284" width="240" height="28" rx="3" fill="rgba(163,31,52,0.06)" stroke="#a31f34" stroke-width="0.8" stroke-dasharray="4,3"/>
  <text x="510" y="302" text-anchor="middle" font-size="8.5" font-weight="700" fill="#a31f34">Bottleneck: Bisection Bandwidth Wall</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- ── Chapter map (bottom) ── -->
  <!-- ═══════════════════════════════════════════════════════ -->

  <text x="340" y="340" text-anchor="middle" font-size="10" font-weight="700" fill="#333">Volume II Chapter Map</text>
  <line x1="40" y1="348" x2="638" y2="348" stroke="#e8e8e8" stroke-width="1"/>

  <!-- Infrastructure tier label -->
  <text x="40" y="368" font-size="8.5" font-weight="700" fill="#4a90c4">Infrastructure:</text>
  <text x="128" y="368" font-size="8.5" fill="#555">Compute · Storage · Network Fabrics · Collective Comms</text>

  <!-- Distribution tier label -->
  <text x="40" y="386" font-size="8.5" font-weight="700" fill="#3d9e5a">Distribution:</text>
  <text x="120" y="386" font-size="8.5" fill="#555">Distributed Training · Fleet Orchestration · Fault Tolerance</text>

  <!-- Serving tier label -->
  <text x="40" y="404" font-size="8.5" font-weight="700" fill="#c87b2a">Serving / Ops:</text>
  <text x="126" y="404" font-size="8.5" fill="#555">Inference · Performance Engineering · Ops at Scale</text>

  <!-- Governance tier label -->
  <text x="40" y="422" font-size="8.5" font-weight="700" fill="#7b2d8b">Governance:</text>
  <text x="120" y="422" font-size="8.5" fill="#555">Responsible AI · Robust AI · Security · Sustainable AI · Edge</text>

  <!-- Bottom footnote -->
  <text x="340" y="448" text-anchor="middle" font-size="8.5" fill="#999" font-style="italic">Vol. I mastered the single-machine stack; Vol. II engineers the fleet.</text>

</svg>
