index_prune_candidates:
  generated_date: 2026-02-09
  scope:
    volume: vol1
    qmd_glob: book/quarto/contents/vol1/**/*.qmd

  principles:
    - Keep an index that survives specific tools, product SKUs, and one-off case studies.
    - Prefer timeless concepts (laws, invariants, core architectures, core methods) over fleeting implementations.
    - Reduce bloat by collapsing most subentries into their parent term.
    - Keep subentries only when they function as durable *navigation anchors* (e.g., equations or named structural components), not as prose annotations.

  global_rules:
    - id: simplify-subentries
      match: "any index entry containing '!'" # e.g., "Data Drift!monitoring threshold"
      action: simplify
      simplify_to: "the substring before the first '!'" # "Data Drift"
      rationale: "Subentries create most of the bloat; keep the durable parent concept unless the subentry is a durable navigation anchor (see keep-subentries-allowlist)."

    - id: keep-subentries-allowlist
      match: "subentry suffix is one of: equation, architecture, components, taxonomy"
      action: keep
      rationale: "A small number of subentries are useful as stable navigation anchors (e.g., pointing readers to a chapter-defining equation or a canonical decomposition)."

    - id: drop-redirects
      match: "any index entry containing '|see{...}' or '|seealso{...}'"
      action: drop
      rationale: "Redirects multiply index surface area; keep the canonical term instead."

    - id: drop-etymology-definition-history
      match: "entries whose subentry suffix is exactly one of: definition, etymology, history, origin"
      action: simplify
      simplify_to: "parent term"
      rationale: "The parent term is what readers search for; these suffixes rarely help navigation."

    - id: collapse-vs-and-comparison-subentries
      match: "entries whose subentry suffix starts with 'vs.' or contains 'comparison'"
      action: simplify
      simplify_to: "parent term"
      rationale: "Comparison/context subentries fragment navigation. Keep the parent concept; readers will find comparisons in the prose."

    - id: collapse-case-study-subentries
      match: "entries whose subentry suffix contains 'case study'"
      action: simplify
      simplify_to: "parent term"
      rationale: "Case studies age; index the concept, not the example."

    - id: collapse-deployment-context-subentries
      match: "entries whose subentry suffix is primarily a deployment context (cloud/datacenter/mobile/edge/TinyML)"
      action: simplify
      simplify_to: "parent term"
      rationale: "Deployment context is usually an example of the parent term rather than a distinct indexable concept."

    - id: drop-product-skus
      match: "product SKUs and versioned hardware (e.g., 'NVIDIA!K80', 'TPU!v1 ...')"
      action: drop
      rationale: "Too specific; unlikely to age well compared to the concept (GPU, TPU, accelerator)."

    - id: drop-tooling-implementations
      match: "specific tool/runtime/compiler/library names when a broader concept exists"
      action: drop
      rationale: "Prefer the enduring idea (graph compilation, inference compiler, serialization) to a specific implementation."

    - id: drop-person-index
      match: "person-name index entries unless the person is the only stable label for the concept"
      action: drop
      rationale: "Most people references are better indexed by the concept (Amdahl's Law, Moore's Law, etc.)."

  second_pass:
    focus: "subentry collapse"
    keep_subentry_suffix_allowlist:
      - equation
      - architecture
      - components
      - taxonomy

    simplify_subentries_examples:
      # These are representative examples to apply systematically (via the global rules),
      # not an exhaustive list.
      - file: book/quarto/contents/vol1/introduction/introduction.qmd
        examples:
          - from: "Iron Law of ML Systems!equation"
            to: "Iron Law of ML Systems"
            reason: "equation is part of the core concept; subentry is rarely needed"
          - from: "Moore's Law!comparison to AI scaling"
            to: "Moore's Law"
            reason: "comparison subentries fragment navigation"
          - from: "Latency!etymology"
            to: "Latency"
            reason: "collapse etymology suffix"

      - file: book/quarto/contents/vol1/ml_systems/ml_systems.qmd
        examples:
          - from: "Power Wall!thermal limits"
            to: "Power Wall"
            reason: "inherent characteristic, not a durable subtopic"
          - from: "Memory Wall!compute-memory gap"
            to: "Memory Wall"
            reason: "inherent characteristic, not a durable subtopic"
          - from: "Cloud ML!resource elasticity"
            to: "Cloud ML"
            reason: "deployment-context subentry"

      - file: book/quarto/contents/vol1/workflow/workflow.qmd
        examples:
          - from: "ML Lifecycle!definition"
            to: "ML Lifecycle"
            reason: "collapse definition suffix"
          - from: "Deployment!progressive strategies!canary deployment"
            to: "Deployment"
            reason: "nested subentry; strategy details belong in prose"

      - file: book/quarto/contents/vol1/ops/ops.qmd
        examples:
          - from: "Correction Cascades!Zillow case study"
            to: "Correction Cascades"
            reason: "case study subentry adds bloat"
          - from: "MLOps!DevOps comparison"
            to: "MLOps"
            reason: "comparison subentry"

      - file: book/quarto/contents/vol1/serving/serving.qmd
        examples:
          - from: "Static Inference!pre-computed predictions"
            to: "Static Inference"
            reason: "inherent description"
          - from: "REST!HTTP/1.1 protocol"
            to: "REST"
            reason: "implementation detail"

      - file: book/quarto/contents/vol1/data_engineering/data_engineering.qmd
        examples:
          - from: "Data Gravity!physics of"
            to: "Data Gravity"
            reason: "context label; keep the parent concept"
          - from: "Information Entropy!data density"
            to: "Information Entropy"
            reason: "context label; keep the parent concept"

      - file: book/quarto/contents/vol1/data_selection/data_selection.qmd
        examples:
          - from: "Coreset!etymology"
            to: "Coreset"
            reason: "collapse etymology suffix"
          - from: "Selection Inequality!definition"
            to: "Selection Inequality"
            reason: "collapse definition suffix"

      - file: book/quarto/contents/vol1/benchmarking/benchmarking.qmd
        examples:
          - from: "Throughput!etymology"
            to: "Throughput"
            reason: "collapse etymology suffix"
          - from: "Benchmarking!definition"
            to: "Benchmarking"
            reason: "collapse definition suffix"

      - file: book/quarto/contents/vol1/training/training.qmd
        examples:
          - from: "Epoch!definition"
            to: "Epoch"
            reason: "collapse definition suffix"
          - from: "FlashAttention!etymology"
            to: "FlashAttention"
            reason: "collapse etymology suffix"

      - file: book/quarto/contents/vol1/dnn_architectures/dnn_architectures.qmd
        examples:
          - from: "Transformer!definition"
            to: "Transformer"
            reason: "collapse definition suffix"
          - from: "Skip Connection!etymology"
            to: "Skip Connection"
            reason: "collapse etymology suffix"

      - file: book/quarto/contents/vol1/frameworks/frameworks.qmd
        examples:
          - from: "Computational Graph!definition (DAG)"
            to: "Computational Graph"
            reason: "collapse definition suffix"
          - from: "Tensor!etymology"
            to: "Tensor"
            reason: "collapse etymology suffix"

      - file: book/quarto/contents/vol1/hw_acceleration/hw_acceleration.qmd
        examples:
          - from: "Tiling!definition"
            to: "Tiling"
            reason: "collapse definition suffix"
          - from: "CUDA!etymology"
            to: "CUDA"
            reason: "collapse etymology suffix"

      - file: book/quarto/contents/vol1/responsible_engr/responsible_engr.qmd
        examples:
          - from: "Bias!proxy variables"
            to: "Bias"
            reason: "subentry is an example/aspect"
          - from: "Disparate Impact!etymology"
            to: "Disparate Impact"
            reason: "collapse etymology suffix"

      - file: book/quarto/contents/vol1/optimizations/model_compression.qmd
        examples:
          - from: "Pruning!structured"
            to: "Pruning"
            reason: "overly granular variant; keep parent unless the volume explicitly needs taxonomy"
          - from: "Knowledge Distillation!teacher-student framework"
            to: "Knowledge Distillation"
            reason: "definition-like subentry"

      - file: book/quarto/contents/vol1/conclusion/conclusion.qmd
        examples:
          - from: "Conservation of Complexity!meta-principle"
            to: "Conservation of Complexity"
            reason: "collapse meta/principle labeling into parent"

  chapters:
    - file: book/quarto/contents/vol1/introduction/introduction.qmd
      drop_exact:
        # Redirects (keep canonical term).
        - entry: "AI Triad|see{D·A·M taxonomy}"
          reason: "redirect to canonical"
        - entry: "Data as Source Code|see{Software 2.0}"
          reason: "redirect to canonical"
        - entry: "Distribution Shift|see{Data Drift}"
          reason: "redirect to canonical"
        - entry: "Training-Serving Skew|see{Training-Serving Divide}"
          reason: "redirect to canonical"

        # One-off systems / minor artifacts.
        - entry: "MYCIN!expert system for diagnosis"
          reason: "one-off proper noun (historical example)"
        - entry: "Viola-Jones Algorithm!real-time face detection"
          reason: "specific algorithm; not central to ML systems indexing"

        # Overly specific historical bookkeeping.
        - entry: "Machine Learning!term coined (1959)"
          reason: "timestamped trivia; keep 'Machine Learning'"

    - file: book/quarto/contents/vol1/ml_systems/ml_systems.qmd
      drop_exact:
        - entry: "deployment paradigms|see{ML systems}"
          reason: "redirect to canonical"
        - entry: "thermal design power (TDP)|see{Power Wall}"
          reason: "redirect to canonical"
        - entry: "memory bandwidth|see{Memory Wall}"
          reason: "redirect to canonical"
        - entry: "KWS|see{Keyword Spotting}"
          reason: "redirect to canonical"

        # See-also entries are often bloat once the paradigms exist as entries.
        - entry: "Cloud ML|seealso{Edge ML}"
          reason: "see-also bloat; keep the paradigm entries"
        - entry: "Edge ML|seealso{Mobile ML}"
          reason: "see-also bloat; keep the paradigm entries"
        - entry: "Mobile ML|seealso{TinyML}"
          reason: "see-also bloat; keep the paradigm entries"

    - file: book/quarto/contents/vol1/workflow/workflow.qmd
      drop_exact:
        # Prefer concepts over one specific KPI / diagnostic name.
        - entry: "Population Stability Index!drift detection"
          reason: "implementation-specific metric name; keep 'Data Drift'/'Drift Detection'"

    - file: book/quarto/contents/vol1/conclusion/conclusion.qmd
      drop_exact:
        - entry: "Hennessy and Patterson!new golden age"
          reason: "person subentry; keep concept-level entries instead"

    - file: book/quarto/contents/vol1/dl_primer/dl_primer.qmd
      drop_exact:
        # Redirects
        - entry: "Multiply-Accumulate|see{MAC Operations}"
          reason: "redirect to canonical"

        # Technique/tool-level items that are too fine-grained for a systems index.
        - entry: "HOG Method!feature extraction"
          reason: "specific technique"
        - entry: "SIFT!scale-invariant features"
          reason: "specific technique"

    - file: book/quarto/contents/vol1/dnn_architectures/dnn_architectures.qmd
      drop_exact:
        # Redirects
        - entry: "Residual Connection|see{Skip Connection}"
          reason: "redirect to canonical"
        - entry: "MLP|see{Multi-Layer Perceptron}"
          reason: "redirect to canonical"

        # Datasets / trivia that age poorly in a systems index.
        - entry: "MNIST"
          reason: "dataset name; not essential for this volume's index"

        # Cleanup/inconsistency candidates
        - entry: "CNN!parameter sharing|see{Convolution, parameter sharing}"
          reason: "inconsistent naming/redirect; prefer a single canonical term"
        - entry: "Kernel (filter)|see{Convolution, kernel}"
          reason: "redirect bloat; keep canonical 'Convolution' or 'Kernel'"
        - entry: "Multi-Layer Perceptron!dense connectivity|see{Dense Connectivity}"
          reason: "circular/ambiguous redirect; keep canonical"

    - file: book/quarto/contents/vol1/frameworks/frameworks.qmd
      drop_exact:
        # Tooling / implementation-specific items
        - entry: "Triton!GPU kernel language"
          reason: "tool-specific implementation"
        - entry: "ONNX Runtime!compilation backend"
          reason: "tool-specific implementation"
        - entry: "TensorRT!inference compiler"
          reason: "tool-specific implementation"
        - entry: "TensorFlow Lite Micro!extreme AOT"
          reason: "tool-specific implementation"

        # Low-level compiler passes (too general / not ML-specific).
        - entry: "Dead Code Elimination"
          reason: "general compiler optimization; too broad for this index"
        - entry: "Constant Folding"
          reason: "general compiler optimization; too broad for this index"
        - entry: "Single Static Assignment!compiler IR"
          reason: "compiler IR detail; too deep for this index"

        # Redirects
        - entry: "Just-in-Time Compilation|see{JIT Compilation}"
          reason: "redirect to canonical"
        - entry: "Backpropagation|see{Reverse Mode AD}"
          reason: "keep canonical 'Backpropagation' elsewhere; drop redirect"
        - entry: "Activation Checkpointing|see{Gradient Checkpointing}"
          reason: "redirect bloat; keep one canonical term"

    - file: book/quarto/contents/vol1/training/training.qmd
      drop_exact:
        # Library / interconnect / implementation specifics
        - entry: "InfiniBand!interconnect performance"
          reason: "hardware SKU-like detail; keep 'interconnect' concepts"
        - entry: "NVLink!training interconnect"
          reason: "vendor-specific"
        - entry: "NCCL!gradient communication"
          reason: "library-specific"
        - entry: "cuBLAS!hardware-accelerated linear algebra"
          reason: "library-specific"
        - entry: "cuDNN!optimized implementations"
          reason: "library-specific"

        # Redirects
        - entry: "GEMM|see{Matrix Multiplication}"
          reason: "redirect to canonical"
        - entry: "SGD|see{Stochastic Gradient Descent}"
          reason: "redirect to canonical"
        - entry: "Gradient Checkpointing|see{Activation Checkpointing}"
          reason: "redirect bloat; keep one canonical term"
        - entry: "Rematerialization|see{Activation Checkpointing}"
          reason: "redirect bloat; keep one canonical term"

        # Very specific techniques / trivia
        - entry: "Strassen's Algorithm!matrix multiplication"
          reason: "theoretical detail; not central to systems training index"
        - entry: "BPE!tokenization"
          reason: "tokenization detail; keep higher-level tokenization/LLM entries"

    - file: book/quarto/contents/vol1/data_selection/data_selection.qmd
      drop_exact:
        # Specific algorithm acronyms that likely do not age as index entries.
        - entry: "EL2N!definition"
          reason: "algorithm-specific acronym"
        - entry: "GraNd!gradient-based coreset scoring"
          reason: "algorithm-specific acronym"

        # Redirects
        - entry: "Facility Location|see{k-Center Algorithm}"
          reason: "redirect to canonical"

    - file: book/quarto/contents/vol1/data_engineering/data_engineering.qmd
      drop_exact:
        - entry: "Data as Code|see{Data Engineering}"
          reason: "redirect to canonical"
        - entry: "SpecAugment!audio augmentation"
          reason: "specific augmentation recipe"

    - file: book/quarto/contents/vol1/benchmarking/benchmarking.qmd
      drop_exact:
        # Redirects
        - entry: "Benchmark|see{Benchmarking}"
          reason: "redirect to canonical"

        # Historical benchmark names (keep the concepts: benchmarking methodology, reproducibility, roofline).
        - entry: "Whetstone!synthetic floating-point benchmark"
          reason: "one-off benchmark name"
        - entry: "LINPACK!matrix operations benchmark"
          reason: "one-off benchmark name"
        - entry: "DAWNBench!time-to-accuracy evaluation"
          reason: "one-off benchmark name"

        # Dataset/benchmark suites that tend to churn (keep one or two canonical anchors only if desired).
        - entry: "COCO!object detection dataset"
          reason: "dataset name; likely too specific"
        - entry: "CIFAR-10!classification reference dataset"
          reason: "dataset name; likely too specific"
        - entry: "SQuAD!reading comprehension dataset"
          reason: "dataset name; likely too specific"
        - entry: "GLUE!language understanding benchmark"
          reason: "benchmark suite name; likely too specific"
        - entry: "SuperGLUE!successor benchmark"
          reason: "benchmark suite name; likely too specific"
        - entry: "HELM!holistic LLM evaluation"
          reason: "benchmark suite name; likely too specific"
        - entry: "MMLU!multitask language understanding"
          reason: "benchmark suite name; likely too specific"
        - entry: "DataComp!data-centric benchmark"
          reason: "benchmark suite name; likely too specific"

        # Person entries
        - entry: "Patterson, David!MLPerf leadership"
          reason: "person subentry; keep MLPerf"
        - entry: "Williams, Samuel!roofline model developer"
          reason: "person subentry; keep Roofline Model"

    - file: book/quarto/contents/vol1/ops/ops.qmd
      drop_exact:
        # Case-study subentries (keep the concept entry, not the company tag).
        - entry: "Feedback Loops!YouTube case study"
          reason: "case study subentry"
        - entry: "Correction Cascades!Zillow case study"
          reason: "case study subentry"
        - entry: "Undeclared Consumers!Tesla case study"
          reason: "case study subentry"
        - entry: "Configuration Debt!Facebook case study"
          reason: "case study subentry"

    - file: book/quarto/contents/vol1/hw_acceleration/hw_acceleration.qmd
      drop_exact:
        # Redirects
        - entry: "Google TPU|see{TPU}"
          reason: "redirect to canonical"
        - entry: "DSA|see{Domain-Specific Architecture}"
          reason: "redirect to canonical"
        - entry: "GPU|see{ML Accelerator}"
          reason: "redirect bloat; keep canonical GPU and/or ML Accelerator"
        - entry: "TPU|see{ML Accelerator}"
          reason: "redirect bloat; keep canonical TPU and/or ML Accelerator"
        - entry: "High Bandwidth Memory|see{HBM}"
          reason: "redirect to canonical"

        # Product SKUs
        - entry: "NVIDIA!K80"
          reason: "product SKU"
        - entry: "NVIDIA!GeForce 256"
          reason: "product SKU"
        - entry: "NVIDIA!H100"
          reason: "product SKU"
        - entry: "Intel 8087!floating-point coprocessor"
          reason: "product SKU"
        - entry: "TPU!v1 efficiency shock"
          reason: "version-specific"

    - file: book/quarto/contents/vol1/optimizations/model_compression.qmd
      drop_exact:
        # Redirects
        - entry: "Model Optimization|see{Model Compression}"
          reason: "redirect to canonical"
        - entry: "Network Pruning|see{Pruning}"
          reason: "redirect to canonical"
        - entry: "Weight Pruning|see{Pruning}"
          reason: "redirect to canonical"
        - entry: "Structured Pruning|see{Pruning}"
          reason: "redirect to canonical"

        # Paper-name and person-name indexing (prefer concept-level entries)
        - entry: "Optimal Brain Damage!LeCun 1989"
          reason: "paper reference; prefer 'Pruning'"
        - entry: "Optimal Brain Surgeon!Hassibi 1993"
          reason: "paper reference; prefer 'Pruning'"
        - entry: "Han, Song!modern pruning revival"
          reason: "person subentry"
        - entry: "Frankle, Jonathan!lottery ticket hypothesis"
          reason: "person subentry"
        - entry: "Hinton, Geoffrey!knowledge distillation"
          reason: "person subentry"

        # Deep math details (optional; keep only if the index is meant to serve as a math glossary too)
        - entry: "Hadamard Product!pruning mask"
          reason: "math detail; optional for this volume's index"
        - entry: "Kullback-Leibler divergence"
          reason: "math detail; optional for this volume's index"

    - file: book/quarto/contents/vol1/serving/serving.qmd
      drop_exact:
        # Tooling
        - entry: "TensorFlow Serving"
          reason: "tool-specific implementation"
        - entry: "FlatBuffers!zero-copy serialization"
          reason: "tool-specific implementation"
        - entry: "Protocol Buffers!serialization"
          reason: "tool-specific implementation"

        # Redirects
        - entry: "Service Level Objective|see{SLO}"
          reason: "redirect bloat; keep SLO (Service Level Objective)"
        - entry: "Batch Inference|see{Static Inference}"
          reason: "redirect bloat; keep canonical term"
        - entry: "Offline Inference|see{Static Inference}"
          reason: "redirect bloat; keep canonical term"
        - entry: "Online Inference|see{Dynamic Inference}"
          reason: "redirect bloat; keep canonical term"
        - entry: "Real-Time Inference|see{Dynamic Inference}"
          reason: "redirect bloat; keep canonical term"
        - entry: "mlock|see{Memory Locking}"
          reason: "redirect bloat; keep canonical term"
        - entry: "p99 Latency|see{Tail Latency}"
          reason: "redirect bloat; keep canonical term"

        # Low-level tensor layout trivia
        - entry: "NCHW!tensor layout"
          reason: "implementation detail"
        - entry: "NHWC!tensor layout"
          reason: "implementation detail"

    - file: book/quarto/contents/vol1/responsible_engr/responsible_engr.qmd
      drop_exact:
        # One-off systems/studies
        - entry: "COMPAS!recidivism algorithm audit"
          reason: "one-off system"
        - entry: "Gender Shades Study!algorithmic audit methodology"
          reason: "one-off study"
        - entry: "Image Cropping!racial bias"
          reason: "one-off case study"

        # Redirects
        - entry: "Proxy Variables|see{Bias}"
          reason: "redirect to canonical"
        - entry: "Model Degradation|see{Silent Failures}"
          reason: "redirect to canonical"
