# =============================================================================
# VOLUME II PDF CONFIGURATION — COPYEDIT VERSION (Double-spaced, 9pt)
# =============================================================================
# Double-spaced PDF for MIT Press copyediting workflow.
# Output: Single pages (not spreads), double line spacing for annotation.
#
# Usage:
#   cp config/_quarto-pdf-vol2-copyedit.yml _quarto.yml
#   quarto render --to titlepage-pdf
#
# Note: This produces a much longer PDF (~2x pages) due to double spacing.
# Use _quarto-pdf-vol2.yml for the final single-spaced production PDF.
# =============================================================================

project:
  type: book
  output-dir: _build/pdf-vol2-copyedit
  execute-dir: project
  post-render:
    - scripts/clean_svgs.py
  preview:
    browser: true
    navigate: true

execute:
  freeze: auto
  env:
    PYTHONPATH: "."

book:
  favicon: assets/images/icons/favicon.png
  cover-image: assets/images/covers/cover-hardcover-book-vol2.png
  cover-image-alt: "Cover image."

  title: "Advanced Machine Learning Systems"
  subtitle: "COPYEDIT VERSION — Double-Spaced"

  date: today
  date-format: long

  author:
    name: Vijay Janapa Reddi
    email: vj@eecs.harvard.edu
    url: https://www.google.com/search?q=Vijay+Janapa+Reddi
    affiliations: Harvard University
    corresponding: true
    roles: "Author, editor and curator."

  abstract: |
    Volume II of Machine Learning Systems extends the foundations from Volume I to address the complexities of building and managing the machine learning fleet. This volume covers the infrastructure, storage, and communication patterns required for distributed ML, parallelism strategies for training models too large for single machines, fault tolerance mechanisms, and inference optimization at scale. It also addresses production challenges including edge intelligence, security, privacy, and robust system design, concluding with responsible AI practices and sustainable computing. This volume equips practitioners with the knowledge to build and operate ML systems at production scale.

  repo-url: https://github.com/harvard-edge/cs249r_book

  page-footer:
    left: |
      Written, edited and curated by Prof. Vijay Janapa Reddi (Harvard University)
    right: |
      This book was built with <a href="https://quarto.org/">Quarto</a>.

  chapters:
    - index.qmd

    # ==================================================
    # Volume II Frontmatter
    # ==================================================
    - contents/vol2/frontmatter/about.qmd
    - contents/vol2/frontmatter/acknowledgements.qmd

    # ==================================================
    # Part I: Foundations of Scale
    # ==================================================
    - contents/vol2/parts/scale_principles.qmd
    - contents/vol2/introduction/introduction.qmd
    - contents/vol2/distributed_training/distributed_training.qmd
    - contents/vol2/communication_ops/communication_ops.qmd
    - contents/vol2/fault_tolerance/fault_tolerance.qmd

    # ==================================================
    # Part II: Building the Machine Learning Fleet
    # ==================================================
    - contents/vol2/parts/infrastructure_principles.qmd
    - contents/vol2/infrastructure/infrastructure.qmd
    - contents/vol2/infrastructure/networking.qmd
    - contents/vol2/storage/storage.qmd
    - contents/vol2/orchestration/orchestration.qmd

    # ==================================================
    # Part III: Deployment at Scale
    # ==================================================
    - contents/vol2/parts/inference_principles.qmd
    - contents/vol2/inference/inference.qmd
    - contents/vol2/optimization/optimization.qmd
    - contents/vol2/edge_intelligence/edge_intelligence.qmd
    - contents/vol2/ops_scale/ops_scale.qmd

    # ==================================================
    # Part IV: Production Concerns
    # ==================================================
    - contents/vol2/parts/production_principles.qmd
    - contents/vol2/security_privacy/security_privacy.qmd
    - contents/vol2/robust_ai/robust_ai.qmd
    - contents/vol2/sustainable_ai/sustainable_ai.qmd

    # ==================================================
    # Part V: Responsible AI at Scale
    # ==================================================
    - contents/vol2/parts/responsible_principles.qmd
    - contents/vol2/responsible_ai/responsible_ai.qmd
    - contents/vol2/ai_good/ai_good.qmd
    - contents/vol2/emerging_challenges/emerging_challenges.qmd
    - contents/vol2/conclusion/conclusion.qmd
    - contents/vol2/backmatter/references.qmd

  appendices:
    - contents/vol2/backmatter/glossary/glossary.qmd

bibliography:
  - contents/vol2/backmatter/references.bib

citation: true
license: CC-BY-NC-SA

metadata-files:
  - config/shared/base/crossref-video.yml
  - config/shared/base/custom-numbered-blocks.yml
  - config/shared/pdf/diagram.yml
  - config/shared/pdf/filters.yml
  - config/shared/pdf/filter-metadata.yml
  - config/shared/vol2/filter-metadata-paths.yml
  - config/shared/pdf/custom-numbered-blocks-overrides.yml
  - config/shared/pdf/titlepage-theme-common.yml
  - config/shared/pdf/copyedit-watermark.yml

editor:
  render-on-save: false

format:
  titlepage-pdf:
    pdf-engine: lualatex
    use-rsvg-convert: true
    documentclass: scrbook
    classoption: [abstract,titlepage]
    header-includes: |
      \usepackage{needspace}
      \let\Needspace\needspace

    # Simplified cover for copyedit version
    coverpage: false
    titlepage: true
    titlepage-theme:
      elements: [ "\\titleblock",
                  "COPYEDIT VERSION — Double-Spaced",
                  "\\vspace{10mm}",
                  "Prof. Vijay Janapa Reddi",
                  "School of Engineering and Applied Sciences",
                  "Harvard University",
                  "\\vfill",
                  "{{< meta date >}}",
                  "\\vfill"]

    toc: true
    lof: false
    lot: false
    lol: false
    top-level-division: chapter
    number-sections: true
    toc-depth: 2
    number-depth: 3
    keep-tex: false
    citation-package: natbib
    link-citations: true
    biblio-title: "References"
    cite-method: citeproc
    title-block-style: none
    indent: 0px
    fontsize: 9pt
    linestretch: 2          # DOUBLE SPACING for copyediting
    colorlinks: true
    reference-location: document
    citation-location: document
    fig-caption: true
    fig-cap-location: bottom
    tbl-cap-location: top
    tbl-colwidths: auto
    hyperrefoptions:
      - linktoc=all
      - pdfwindowui
      - pdfpagemode=FullScreen
      - pdfpagelayout=SinglePage
    include-in-header:
      - file: "tex/theme-colors-vol2.tex"
      - file: "tex/header-includes.tex"
      - text: |
          \usepackage{needspace}
          \let\Needspace\needspace
    include-before-body:
      - file: "tex/before-body-includes-vol2.tex"
    include-after-body:
      - file: "tex/after-body-includes.tex"
    listings: false
    highlight-style: assets/styles/custom-code.theme
