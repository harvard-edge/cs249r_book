# =============================================================================
# VOLUME II PDF CONFIGURATION — COPYEDIT VERSION (Double-spaced, 9pt)
# =============================================================================
# Double-spaced PDF for MIT Press copyediting workflow.
# Output: Single pages (not spreads), double line spacing for annotation.
#
# Usage:
#   cp config/_quarto-pdf-vol2-copyedit.yml _quarto.yml
#   quarto render --to titlepage-pdf
#
# Note: This produces a much longer PDF (~2x pages) due to double spacing.
# Use _quarto-pdf-vol2.yml for the final single-spaced production PDF.
# =============================================================================

project:
  output-dir: _build/pdf-vol2-copyedit

book:
  favicon: assets/images/icons/favicon.png
  cover-image: assets/images/covers/cover-hardcover-book-vol2.png
  cover-image-alt: "Cover image."

  title: "Machine Learning Systems at Scale"
  subtitle: "COPYEDIT VERSION — Double-Spaced"

  date: today
  date-format: long

  author:
    name: Vijay Janapa Reddi
    email: vj@eecs.harvard.edu
    url: https://www.google.com/search?q=Vijay+Janapa+Reddi
    affiliations: Harvard University
    corresponding: true
    roles: "Author, editor and curator."

  abstract: |
    Scale changes machine learning infrastructure in kind, not merely in degree. When training requires coordination across many machines, communication between nodes dominates compute time; hardware failures become statistically routine; and system behavior emerges from interactions that no single component determines. The fleet — the coordinated ensemble of compute, network, and storage spanning many machines — becomes the fundamental unit of analysis, requiring principles and architectures that single-machine reasoning cannot supply.

    Four parts examine these principles. Part I establishes the physical infrastructure of large-scale ML: datacenter architecture and cooling constraints, the network fabrics that interconnect machines, and the distributed storage systems that feed training and serving pipelines. Part II examines distributed ML: parallelism strategies across nodes, collective communication algorithms, fault tolerance through checkpointing and elastic training, and fleet orchestration using cluster schedulers. Part III addresses deployment at scale: distributed inference and large-model serving, performance engineering, edge intelligence and federated learning, and production operations. Part IV addresses governance: security and privacy, adversarial robustness, sustainable computing under energy and carbon constraints, and responsible AI at fleet scale.

    Throughout, physical constraints drive architecture. Bisection bandwidth, MTBF analysis, queuing theory, and scaling efficiency metrics are the analytical instruments. Readers develop the capacity to design distributed training pipelines, reason quantitatively about fault tolerance and scaling efficiency, and govern production ML infrastructure with accountability and environmental awareness. Suitable for graduate students in distributed systems and machine learning systems, and for practitioners designing and operating ML infrastructure at production scale.

  repo-url: https://github.com/harvard-edge/cs249r_book

  page-footer:
    left: |
      Written, edited and curated by Prof. Vijay Janapa Reddi (Harvard University)
    right: |
      Built with <a href="https://quarto.org/">Quarto</a>.

  chapters:
    - index.qmd

    # ==================================================
    # Volume II Frontmatter
    # ==================================================
    - contents/vol2/frontmatter/dedication.qmd
    - contents/vol2/frontmatter/foreword.qmd
    - contents/vol2/frontmatter/about.qmd
    - contents/vol2/frontmatter/acknowledgements.qmd
    - contents/shared/notation.qmd

    # ==================================================
    # Part I: The Fleet
    # ==================================================
    - contents/vol2/parts/fleet_principles.qmd
    - contents/vol2/introduction/introduction.qmd
    - contents/vol2/compute_infrastructure/compute_infrastructure.qmd
    - contents/vol2/network_fabrics/network_fabrics.qmd
    - contents/vol2/data_storage/data_storage.qmd

    # ==================================================
    # Part II: Distributed ML
    # ==================================================
    - contents/vol2/parts/distributed_ml_principles.qmd
    - contents/vol2/distributed_training/distributed_training.qmd
    - contents/vol2/collective_communication/collective_communication.qmd
    - contents/vol2/fault_tolerance/fault_tolerance.qmd
    - contents/vol2/fleet_orchestration/fleet_orchestration.qmd

    # ==================================================
    # Part III: Deployment at Scale
    # ==================================================
    - contents/vol2/parts/deployment_principles.qmd
    - contents/vol2/performance_engineering/performance_engineering.qmd
    - contents/vol2/inference/inference.qmd
    - contents/vol2/edge_intelligence/edge_intelligence.qmd
    - contents/vol2/ops_scale/ops_scale.qmd

    # ==================================================
    # Part IV: The Responsible Fleet
    # ==================================================
    - contents/vol2/parts/responsible_fleet_principles.qmd
    - contents/vol2/security_privacy/security_privacy.qmd
    - contents/vol2/robust_ai/robust_ai.qmd
    - contents/vol2/sustainable_ai/sustainable_ai.qmd
    - contents/vol2/responsible_ai/responsible_ai.qmd
    - contents/vol2/conclusion/conclusion.qmd
    - contents/vol2/backmatter/references.qmd

  appendices:
    - contents/vol2/backmatter/glossary/glossary.qmd

bibliography:
  - contents/vol2/backmatter/references.bib

metadata-files:
  - config/shared/base/crossref-video.yml
  - config/shared/base/custom-numbered-blocks.yml
  - config/shared/base/execute-env.yml
  - config/shared/base/diagram.yml
  - config/shared/pdf/filters.yml
  - config/shared/pdf/filter-metadata.yml
  - config/shared/vol2/filter-metadata-paths.yml
  - config/shared/pdf/custom-numbered-blocks-overrides.yml
  - config/shared/pdf/titlepage-theme-common.yml
  - config/shared/pdf/titlepage-pdf-common.yml
  - config/shared/pdf/titlepage-pdf-copyedit-common.yml
  - config/shared/pdf/copyedit-watermark.yml
  - config/shared/pdf/build-copyedit-common.yml

format:
  titlepage-pdf:
    # Simplified cover for copyedit version
    include-in-header:
      - file: "tex/theme-colors-vol2.tex"
      - file: "tex/header-includes.tex"
      - text: |
          \usepackage{needspace}
          \let\Needspace\needspace
    include-before-body:
      - file: "tex/before-body-includes-vol2.tex"
