# =============================================================================
# VOLUME I EPUB CONFIGURATION
# =============================================================================
# Builds only Volume I: Introduction as EPUB
#
# Usage:
#   cp config/_quarto-epub-vol1.yml _quarto.yml
#   quarto render --to epub
# =============================================================================

project:
  type: book
  output-dir: _build/epub-vol1
  execute-dir: project
  post-render:
    - scripts/clean_svgs.py
    - scripts/epub_postprocess.py

  preview:
    browser: false
    navigate: false

book:
  favicon: assets/images/icons/favicon.png
  cover-image: assets/images/covers/cover-hardcover-book-vol1.png
  cover-image-alt: "Cover image."

  title: "Introduction to Machine Learning Systems"

  date: today
  date-format: long

  author:
    name: "Prof. Vijay Janapa Reddi"
    email: vj@eecs.harvard.edu
    url: https://www.google.com/search?q=Vijay+Janapa+Reddi
    affiliations:
      - name: "Harvard University"
        department: "School of Engineering and Applied Sciences"
        city: "Cambridge"
        state: "MA"
        country: "USA"
    corresponding: true
    roles: "Author, editor and curator."
    orcid: "0000-0002-5259-7721"

  abstract: |
    Volume I of Machine Learning Systems presents a comprehensive introduction to understanding and engineering machine learning systems, with a focus on mastering the machine learning node. This volume establishes the foundations through four progressive stages: building conceptual models, engineering complete workflows, optimizing for real-world constraints, and deploying with confidence.

  repo-url: https://github.com/harvard-edge/cs249r_book

  page-footer:
    left: |
      Written, edited and curated by Prof. Vijay Janapa Reddi (Harvard University)
    right: |
      This book was built with <a href="https://quarto.org/">Quarto</a>.

  chapters:
    - index.qmd

    # Volume I Frontmatter
    - contents/vol1/frontmatter/foreword.qmd
    - contents/vol1/frontmatter/about.qmd
    - contents/vol1/frontmatter/acknowledgements.qmd

    # Part I: Foundations
    - part: "Foundations"
    - contents/vol1/parts/foundations_principles.qmd
    - contents/vol1/introduction/introduction.qmd
    - contents/vol1/ml_systems/ml_systems.qmd
    - contents/vol1/workflow/workflow.qmd
    - contents/vol1/data_engineering/data_engineering.qmd

    # Part II: Build
    - part: "Build"
    - contents/vol1/parts/build_principles.qmd
    - contents/vol1/dl_primer/dl_primer.qmd
    - contents/vol1/dnn_architectures/dnn_architectures.qmd
    - contents/vol1/frameworks/frameworks.qmd
    - contents/vol1/training/training.qmd

    # Part III: Optimize
    - part: "Optimize"
    - contents/vol1/parts/optimize_principles.qmd
    - contents/vol1/data_selection/data_selection.qmd
    - contents/vol1/optimizations/model_compression.qmd
    - contents/vol1/hw_acceleration/hw_acceleration.qmd
    - contents/vol1/benchmarking/benchmarking.qmd

    # Part IV: Deploy
    - part: "Deploy"
    - contents/vol1/parts/deploy_principles.qmd
    - contents/vol1/serving/serving.qmd
    - contents/vol1/ops/ops.qmd
    - contents/vol1/responsible_engr/responsible_engr.qmd
    - contents/vol1/conclusion/conclusion.qmd
    - contents/vol1/backmatter/references.qmd

    - part: "Appendices"
      chapters:
        - contents/vol1/backmatter/appendix_dam.qmd
        - contents/vol1/backmatter/appendix_machine.qmd
        - contents/vol1/backmatter/appendix_algorithm.qmd
        - contents/vol1/backmatter/appendix_data.qmd
    - contents/vol1/backmatter/glossary/glossary.qmd

bibliography:
  - contents/vol1/introduction/introduction.bib
  - contents/vol1/ml_systems/ml_systems.bib
  - contents/vol1/workflow/workflow.bib
  - contents/vol1/data_engineering/data_engineering.bib
  - contents/vol1/dnn_architectures/dnn_architectures.bib
  - contents/vol1/frameworks/frameworks.bib
  - contents/vol1/training/training.bib
  - contents/vol1/efficient_ai/efficient_ai.bib
  - contents/vol1/optimizations/optimizations.bib
  - contents/vol1/hw_acceleration/hw_acceleration.bib
  - contents/vol1/benchmarking/benchmarking.bib
  - contents/vol1/serving/serving.bib
  - contents/vol1/ops/ops.bib
  - contents/vol1/responsible_engr/responsible_engr.bib
  - contents/vol1/conclusion/conclusion.bib

filters:
  - pandoc-ext/diagram
  - mlsysbook-ext/custom-numbered-blocks

filter-metadata:
  quiz-config:
    file-pattern: "*_quizzes.json"
    scan-directory: "contents/vol1"
    auto-discover-pdf: false

  part-summaries:
    file: "contents/vol1/parts/summaries.yml"
    enabled: true

  mlsysbook-ext/custom-numbered-blocks:
    icon-path: "assets/images/icons/callouts"
    icon-format: "png"
    groups:
      quiz-question:
        colors: ["F0F0F8", "5B4B8A"]
        collapse: true
        numbered: false
      quiz-answer:
        colors: ["E8F2EA", "4A7C59"]
        collapse: true
        numbered: false
      resource-slides:
        colors: ["E0F2F1", "20B2AA"]
        collapse: true
        numbered: false
      resource-videos:
        colors: ["E0F2F1", "20B2AA"]
        collapse: true
        numbered: false
      resource-exercises:
        colors: ["E0F2F1", "20B2AA"]
        collapse: true
        numbered: false
      chapter-connection:
        colors: ["EFF6FF", "1E3A5F"]
        collapse: false
        numbered: false
      chapter-forward:
        colors: ["F5F3FF", "8B5CF6"]
        collapse: true
        numbered: false
      chapter-recall:
        colors: ["FFF4E6", "C06014"]
        collapse: true
        numbered: false
      code-listing:
        colors: ["F2F4F8", "D1D7E0"]
        collapse: false
        numbered: false
      definition:
        colors: ["F0F4F8", "1B4F72"]
        collapse: false
        numbered: false
      example:
        colors: ["F0F8F6", "148F77"]
        collapse: false
        numbered: false
      engineers-notebook:
        colors: ["F2F7FF", "2C5282"]
        collapse: false
        numbered: false
      colab-interactive:
        colors: ["FFF5E6", "FF6B35"]
        collapse: false
        numbered: false
      lighthouse:
        colors: ["FDF8E6", "B8860B"]
        collapse: false
        numbered: false
      perspective:
        colors: ["F7F8FA", "4A5568"]
        collapse: false
        numbered: false
      checkpoint:
        colors: ["FFF8E7", "D97706"]
        collapse: false
        numbered: false
      principle:
        colors: ["F3F2FA", "3D3B8E"]
        collapse: false
        numbered: true
      takeaways:
        colors: ["FDF2F7", "BE185D"]
        collapse: false
        numbered: false
      theorem:
        colors: ["F5F0FA", "6B46C1"]
        collapse: false
        numbered: true
    classes:
      callout-quiz-question:
        label: "Self-Check: Question"
        group: quiz-question
      callout-quiz-answer:
        label: "Self-Check: Answer"
        group: quiz-answer
      callout-resource-slides:
        label: "Listing"
        group: resource-slides
      callout-resource-videos:
        label: "Videos"
        group: resource-videos
      callout-resource-exercises:
        label: "Exercises"
        group: resource-exercises
      callout-chapter-connection:
        label: "What's Next"
        group: chapter-connection
      callout-code:
        label: "Code"
        group: code-listing
      callout-definition:
        label: "Definition"
        group: definition
      callout-example:
        label: "Example"
        group: example
      callout-colab:
        label: "Interactive Colab"
        group: colab-interactive
      callout-lighthouse:
        label: "Lighthouse"
        group: lighthouse
      callout-perspective:
        label: "Systems Perspective"
        group: perspective
      callout-notebook:
        label: "AI Engineer's Notebook"
        group: engineers-notebook
      callout-principle:
        label: "Principle"
        group: principle
      callout-theorem:
        label: "Theorem"
        group: theorem
      callout-checkpoint:
        label: "Checkpoint"
        group: checkpoint
      callout-takeaways:
        label: "Key Takeaways"
        group: takeaways

editor:
  render-on-save: true

format:
  epub:
    language: "en-US"
    identifier: "https://mlsysbook.ai/epub/vol1"
    contributor: "Harvard University, School of Engineering and Applied Sciences"
    subject: "Machine Learning, Computer Science, Engineering, Artificial Intelligence, Systems Design"
    description: "Volume I of Machine Learning Systems, covering foundations, development, optimization, and deployment."
    type: "Text"
    format: "application/epub+zip"
    source: "https://mlsysbook.ai"
    toc: true
    toc-depth: 3
    toc-title: "Table of Contents"
    epub-chapter-level: 1
    epub-cover-image: "assets/images/covers/cover_image_title-vol1.png"
    epub-title-page: true
    css: "assets/styles/epub-vol1.css"
    code-overflow: wrap
    code-copy: true
    code-line-numbers: true
    number-sections: false
    number-depth: 3
    fig-align: center
    fig-caption: true
    footnotes-hover: true
    link-citations: true
    citations-hover: true

diagram:
  engine:
    tikz:
      execpath: lualatex
      output-format: svg
      header-includes:
        - '\usepackage{tikz}'
        - '\usepackage{pgfplots}'
        - '\usepackage{pgf-pie}'
        - '\usepackage{amsmath}'
        - '\usepackage{amssymb}'
        - '\usepackage{xcolor}'
        - '\pgfplotsset{compat=1.9}'
        - '\usepgfplotslibrary{fillbetween}'
        - '\usetikzlibrary{angles}'
        - '\usetikzlibrary{arrows.meta}'
        - '\usetikzlibrary{arrows}'
        - '\usetikzlibrary{backgrounds}'
        - '\usetikzlibrary{bending}'
        - '\usetikzlibrary{calc}'
        - '\usetikzlibrary{shadows.blur}'
        - '\usetikzlibrary{fit}'
        - '\usetikzlibrary{intersections}'
        - '\usetikzlibrary{positioning}'
        - '\usetikzlibrary{shapes.geometric}'
        - '\usetikzlibrary{shapes}'
        - '\usetikzlibrary{quotes}'
        - '\usetikzlibrary{decorations.pathmorphing}'
        - '\usetikzlibrary{decorations.markings}'
        - '\usetikzlibrary{matrix}'
        - '\usepgfplotslibrary{dateplot}'
        - '\usepgfplotslibrary{polar}'
        - '\definecolor{Brown}{rgb}{0.65, 0.16, 0.16}'
        - '\definecolor{BrownL}{RGB}{233,222,220}'
        - '\definecolor{BrownLine}{RGB}{143,120,116}'
        - '\definecolor{BackColor}{RGB}{255,255,229}'
        - '\definecolor{BackLine}{RGB}{181,181,72}'
        - '\definecolor{BlueD}{RGB}{62,100,125}'
        - '\definecolor{BlueL}{RGB}{209,243,255}'
        - '\definecolor{BlueLine}{RGB}{34,148,189}'
        - '\definecolor{BlueFill}{RGB}{232, 240, 254}'
        - '\definecolor{Green}{rgb}{0.0, 0.5, 0.0}'
        - '\definecolor{GreenD}{RGB}{40,117,40}'
        - '\definecolor{GreenL}{RGB}{219,253,166}'
        - '\definecolor{GreenLine}{RGB}{73,89,56}'
        - '\definecolor{GreenFill}{RGB}{230, 244, 234}'
        - '\definecolor{GrayLine}{RGB}{95, 99, 104}'
        - '\definecolor{OliveL}{RGB}{230,227,191}'
        - '\definecolor{OliveLine}{RGB}{173,166,10}'
        - '\definecolor{OrangeL}{RGB}{250,212,175}'
        - '\definecolor{OrangeLine}{RGB}{255,127,76}'
        - '\definecolor{RedL}{RGB}{253,226,240}'
        - '\definecolor{RedLine}{RGB}{201,20,110}'
        - '\definecolor{RedFill}{RGB}{252, 232, 230}'
        - '\definecolor{Sepia}{rgb}{0.44, 0.26, 0.08}'
        - '\definecolor{TextColor}{RGB}{224,224,224}'
        - '\definecolor{TextBlack}{RGB}{32, 33, 36}'
        - '\definecolor{VioletL}{RGB}{247,180,247}'
        - '\definecolor{VioletL2}{RGB}{243,243,255}'
        - '\definecolor{VioletLine}{RGB}{34,125,189}'
        - '\definecolor{VioletLine2}{RGB}{169,136,229}'
        - '\definecolor{YellowLine}{RGB}{251, 188, 4}'
        - '\definecolor{YellowFill}{RGB}{254, 247, 224}'
