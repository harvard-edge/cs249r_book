---
format:
  html:
    title: "Machine Learning Systems"
    subtitle: "Principles and Practices of Engineering Artificially Intelligent Systems"
    date: today
    date-format: long
    # Version is automatically updated by publish-live.yml workflow
    # Links to releases page via assets/scripts/version-link.js
    doi: "v0.5.1"
    doi-title: "Version"
    author:
      name: Vijay Janapa Reddi
      email: vj@eecs.harvard.edu
      url: https://vijay.seas.harvard.edu
      affiliation: Harvard University
---

::: {.content-visible when-format="html"}
```{=html}
<h2 class="unnumbered anchored" id="peek-inside">Peek Inside</h2>
<p class="peek-intro"><span class="peek-intro-main">Get a glimpse of what you'll learn.</span> <span class="browse-desktop">Click arrows to browse, click image to expand.</span><span class="browse-mobile">Swipe to browse, tap to expand.</span></p>

<div class="coverflow-container">
  <button class="coverflow-nav coverflow-prev" aria-label="Previous">‚Äπ</button>
  
  <div class="coverflow-wrapper">
    <div class="coverflow-stage">
      <div class="coverflow-slide" data-index="0">
        <a href="assets/images/peek-inside/definition.png" class="lightbox" data-gallery="peek">
          <img src="assets/images/peek-inside/definition.png" alt="Definition">
        </a>
        <div class="coverflow-caption"><strong>Definition</strong><br>AI Engineering</div>
      </div>
      <div class="coverflow-slide" data-index="1">
        <a href="assets/images/peek-inside/notebook.png" class="lightbox" data-gallery="peek">
          <img src="assets/images/peek-inside/notebook.png" alt="AI Engineer's Notebook">
        </a>
        <div class="coverflow-caption"><strong>AI Engineer's Notebook</strong><br>Quantization Savings</div>
      </div>
      <div class="coverflow-slide" data-index="2">
        <a href="assets/images/peek-inside/diagram.png" class="lightbox" data-gallery="peek">
          <img src="assets/images/peek-inside/diagram.png" alt="System Diagram">
        </a>
        <div class="coverflow-caption"><strong>System Diagram</strong><br>Training Pipeline</div>
      </div>
      <div class="coverflow-slide" data-index="3">
        <a href="assets/images/peek-inside/code.png" class="lightbox" data-gallery="peek">
          <img src="assets/images/peek-inside/code.png" alt="Code Listing">
        </a>
        <div class="coverflow-caption"><strong>Code Listing</strong><br>PyTorch Autograd</div>
      </div>
      <div class="coverflow-slide" data-index="4">
        <a href="assets/images/peek-inside/lighthouse.png" class="lightbox" data-gallery="peek">
          <img src="assets/images/peek-inside/lighthouse.png" alt="Lighthouse Example">
        </a>
        <div class="coverflow-caption"><strong>Lighthouse Example</strong><br>Netflix at Scale</div>
      </div>
    </div>
  </div>
  
  <button class="coverflow-nav coverflow-next" aria-label="Next">‚Ä∫</button>
</div>

<script>
(function() {
  const stage = document.querySelector('.coverflow-stage');
  const slides = document.querySelectorAll('.coverflow-slide');
  const prevBtn = document.querySelector('.coverflow-prev');
  const nextBtn = document.querySelector('.coverflow-next');
  let currentIndex = 2; // Start centered on middle slide
  const total = slides.length;
  
  function updateSlides() {
    slides.forEach((slide, i) => {
      const offset = i - currentIndex;
      slide.classList.remove('active', 'left-1', 'left-2', 'right-1', 'right-2', 'hidden');
      
      if (offset === 0) {
        slide.classList.add('active');
      } else if (offset === -1) {
        slide.classList.add('left-1');
      } else if (offset === -2) {
        slide.classList.add('left-2');
      } else if (offset === 1) {
        slide.classList.add('right-1');
      } else if (offset === 2) {
        slide.classList.add('right-2');
      } else {
        slide.classList.add('hidden');
      }
    });
  }
  
  prevBtn.addEventListener('click', () => {
    currentIndex = (currentIndex - 1 + total) % total;
    updateSlides();
  });
  
  nextBtn.addEventListener('click', () => {
    currentIndex = (currentIndex + 1) % total;
    updateSlides();
  });
  
  // Click on side slides to navigate
  slides.forEach((slide, i) => {
    slide.addEventListener('click', (e) => {
      if (i !== currentIndex) {
        e.preventDefault();
        currentIndex = i;
        updateSlides();
      }
    });
  });
  
  // Touch/swipe support for mobile
  let touchStartX = 0;
  let touchEndX = 0;
  const minSwipeDistance = 50;
  
  stage.addEventListener('touchstart', (e) => {
    touchStartX = e.touches[0].clientX;
  }, { passive: true });
  
  stage.addEventListener('touchend', (e) => {
    touchEndX = e.changedTouches[0].clientX;
    const diff = touchEndX - touchStartX;
    
    if (Math.abs(diff) > minSwipeDistance) {
      if (diff > 0) {
        // Swipe right - go to previous
        currentIndex = (currentIndex - 1 + total) % total;
      } else {
        // Swipe left - go to next
        currentIndex = (currentIndex + 1) % total;
      }
      updateSlides();
    }
  }, { passive: true });
  
  updateSlides();
})();
</script>

<style>
/* Coverflow 3D Carousel */
.peek-intro {
  text-align: center;
  color: #6c757d;
  font-size: 0.95rem;
  margin-bottom: 1.5rem;
}

.browse-mobile {
  display: none;
}

.browse-desktop {
  display: inline;
}

.coverflow-container {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 2.5rem auto;
  max-width: 100%;
  padding: 0 50px;
  overflow: hidden;
}

.coverflow-wrapper {
  width: 100%;
  height: 340px;
  perspective: 1000px;
  overflow: visible;
}

.coverflow-stage {
  position: relative;
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
}

.coverflow-slide {
  position: absolute;
  left: 50%;
  top: 0;
  width: 340px;
  margin-left: -170px;
  background: #fff;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 8px 30px rgba(0,0,0,0.12);
  transition: all 0.4s ease;
  cursor: pointer;
  opacity: 0;
  transform: translateX(0) scale(0.7) rotateY(0deg);
  z-index: 1;
}

.coverflow-slide a {
  display: block;
  text-decoration: none;
}

.coverflow-slide img {
  width: 100%;
  height: 210px; /* Golden ratio: 340 / 1.618 */
  object-fit: cover;
  object-position: top left;
  display: block;
}

.coverflow-caption {
  padding: 0.75rem 1rem;
  font-size: 0.85rem;
  color: #444d56;
  background: #fafbfc;
  border-top: 1px solid #e9ecef;
  line-height: 1.4;
  text-align: center;
}

.coverflow-caption strong {
  color: #a51c30;
  display: block;
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 2px;
}

/* Slide positions */
.coverflow-slide.active {
  transform: translateX(0) scale(1) rotateY(0deg);
  z-index: 10;
  opacity: 1;
  box-shadow: 0 15px 50px rgba(0,0,0,0.25);
}

.coverflow-slide.left-1 {
  transform: translateX(-220px) scale(0.75) rotateY(40deg);
  z-index: 5;
  opacity: 0.6;
}

.coverflow-slide.left-2 {
  transform: translateX(-340px) scale(0.55) rotateY(50deg);
  z-index: 2;
  opacity: 0.3;
}

.coverflow-slide.right-1 {
  transform: translateX(220px) scale(0.75) rotateY(-40deg);
  z-index: 5;
  opacity: 0.6;
}

.coverflow-slide.right-2 {
  transform: translateX(340px) scale(0.55) rotateY(-50deg);
  z-index: 2;
  opacity: 0.3;
}

.coverflow-slide.hidden {
  opacity: 0;
  pointer-events: none;
}

/* Hover on active */
.coverflow-slide.active:hover {
  box-shadow: 0 16px 50px rgba(165, 28, 48, 0.25);
}

/* Navigation */
.coverflow-nav {
  position: relative;
  width: 44px;
  height: 44px;
  border: none;
  border-radius: 50%;
  background: #fff;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  font-size: 1.75rem;
  color: #495057;
  cursor: pointer;
  z-index: 20;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.coverflow-nav:hover {
  background: #a51c30;
  color: #fff;
  box-shadow: 0 4px 15px rgba(165, 28, 48, 0.3);
}

.coverflow-prev {
  margin-right: -20px;
}

.coverflow-next {
  margin-left: -20px;
}

/* Tablet adjustments */
@media (max-width: 800px) {
  .coverflow-container {
    padding: 0 20px;
  }
  
  .coverflow-wrapper {
    height: 280px;
  }
  
  .coverflow-slide {
    width: 280px;
    margin-left: -140px;
  }
  
  .coverflow-slide img {
    height: 173px;
  }
  
  .coverflow-slide.left-1 {
    transform: translateX(-160px) scale(0.7) rotateY(45deg);
    opacity: 0.4;
  }
  
  .coverflow-slide.right-1 {
    transform: translateX(160px) scale(0.7) rotateY(-45deg);
    opacity: 0.4;
  }
  
  .coverflow-slide.left-2,
  .coverflow-slide.right-2 {
    opacity: 0;
  }
  
  .coverflow-nav {
    width: 48px;
    height: 48px;
    font-size: 1.5rem;
  }
}

/* Mobile adjustments */
@media (max-width: 550px) {
  .peek-intro {
    font-size: 0.85rem;
    margin-bottom: 1rem;
  }
  
  .browse-desktop {
    display: none;
  }
  
  .browse-mobile {
    display: inline;
  }
  
  .coverflow-container {
    padding: 0 10px;
  }
  
  .coverflow-wrapper {
    height: 260px;
    touch-action: pan-y pinch-zoom;
  }
  
  .coverflow-slide {
    width: 260px;
    margin-left: -130px;
  }
  
  .coverflow-slide img {
    height: 161px;
  }
  
  .coverflow-slide.left-1 {
    transform: translateX(-120px) scale(0.6) rotateY(50deg);
    opacity: 0.25;
  }
  
  .coverflow-slide.right-1 {
    transform: translateX(120px) scale(0.6) rotateY(-50deg);
    opacity: 0.25;
  }
  
  .coverflow-slide.left-2,
  .coverflow-slide.right-2 {
    opacity: 0;
  }
  
  .coverflow-nav {
    width: 40px;
    height: 40px;
    font-size: 1.25rem;
    opacity: 0.6;
  }
  
  .coverflow-prev {
    margin-right: -15px;
  }
  
  .coverflow-next {
    margin-left: -15px;
  }
  
  .coverflow-caption {
    padding: 0.5rem 0.75rem;
    font-size: 0.75rem;
  }
}

/* Small mobile */
@media (max-width: 400px) {
  .coverflow-wrapper {
    height: 220px;
  }
  
  .coverflow-slide {
    width: 220px;
    margin-left: -110px;
  }
  
  .coverflow-slide img {
    height: 136px;
  }
  
  .coverflow-slide.left-1,
  .coverflow-slide.right-1 {
    opacity: 0.15;
  }
}

/* Dark mode */
[data-bs-theme="dark"] .peek-intro {
  color: #8b949e;
}

[data-bs-theme="dark"] .coverflow-slide {
  background: #21262d;
}

[data-bs-theme="dark"] .coverflow-caption {
  background: #161b22;
  border-top-color: #30363d;
  color: #b1bac4;
}

[data-bs-theme="dark"] .coverflow-caption strong {
  color: #ff7b72;
}

[data-bs-theme="dark"] .coverflow-nav {
  background: #30363d;
  color: #b1bac4;
}

[data-bs-theme="dark"] .coverflow-nav:hover {
  background: #f85149;
  color: #fff;
}
</style>
```

:::

## Abstract {.unnumbered}

Machine Learning Systems provides a systematic framework for understanding and engineering machine learning (ML) systems. This textbook bridges the gap between theoretical foundations and practical engineering, emphasizing the systems perspective required to build effective AI solutions. Unlike resources that focus primarily on algorithms and model architectures, this book highlights the broader context in which ML systems operate, including data engineering, model optimization, hardware-aware training, and inference acceleration. Readers will develop the ability to reason about ML system architectures and apply enduring engineering principles for building flexible, efficient, and robust machine learning systems. In doing so, this book contributes toward defining AI Engineering as a distinct discipline.

::: {.content-visible when-format="html"}
```{=html}
<p style="text-align: center; margin-top: 1rem;">
  <a href="assets/downloads/Machine-Learning-Systems.pdf" target="_blank" class="btn btn-outline-primary">
    üìñ Download PDF Preview
  </a>
</p>
```
:::

## What This Book Stands For {.unnumbered}

We believe AI Engineering is emerging as a distinct engineering discipline. It is not just machine learning. It is not just software engineering. It is the systematic design, construction, and operation of intelligent systems under real world constraints.

This book is our contribution toward defining that discipline. We prioritize engineering realism over theoretical convenience, enduring principles over short lived tools, and system level thinking over component level optimization. Our goal is not to catalog everything that exists, but to identify what lasts.

## The Architecture of this Book {.unnumbered}

Machine learning systems engineering happens at two distinct scales. We have organized this textbook to mirror that reality:

**Volume 1: The ML Node (Build, Optimize, Deploy)**
Focuses on the physics of computation within a single unit. Whether that unit is a developer's laptop or a single H100 accelerator, the engineering goals are the same: maximizing arithmetic intensity, minimizing memory movement, and ensuring the model runs efficiently and correctly. You cannot build a skyscraper if your bricks are crumbling; Volume 1 teaches you how to bake the perfect brick.

**Volume 2: The ML Fleet (Scale, Distribute, Govern)**
Focuses on the physics of coordination across thousands of units. Once you connect nodes, new laws of physics take over: network latency dominates compute, partial failures become statistical certainties, and data gravity dictates architecture. Volume 2 teaches you how to orchestrate these bricks into a resilient, self-healing structure that serves millions of users.

## Support Our Mission {.unnumbered}

::: {.content-visible when-format="html"}
```{=html}
<div class="support-mission">
  <p><strong>2026 Goal:</strong> Help 100,000 students learn ML Systems. On track for 1 million learners by 2030. Sponsors like the <a href="https://edgeaifoundation.org/" target="_blank" rel="noopener noreferrer">EDGE AI Foundation</a> match every star with funding that supports learning.</p>

  <div class="support-actions">
    <span class="star-count" id="star-count">Loading...</span>
    <a href="https://github.com/harvard-edge/cs249r_book" target="_blank" rel="noopener" class="github-star-btn">‚≠ê Star on GitHub</a>
  </div>

  <p class="support-note">
    <a href="https://opencollective.com/mlsysbook" target="_blank" rel="noopener">New! We just started an Open Collective. Learn more ‚Üí</a>
  </p>
</div>
```

```{=html}
<script>
async function fetchGitHubStars() {
  const starElement = document.getElementById('star-count');

  try {
    const response = await fetch('https://api.github.com/repos/harvard-edge/cs249r_book');
    const data = await response.json();
    const starCount = data.stargazers_count;

    // Update the star count with thousands separator
    const formattedCount = starCount.toLocaleString();
    starElement.textContent = formattedCount;
    starElement.style.opacity = '1';
  } catch (error) {
    console.error('Failed to fetch GitHub stars:', error);
    // Show a fallback message if API fails
    starElement.textContent = 'Loading...';
    starElement.style.opacity = '1';
  }
}

// Fetch stars when the page loads
document.addEventListener('DOMContentLoaded', fetchGitHubStars);
</script>
```
:::

::: {.content-visible when-format="pdf"}
Your support expands educational access and creates new opportunities. The open source community has embraced this project, with thousands of GitHub stars from educators, students, and practitioners worldwide.

**Ways to Support:**

- **GitHub:** Star the repository at [github.com/harvard-edge/cs249r_book](https://github.com/harvard-edge/cs249r_book)
- **Open Collective:** Support through [opencollective.com/mlsysbook](https://opencollective.com/mlsysbook)
- **Share:** Help others discover this resource
:::

```{=latex}
\clearpage
```

## Why We Wrote This Book {.unnumbered}

**The Problem:** Students learn to train AI models, but few understand how to build the systems that actually make them work in production. When ML systems concepts are taught, students often learn individual components without grasping the holistic architecture‚Äîthey can see the trees but miss the forest.

**The Future:** As AI becomes more autonomous, the bottleneck won't be just the algorithms‚Äîit will be the AI engineers who can build efficient, scalable, and sustainable systems.

::: {.content-visible when-format="html"}
```{=html}
<blockquote>
  "If you want to go fast, go alone. If you want to go far, go together."
  <footer>‚Äî African Proverb</footer>
</blockquote>
```
:::

::: {.content-visible unless-format="html"}
> "If you want to go fast, go alone. If you want to go far, go together."
> ‚Äî African Proverb
:::

**Our Approach:** This vision emerged from collaborative work in CS249r at Harvard University, where students, faculty, and industry partners came together to explore the systems side of ML. The content was developed through real student contributions during Fall 2023. What started as class notes has turned into a comprehensive educational resource we now share globally.

Want the full story? Read our [Author's Note](contents/frontmatter/foreword.qmd) about the inspiration and values driving this project.


## Listen to the AI Podcast {.unnumbered}

::: {.content-visible when-format="html"}
```{=html}
<div class="podcast-section">
  <p>
    This short podcast, created with Google's Notebook LM and inspired by insights from our <a href="https://web.eng.fiu.edu/gaquan/Papers/ESWEEK24Papers/CPS-Proceedings/pdfs/CODES-ISSS/563900a043/563900a043.pdf" target="_blank" rel="noopener">IEEE education viewpoint paper</a>, offers an accessible overview of the book's key ideas and themes.
  </p>
  <audio controls="controls">
    <source src="assets/media/notebooklm_podcast_mlsysbookai.mp3" type="audio/mpeg" />
    Your browser does not support the audio element.
  </audio>
</div>
```
:::

::: {.content-visible when-format="pdf"}

A short podcast, created with Google's Notebook LM and inspired by insights from our [IEEE education viewpoint paper](https://web.eng.fiu.edu/gaquan/Papers/ESWEEK24Papers/CPS-Proceedings/pdfs/CODES-ISSS/563900a043/563900a043.pdf), offers an accessible overview of the book's key ideas and themes. The podcast explores the systems perspective of machine learning and discusses why understanding ML systems architecture is crucial for building effective AI solutions.

*Note: Audio content is available in the online version at [mlsysbook.ai](https://mlsysbook.ai)*

:::

## Global Outreach {.unnumbered}

Thank you to all our readers and visitors. Your engagement with the material keeps us motivated.

::: {.content-visible when-format="html:js"}
```{=html}
<div style="position: relative; padding-top: 56.25%; margin: 20px 0;">
  <iframe
    src="https://lookerstudio.google.com/embed/reporting/e7192975-a8a0-453d-b6fe-1580ac054dbf/page/0pNbE"
    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0; border-radius: 8px;"
    allowfullscreen="allowfullscreen"
    sandbox="allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox">
  </iframe>
</div>
```
:::

::: {.content-visible when-format="pdf"}
This textbook has reached readers across the globe, with visitors from over 100 countries engaging with the material. The international community includes students, educators, researchers, and practitioners who are advancing the field of machine learning systems. From universities in North America and Europe to research institutions in Asia and emerging tech hubs worldwide, the content serves diverse learning needs and cultural contexts.

*Interactive analytics dashboard available in the online version at [mlsysbook.ai](https://mlsysbook.ai)*
:::

::: {.content-visible when-format="epub"}
This textbook has reached readers across the globe, with visitors from over 100 countries engaging with the material. The international community includes students, educators, researchers, and practitioners who are advancing the field of machine learning systems. From universities in North America and Europe to research institutions in Asia and emerging tech hubs worldwide, the content serves diverse learning needs and cultural contexts.

*Interactive analytics dashboard available in the online version at [mlsysbook.ai](https://mlsysbook.ai)*
:::

## Want to Help Out? {.unnumbered}

This is a collaborative project, and your input matters! If you'd like to contribute, check out our [contribution guidelines](https://github.com/harvard-edge/cs249r_book/blob/dev/docs/contribute.md). Feedback, corrections, and new ideas are welcome. Simply file a GitHub [issue](https://github.com/harvard-edge/cs249r_book/issues).

We warmly invite you to join us on this journey by contributing your expertise, feedback, and ideas.

```{=latex}
\part{key:frontmatter}
```
