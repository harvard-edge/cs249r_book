// TinyTorch Module Flow Diagram
// Generate PDF: dot -Tpdf module_flow.dot -o module_flow.pdf
// Generate PNG: dot -Tpng module_flow.dot -o module_flow.png

digraph TinyTorch {
    rankdir=LR;
    splines=ortho;
    nodesep=0.4;
    ranksep=0.6;
    node [shape=box, style="filled,rounded", fontname="Helvetica", fontsize=10];
    edge [arrowsize=0.7];

    // Foundation Tier (blue)
    subgraph cluster_foundation {
        label="FOUNDATION (01-07)";
        style=filled;
        fillcolor="#e3f2fd";
        color="#1976d2";
        fontname="Helvetica-Bold";

        T [label="01\nTensor", fillcolor="#bbdefb"];
        A [label="02\nActivations", fillcolor="#bbdefb"];
        L [label="03\nLayers", fillcolor="#bbdefb"];
        Loss [label="04\nLosses", fillcolor="#bbdefb"];
        Auto [label="05\nAutograd", fillcolor="#bbdefb"];
        Opt [label="06\nOptimizers", fillcolor="#bbdefb"];
        Train [label="07\nTraining", fillcolor="#bbdefb"];

        // Linear pedagogical flow
        T -> A -> L -> Loss -> Auto -> Opt -> Train;
    }

    // Architecture Tier (purple)
    subgraph cluster_architecture {
        label="ARCHITECTURE (08-13)";
        style=filled;
        fillcolor="#f3e5f5";
        color="#7b1fa2";
        fontname="Helvetica-Bold";

        Data [label="08\nDataLoader", fillcolor="#e1bee7"];
        Conv [label="09\nCNNs", fillcolor="#e1bee7"];
        Tok [label="10\nTokenization", fillcolor="#e1bee7"];
        Emb [label="11\nEmbeddings", fillcolor="#e1bee7"];
        Att [label="12\nAttention", fillcolor="#e1bee7"];
        Trans [label="13\nTransformers", fillcolor="#e1bee7"];

        // Two tracks from DataLoader
        Data -> Conv;
        Data -> Tok -> Emb -> Att -> Trans;
    }

    // Optimization Tier (orange)
    subgraph cluster_optimization {
        label="OPTIMIZATION (14-19)";
        style=filled;
        fillcolor="#fff3e0";
        color="#f57c00";
        fontname="Helvetica-Bold";

        Prof [label="14\nProfiling", fillcolor="#ffe0b2"];
        Quant [label="15\nQuantization", fillcolor="#ffe0b2"];
        Comp [label="16\nCompression", fillcolor="#ffe0b2"];
        Memo [label="17\nMemoization", fillcolor="#ffe0b2"];
        Accel [label="18\nAcceleration", fillcolor="#ffe0b2"];
        Bench [label="19\nBenchmarking", fillcolor="#ffe0b2"];

        Prof -> Quant -> Bench;
        Prof -> Comp -> Bench;
        Prof -> Memo -> Bench;
        Prof -> Accel -> Bench;
    }

    // Capstone (gold)
    Cap [label="20\nCapstone", fillcolor="#fff59d", style="filled,rounded,bold"];

    // Inter-tier connections
    Train -> Data;
    Conv -> Prof;
    Trans -> Prof;
    Bench -> Cap;
}
