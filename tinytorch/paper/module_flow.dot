// TinyTorch Module Dependency Graph
// Render with: dot -Tpdf module_flow.dot -o module_flow.pdf
// Or: dot -Tpng module_flow.dot -o module_flow.png

digraph TinyTorch {
    // Global settings
    rankdir=LR;
    splines=ortho;
    nodesep=0.4;
    ranksep=0.6;
    node [shape=box, style="rounded,filled", fontsize=10, fontname="Helvetica"];
    edge [arrowsize=0.7];

    // === FOUNDATION TIER (01-08) ===
    subgraph cluster_foundation {
        label="FOUNDATION (01-08)";
        labelloc=t;
        style="dashed,rounded";
        color=blue;
        fontcolor=blue;
        fontsize=11;

        node [fillcolor="#bbdefb", color="#1976d2"];

        T [label="01\nTensor"];
        A [label="02\nActivations"];
        L [label="03\nLayers"];
        Loss [label="04\nLosses"];
        Auto [label="05\nAutograd"];
        Opt [label="06\nOptimizers"];
        Train [label="07\nTraining"];

        T -> A -> L -> Loss -> Auto -> Opt -> Train;
    }

    // === ARCHITECTURE TIER (09-13) ===
    subgraph cluster_architecture {
        label="ARCHITECTURE (09-13)";
        labelloc=t;
        style="dashed,rounded";
        color=purple;
        fontcolor=purple;
        fontsize=11;

        node [fillcolor="#e1bee7", color="#7b1fa2"];

        Data [label="08\nDataLoader"];

        // Vision path
        Spatial [label="09\nCNNs"];

        // Language path
        Tok [label="10\nTokenization"];
        Emb [label="11\nEmbeddings"];
        Att [label="12\nAttention"];
        Trans [label="13\nTransformers"];

        Data -> Spatial;
        Data -> Tok -> Emb -> Att -> Trans;
    }

    // === OPTIMIZATION TIER (14-19) ===
    subgraph cluster_optimization {
        label="OPTIMIZATION (14-19)";
        labelloc=t;
        style="dashed,rounded";
        color=orange;
        fontcolor=orange;
        fontsize=11;

        node [fillcolor="#ffe0b2", color="#f57c00"];

        Prof [label="14\nProfiling"];
        Quant [label="15\nQuantization"];
        Comp [label="16\nCompression"];
        Accel [label="17\nAcceleration"];
        Memo [label="18\nMemoization"];
        Bench [label="19\nBenchmarking"];

        Prof -> Quant -> Comp -> Bench;
        Prof -> Accel -> Memo -> Bench;
    }

    // === CAPSTONE (20) ===
    Cap [label="20\nCapstone", fillcolor="#fff59d", color="#f9a825"];

    // === CROSS-TIER CONNECTIONS ===
    Train -> Data;
    Spatial -> Prof;
    Trans -> Prof;
    Bench -> Cap;

}
