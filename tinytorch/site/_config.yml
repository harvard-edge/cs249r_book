# TinyTorch: Build ML Systems from Scratch
# Interactive Jupyter Book Configuration

# Branding: Use stylized "TinyðŸ”¥Torch" for public-facing site branding
# This matches the branding convention for memorable, personality-driven presentation
title: "TinyðŸ”¥Torch"
author: "Prof. Vijay Janapa Reddi (Harvard University)"
copyright: "2025 Harvard University"
# Logo: Updated to use standard logo (replaces white version for better visibility)
logo: _static/logos/logo-tinytorch.png

# Book description and metadata
description: >-
  An interactive course for building machine learning systems from the ground up.
  Learn by implementing your own PyTorch-style framework with hands-on coding,
  real datasets, and production-ready practices.

# Execution settings for interactive notebooks
execute:
  execute_notebooks: "cache"
  allow_errors: true
  timeout: 300

# Exclude patterns - don't scan these directories/files
exclude_patterns:
  - _build
  - .venv
  - appendices
  - "**/.venv/**"
  - "**/__pycache__/**"
  - "**/.DS_Store"
  - "modules/**/*.md"
  - "!modules/*_ABOUT.md"

# GitHub repository configuration for GitHub Pages
# TinyTorch now lives in the MLSysBook monorepo at /tinytorch
repository:
  url: https://github.com/harvard-edge/cs249r_book
  path_to_book: tinytorch/site
  branch: dev

# HTML output configuration
html:
  baseurl: https://mlsysbook.ai/tinytorch/  # Base URL for proper link resolution
  use_issues_button: false
  use_repository_button: false
  use_edit_page_button: false
  use_download_button: false
  use_fullscreen_button: true

  # Custom styling
  extra_css:
    - _static/custom.css

  # Custom JavaScript
  extra_js:
    - _static/announcement-bar.js
    - _static/wip-banner.js
    - _static/subscribe-modal.js
    - _static/ml-timeline.js
    - _static/hero-carousel.js
    - _static/sidebar-link.js
    - _static/marimo-badges.js
    - _static/version-badge.js

  # Favicon configuration
  favicon: "_static/favicon.svg"

  # Binder integration for executable notebooks
  launch_buttons:
    binderhub_url: "https://mybinder.org"
    colab_url: "https://colab.research.google.com"

# LaTeX/PDF output
latex:
  latex_documents:
    targetname: tinytorch-course.tex
  latex_elements:
    # Show 3 levels in PDF table of contents (chapter, section, subsection)
    tocdepth: 3

# Bibliography support
bibtex_bibfiles:
  - references.bib

# Sphinx extensions for enhanced functionality
sphinx:
  extra_extensions:
    - sphinxcontrib.mermaid
    - sphinxext.opengraph
  local_extensions:
    icon_link_resolver: ./_ext
  config:
    html_extra_path: ["extra"]
    mermaid_version: "10.6.1"
    mermaid_output_format: "raw"
    mermaid_init_js: "mermaid.initialize({startOnLoad:true});"
    # Open Graph metadata for social sharing (LinkedIn, Twitter, etc.)
    # See: https://sphinxext-opengraph.readthedocs.io/en/latest/
    ogp_site_url: "https://mlsysbook.ai/tinytorch/"
    ogp_site_name: "TinyðŸ”¥Torch"
    ogp_image: "https://mlsysbook.ai/tinytorch/_static/logos/logo-tinytorch.png"
    ogp_type: "website"
    # Note: ogp_description_length controls auto-generated descriptions
    # Title and description are derived from page content by default
    # Sidebar collapsible sections configuration
    html_theme_options:
      logo_link: ""  # Empty string defaults to root_doc (intro), with proper relative path
      show_navbar_depth: 1  # Initial expanded depth (1 = top-level only)
      collapse_navigation: false  # Allow navigation to be collapsible
      navigation_depth: 4  # Maximum depth for navigation tree
      external_links:
        - name: Subscribe
          url: "#subscribe"
          attributes:
            id: navbar-subscribe-btn
            class: subscribe-link
      icon_links:
        - name: PDF Guide
          url: _static/downloads/TinyTorch-Guide.pdf
          icon: fa-solid fa-file-pdf
          type: fontawesome  # icon_link_resolver extension resolves _static URLs
        - name: Paper
          url: https://arxiv.org/abs/2601.19107
          icon: fa-solid fa-scroll
          type: fontawesome
        - name: MLSysBook
          url: ../book/
          icon: fa-solid fa-book
          type: fontawesome
        - name: Support
          url: https://opencollective.com/mlsysbook
          icon: fa-solid fa-heart
          type: fontawesome
        - name: Star
          url: https://github.com/harvard-edge/cs249r_book
          icon: fa-brands fa-github
          type: fontawesome
        - name: Community
          url: https://discord.gg/EZyaFgpB4F
          icon: fa-brands fa-discord
          type: fontawesome

# Parse configuration for MyST Markdown
parse:
  myst_enable_extensions:
    - "colon_fence"
    - "deflist"
    - "html_admonition"
    - "html_image"
    - "linkify"
    - "replacements"
    - "smartquotes"
    - "substitution"
    - "tasklist"

# Advanced options
only_build_toc_files: true
