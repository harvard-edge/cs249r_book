# Tinyüî•Torch: Don't just import torch. Build it.
# PDF-Specific Configuration

title: "Tinyüî•Torch"
subtitle: "Don't just import torch. Build it."
author: "Prof. Vijay Janapa Reddi (Harvard University)"
copyright: "2025"
logo: _static/logos/logo-tinytorch-white.png

# Book description
description: >-
  An interactive course for building machine learning systems from the ground up.
  Learn by implementing your own PyTorch-style framework with hands-on coding,
  real datasets, and production-ready practices.

# Execution settings - disable for PDF
execute:
  execute_notebooks: "off"
  allow_errors: false
  timeout: 300

# Exclude patterns
exclude_patterns:
  - _build
  - .venv
  - appendices
  - "**/.venv/**"
  - "**/__pycache__/**"
  - "**/.DS_Store"

# GitHub repository (for reference in PDF)
repository:
  url: https://github.com/mlsysbook/TinyTorch
  path_to_book: docs
  branch: main

# LaTeX/PDF output configuration
latex:
  latex_engine: xelatex
  use_jupyterbook_latex: true
  latex_documents:
    targetname: tinytorch-course.tex

# Bibliography support
bibtex_bibfiles:
  - references.bib

# Sphinx extensions
sphinx:
  extra_extensions:
    - sphinxcontrib.mermaid
  config:
    mermaid_version: "10.6.1"
    # PDF-specific settings
    jupyterbook_latex_engine: 'xelatex'
    latex_toplevel_sectioning: 'chapter'
    latex_theme: 'manual'
    latex_elements:
      papersize: 'letterpaper'
      pointsize: '10pt'
      fontpkg: |
        % Professional academic font stack (macOS system fonts)
        \usepackage{fontspec}
        \defaultfontfeatures{Renderer=HarfBuzz}
        \setmainfont{Palatino}                     % Classic book font
        \setsansfont{Helvetica Neue}               % Clean sans-serif
        \setmonofont{Menlo}[Scale=0.88]            % Monospace for code
      preamble: |
        % Graphics and color support
        \usepackage{graphicx}
        \usepackage{xcolor}
        \usepackage{booktabs}
        \usepackage{tcolorbox}
        \usepackage{hyperref}

        % TinyTorch brand colors - refined palette
        \definecolor{torchnavy}{RGB}{27,58,95}      % Deep navy - headings only
        \definecolor{flameorange}{RGB}{255,130,70}  % Softer coral orange - easier on eyes
        \definecolor{flamered}{RGB}{210,35,65}      % Warmer red for syntax
        \definecolor{bodygray}{RGB}{40,40,40}       % Near-black for body text
        \definecolor{codebackground}{RGB}{255,248,240}  % Very light peachy background
        \definecolor{accentwarm}{RGB}{255,160,100}  % Soft warm accent

        % Unicode character support for arrows and symbols
        \usepackage{newunicodechar}
        \newunicodechar{‚Üí}{$\rightarrow$}
        \newunicodechar{‚Üê}{$\leftarrow$}
        \newunicodechar{‚Üî}{$\leftrightarrow$}
        \newunicodechar{‚ü∂}{$\longrightarrow$}
        \newunicodechar{√ó}{$\times$}
        \newunicodechar{√∑}{$\div$}
        \newunicodechar{‚âà}{$\approx$}
        \newunicodechar{‚â†}{$\neq$}
        \newunicodechar{‚â§}{$\leq$}
        \newunicodechar{‚â•}{$\geq$}
        \newunicodechar{‚àà}{$\in$}
        \newunicodechar{‚àû}{$\infty$}
        \newunicodechar{‚àö}{$\sqrt{}$}
        \newunicodechar{‚àë}{$\sum$}
        \newunicodechar{‚àè}{$\prod$}
        \newunicodechar{‚àÇ}{$\partial$}
        \newunicodechar{‚àá}{$\nabla$}
        \newunicodechar{Œ±}{$\alpha$}
        \newunicodechar{Œ≤}{$\beta$}
        \newunicodechar{Œ≥}{$\gamma$}
        \newunicodechar{Œ¥}{$\delta$}
        \newunicodechar{Œµ}{$\epsilon$}
        \newunicodechar{Œ∏}{$\theta$}
        \newunicodechar{Œª}{$\lambda$}
        \newunicodechar{Œº}{$\mu$}
        \newunicodechar{œÉ}{$\sigma$}
        \newunicodechar{œÑ}{$\tau$}
        \newunicodechar{œÜ}{$\phi$}
        \newunicodechar{œâ}{$\omega$}
        \newunicodechar{‚úì}{\checkmark}
        \newunicodechar{‚úó}{$\times$}

        % Syntax-highlighted code blocks with refined colors
        \usepackage{listings}
        \lstset{
          basicstyle=\ttfamily\footnotesize\color{bodygray},
          backgroundcolor=\color{codebackground},
          frame=leftline,
          framesep=10pt,
          framerule=3pt,
          rulecolor=\color{flameorange},
          numbers=none,
          breaklines=true,
          showstringspaces=false,
          commentstyle=\color{torchnavy!60}\itshape,
          keywordstyle=\color{torchnavy}\bfseries,
          stringstyle=\color{flamered},
          xleftmargin=15pt,
          framexleftmargin=15pt
        }

        % TikZ for neural network decorations
        \usepackage{tikz}
        \usetikzlibrary{calc,positioning,decorations.pathmorphing}

        % Custom title page with TinyTorch branding - Asymmetric Neural Network Design
        \makeatletter
        \renewcommand{\sphinxmaketitle}{%
          \begin{titlepage}
            % Neural network border decorations - asymmetric diagonal flow
            \begin{tikzpicture}[remember picture, overlay]
              % Define node styles
              \tikzset{
                neuron/.style={circle, fill=flameorange!30, draw=flameorange!60, minimum size=6pt, inner sep=0pt},
                neuron-small/.style={circle, fill=torchnavy!20, draw=torchnavy!40, minimum size=4pt, inner sep=0pt},
                neuron-tiny/.style={circle, fill=torchnavy!12, draw=torchnavy!25, minimum size=3pt, inner sep=0pt},
                neuron-accent/.style={circle, fill=flameorange!50, draw=flameorange, minimum size=8pt, inner sep=0pt},
                neuron-large/.style={circle, fill=flameorange!40, draw=flameorange!70, minimum size=10pt, inner sep=0pt},
                connection/.style={draw=torchnavy!15, line width=0.4pt},
                connection-accent/.style={draw=flameorange!25, line width=0.5pt}
              }

              % TOP-LEFT: Dense primary cluster (8 nodes) - main visual anchor
              \node[neuron-large] (tl1) at ($(current page.north west)+(2.0cm,-2.0cm)$) {};
              \node[neuron-accent] (tl2) at ($(tl1)+(0.7cm,-0.2cm)$) {};
              \node[neuron] (tl3) at ($(tl1)+(0.4cm,-0.8cm)$) {};
              \node[neuron] (tl4) at ($(tl1)+(1.2cm,-0.6cm)$) {};
              \node[neuron-small] (tl5) at ($(tl1)+(0.5cm,0.5cm)$) {};
              \node[neuron-small] (tl6) at ($(tl1)+(1.5cm,-0.1cm)$) {};
              \node[neuron-small] (tl7) at ($(tl1)+(1.0cm,-1.2cm)$) {};
              \node[neuron-tiny] (tl8) at ($(tl1)+(1.8cm,-0.8cm)$) {};
              \draw[connection-accent] (tl1) -- (tl2);
              \draw[connection-accent] (tl1) -- (tl3);
              \draw[connection] (tl2) -- (tl4);
              \draw[connection] (tl3) -- (tl4);
              \draw[connection] (tl1) -- (tl5);
              \draw[connection] (tl2) -- (tl6);
              \draw[connection] (tl4) -- (tl7);
              \draw[connection] (tl6) -- (tl8);
              \draw[connection] (tl4) -- (tl8);

              % TOP-RIGHT: Sparse cluster (4 nodes) - lighter weight
              \node[neuron] (tr1) at ($(current page.north east)+(-1.6cm,-1.5cm)$) {};
              \node[neuron-small] (tr2) at ($(tr1)+(-0.5cm,-0.4cm)$) {};
              \node[neuron-tiny] (tr3) at ($(tr1)+(-0.9cm,-0.2cm)$) {};
              \node[neuron-tiny] (tr4) at ($(tr1)+(-0.3cm,-0.9cm)$) {};
              \draw[connection] (tr1) -- (tr2);
              \draw[connection] (tr2) -- (tr3);
              \draw[connection] (tr1) -- (tr4);

              % BOTTOM-LEFT: Sparse cluster (4 nodes) - lighter weight
              \node[neuron] (bl1) at ($(current page.south west)+(1.5cm,1.6cm)$) {};
              \node[neuron-small] (bl2) at ($(bl1)+(0.5cm,0.4cm)$) {};
              \node[neuron-tiny] (bl3) at ($(bl1)+(0.9cm,0.1cm)$) {};
              \node[neuron-tiny] (bl4) at ($(bl1)+(0.2cm,0.9cm)$) {};
              \draw[connection] (bl1) -- (bl2);
              \draw[connection] (bl2) -- (bl3);
              \draw[connection] (bl1) -- (bl4);

              % BOTTOM-RIGHT: Dense secondary cluster (8 nodes) - diagonal balance
              \node[neuron-large] (br1) at ($(current page.south east)+(-2.0cm,2.0cm)$) {};
              \node[neuron-accent] (br2) at ($(br1)+(-0.7cm,0.2cm)$) {};
              \node[neuron] (br3) at ($(br1)+(-0.4cm,0.8cm)$) {};
              \node[neuron] (br4) at ($(br1)+(-1.2cm,0.6cm)$) {};
              \node[neuron-small] (br5) at ($(br1)+(-0.5cm,-0.5cm)$) {};
              \node[neuron-small] (br6) at ($(br1)+(-1.5cm,0.1cm)$) {};
              \node[neuron-small] (br7) at ($(br1)+(-1.0cm,1.2cm)$) {};
              \node[neuron-tiny] (br8) at ($(br1)+(-1.8cm,0.8cm)$) {};
              \draw[connection-accent] (br1) -- (br2);
              \draw[connection-accent] (br1) -- (br3);
              \draw[connection] (br2) -- (br4);
              \draw[connection] (br3) -- (br4);
              \draw[connection] (br1) -- (br5);
              \draw[connection] (br2) -- (br6);
              \draw[connection] (br4) -- (br7);
              \draw[connection] (br6) -- (br8);
              \draw[connection] (br4) -- (br8);

              % Left edge: scattered pathway nodes (organic placement)
              \node[neuron-small] (le1) at ($(current page.west)+(0.9cm,4.5cm)$) {};
              \node[neuron-tiny] (le2) at ($(current page.west)+(1.2cm,2.8cm)$) {};
              \node[neuron-tiny] (le3) at ($(current page.west)+(0.7cm,0.5cm)$) {};
              \node[neuron-small] (le4) at ($(current page.west)+(1.0cm,-1.5cm)$) {};
              \draw[connection] (le1) -- (le2);
              \draw[connection] (le3) -- (le4);

              % Right edge: scattered pathway nodes (organic placement)
              \node[neuron-tiny] (re1) at ($(current page.east)+(-0.8cm,2.0cm)$) {};
              \node[neuron-small] (re2) at ($(current page.east)+(-1.1cm,-0.5cm)$) {};
              \node[neuron-tiny] (re3) at ($(current page.east)+(-0.9cm,-3.0cm)$) {};
              \draw[connection] (re1) -- (re2);

              % Diagonal flow connections (top-left to bottom-right emphasis)
              \draw[connection] (tl7) to[out=-45, in=135] (le2);
              \draw[connection] (tl8) to[out=-30, in=160] (re1);
              \draw[connection] (br7) to[out=135, in=-45] (re2);
              \draw[connection] (br8) to[out=150, in=-20] (le4);

            \end{tikzpicture}

            \centering
            \vspace*{0.6cm}

            % TinyTorch Logo
            \includegraphics[width=0.52\textwidth]{../../_static/logos/logo-tinytorch.png}
            \vspace{5pt}

            % Tagline
            {\fontsize{16}{20}\selectfont\color{flameorange} Don't just \texttt{import torch}. Build it.\par}
            \vspace{14pt}

            % Main title - the visual anchor
            {\fontsize{26}{30}\selectfont\bfseries\color{torchnavy} Build Your Own ML Framework\par}

            \vspace{24pt}

            % Author block - tight cluster
            {\Large\color{torchnavy}\textbf{Prof. Vijay Janapa Reddi}\par}
            \vspace{3pt}
            {\large\color{bodygray}Harvard University\par}

            \vspace{114pt}

            % MLSysBook badge - light and airy footer
            \begin{tcolorbox}[
              colback=bodygray!4,
              colframe=bodygray!4,
              boxrule=0pt,
              arc=6pt,
              width=0.58\textwidth,
              halign=center,
              left=24pt,
              right=24pt,
              top=14pt,
              bottom=16pt
            ]
              {\fontsize{9}{11}\selectfont\color{torchnavy}\textit{From Tensors to Systems}\par}
              \vspace{8pt}
              {\fontsize{7}{9}\selectfont\color{bodygray!60}A Build-It-Yourself Companion to the\par}
              \vspace{8pt}
              {\fontsize{8.5}{11}\selectfont\color{torchnavy}\textbf{Machine Learning Systems} textbook\par}
              \vspace{6pt}
              {\fontsize{7}{9}\selectfont\color{flameorange}\textit{\href{https://mlsysbook.ai}{mlsysbook.ai}}\par}
            \end{tcolorbox}
            \vspace{5pt}

            % Draft indicator with date
            {\fontsize{8}{10}\selectfont\color{bodygray!40}\textit{Draft Edition --- Last updated: December 10, 2025}\par}
            \vspace{0.6cm}

          \end{titlepage}
        }
        \makeatother

        % Clean headers and footers with TinyTorch branding
        \usepackage{fancyhdr}
        \setlength{\headheight}{21pt}
        \addtolength{\topmargin}{-9pt}

        % Define custom fancy page style
        \fancypagestyle{fancy}{%
          \fancyhf{}%
          \fancyfoot[C]{\color{bodygray}\thepage}%
          \renewcommand{\headrulewidth}{0.5pt}%
          \renewcommand{\footrulewidth}{0pt}%
          \renewcommand{\headrule}{%
            \vbox to 0pt{%
              \hbox to\headwidth{\hfil{\footnotesize\color{flameorange}tiny\kern1pt\raisebox{-1pt}{\includegraphics[height=9pt]{../../_static/logos/fire-emoji.png}}\kern1pt\color{torchnavy}torch}\hfil}%
              \vskip 4pt%
              \hrule height 0.5pt width\headwidth%
              \kern-0.5pt\color{flameorange}\hrule height 0.5pt width\headwidth%
            }%
          }%
        }

        % Override Sphinx's 'normal' pagestyle to use our fancy style
        \fancypagestyle{normal}{%
          \fancyhf{}%
          \fancyfoot[C]{\color{bodygray}\thepage}%
          \renewcommand{\headrulewidth}{0.5pt}%
          \renewcommand{\footrulewidth}{0pt}%
          \renewcommand{\headrule}{%
            \vbox to 0pt{%
              \hbox to\headwidth{\hfil{\footnotesize\color{flameorange}tiny\kern1pt\raisebox{-1pt}{\includegraphics[height=9pt]{../../_static/logos/fire-emoji.png}}\kern1pt\color{torchnavy}torch}\hfil}%
              \vskip 4pt%
              \hrule height 0.5pt width\headwidth%
              \kern-0.5pt\color{flameorange}\hrule height 0.5pt width\headwidth%
            }%
          }%
        }

        % Override plain style used for TOC/chapter pages
        \fancypagestyle{plain}{%
          \fancyhf{}%
          \fancyfoot[C]{\color{bodygray}\mdseries\thepage}%
          \renewcommand{\headrulewidth}{0pt}%
          \renewcommand{\footrulewidth}{0pt}%
        }

        \pagestyle{fancy}

        % Bold chapter styling with TinyTorch flame logo - left aligned
        \usepackage{titlesec}
        \titleformat{\chapter}[display]
          {\normalfont\huge\bfseries\color{torchnavy}}
          {\includegraphics[height=20pt]{../../_static/logos/fire-emoji.png}\hspace{8pt}\color{flameorange}\chaptertitlename\ \thechapter}{15pt}{\Huge\color{torchnavy}}
        \titlespacing*{\chapter}{0pt}{-10pt}{30pt}

        % Unnumbered chapter format (for Preface, etc.)
        \titleformat{name=\chapter,numberless}[display]
          {\normalfont\huge\bfseries\color{torchnavy}}
          {}{0pt}{\Huge\color{torchnavy}}
        \titlespacing*{name=\chapter,numberless}{0pt}{-10pt}{30pt}

        % Professional hyperlinks with TinyTorch colors
        \usepackage{hyperref}
        \hypersetup{
          colorlinks=true,
          linkcolor=torchnavy,
          urlcolor=flameorange,
          citecolor=torchnavy,
          bookmarksnumbered=true,
          pdfstartview=FitH
        }

        % Hook to insert Preface with content after TOC
        \usepackage{etoolbox}
        \AtBeginDocument{%
          \apptocmd{\tableofcontents}{%
            \cleardoublepage
            \chapter*{Preface}
            \addcontentsline{toc}{chapter}{Preface}
            \thispagestyle{plain}

            \textbf{\large Welcome}
            \hfill
            \raisebox{-1.5cm}{\includegraphics[width=2.5cm]{tito.png}}

            \medskip

            Everyone wants to be an astronaut. Very few want to be the rocket scientist---and build the rocket.

            \medskip

            In machine learning, we see the same pattern. Everyone wants to train models, run inference, deploy AI. Very few want to understand how the frameworks actually work. Even fewer want to build one.

            \medskip

            The world is full of users. We do not have enough builders.

            \medskip

            This is the gap \href{https://mlsysbook.ai/tinytorch}{TinyTorch} exists to fill.

            \bigskip

            \textbf{\large The Problem}

            \medskip

            Most people can use PyTorch or TensorFlow. They can import libraries, call functions, train models. Very few understand how these frameworks work: how tensors manage memory, how autograd builds computation graphs, how optimizers update parameters. And almost no one has a guided, structured way to learn that from the ground up.

            \medskip

            Students cannot learn this from production code. PyTorch is too large, too complex, too optimized. Fifty thousand lines of C++ across hundreds of files. No one learns to build rockets by studying the Saturn V.

            \medskip

            They also cannot learn it from toy scripts. A hundred-line neural network does not reveal the architecture of a framework. It hides it.

            \bigskip

            \textbf{\large The Solution}

            \medskip

            TinyTorch occupies the space in the middle. Small enough to learn from: bite-sized code that runs even on a Raspberry Pi. Big enough to matter: showing the real architecture of how frameworks are built.

            \medskip

            If the \href{https://mlsysbook.ai}{Machine Learning Systems} textbook teaches you the concepts of the rocket ship (propulsion, guidance, life support) then TinyTorch is where you actually build a small rocket with your own hands. Not a toy. A real framework with tensors, autograd, layers, optimizers, data loaders, and training loops. Twenty modules that take you from first principles to a working system.

            \medskip

            This is how people move from \emph{doing} machine learning to \emph{engineering} machine learning systems. This is how someone becomes an AI systems engineer rather than a notebook operator.

            \bigskip

            \textbf{\large Who This Is For}

            \medskip

            \textbf{Students and Researchers} who want to understand ML systems deeply, not just use them superficially. If you have taken an ML course and wondered ``how does that actually work?'', this guide is for you.

            \medskip

            \textbf{ML Engineers} who need to debug, optimize, and deploy models in production. Understanding the systems underneath makes you more effective at every stage of the ML lifecycle.

            \medskip

            \textbf{Systems Programmers} curious about ML. You understand systems thinking: memory hierarchies, computational complexity, performance optimization. You want to apply it to ML.

            \medskip

            \textbf{Self-taught Engineers} who can use frameworks but want to know how they work. You might be preparing for ML infrastructure roles and need systems-level understanding.

            \medskip

            What you need is not another API tutorial. You need to build.

            \bigskip

            \textbf{\large What You Will Build}

            \medskip

            By the end of TinyTorch, you will have implemented:

            \begin{itemize}
              \item A tensor library with broadcasting, reshaping, and matrix operations
              \item Activation functions with numerical stability considerations
              \item Neural network layers: linear, convolutional, normalization
              \item An autograd engine that builds computation graphs and computes gradients
              \item Optimizers that update parameters using those gradients
              \item Data loaders that handle batching, shuffling, and preprocessing
              \item A complete training loop that ties everything together
              \item Tokenizers, embeddings, attention, and transformer architectures
              \item Profiling, quantization, and optimization techniques
            \end{itemize}

            This is not a simulation. This is the actual architecture of modern ML frameworks, implemented at human scale.

            \bigskip

            \textbf{\large The Bigger Picture}

            \medskip

            TinyTorch is part of a larger effort to educate a million learners at the edge of AI. The \href{https://mlsysbook.ai}{Machine Learning Systems} textbook provides the conceptual foundation. TinyTorch provides the hands-on implementation experience. Together, they form a complete path into ML systems engineering.

            \medskip

            The next generation of engineers cannot rely on magic. They need to see how everything fits together, from tensors all the way to systems. They need to feel that the world of ML systems is not an unreachable tower but something they can open, shape, and build.

            \medskip

            That is what TinyTorch offers: the confidence that comes from building something real.

            \vfill

            \begin{flushright}
            \textit{Prof.\ Vijay Janapa Reddi}\\
            \textit{Harvard University}\\
            \textit{2025}
            \end{flushright}
          }{}{}%
        }

      latex_additional_files:
        - _static/logos/fire-emoji.png
        - _static/logos/logo-mlsysbook.png
        - _static/images/tito.png

# Parse configuration
parse:
  myst_enable_extensions:
    - "colon_fence"
    - "deflist"
    - "html_admonition"
    - "html_image"
    - "linkify"
    - "replacements"
    - "smartquotes"
    - "substitution"
    - "tasklist"

# Build only TOC files
only_build_toc_files: true
